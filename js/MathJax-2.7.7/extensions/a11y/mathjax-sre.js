var $jscomp=$jscomp||{},COMPILED=($jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},$jscomp.getGlobal=function(e){return("undefined"==typeof window||window!==e)&&"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var t=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+t++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=(e=$jscomp.global.Symbol.iterator)||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),(e={next:e})[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.iteratorFromArray=function(t,r){$jscomp.initSymbolIterator(),t instanceof String&&(t+="");var s=0,n={next:function(){var e;return s<t.length?(e=s++,{value:r(e,t[e]),done:!1}):(n.next=function(){return{done:!0,value:void 0}},n.next())}};return n[Symbol.iterator]=function(){return n},n},$jscomp.polyfill=function(e,t,r,s){if(t){for(r=$jscomp.global,e=e.split("."),s=0;s<e.length-1;s++){var n=e[s];n in r||(r[n]={}),r=r[n]}(t=t(s=r[e=e[e.length-1]]))!=s&&null!=t&&$jscomp.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}},$jscomp.checkStringArgs=function(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""},$jscomp.findInternal=function(e,t,r){for(var s=(e=e instanceof String?String(e):e).length,n=0;n<s;n++){var i=e[n];if(t.call(r,i,n,e))return{i:n,v:i}}return{i:-1,v:void 0}},!0),goog=goog||{},sre=(goog.global=this,goog.isDef=function(e){return void 0!==e},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.exportPath_=function(e,t,r){e=e.split("."),r=r||goog.global,e[0]in r||void 0===r.execScript||r.execScript("var "+e[0]);for(var s;e.length&&(s=e.shift());)!e.length&&goog.isDef(t)?r[s]=t:r=r[s]&&r[s]!==Object.prototype[s]?r[s]:r[s]={}},goog.define=function(e,t){var r,s;COMPILED||(r=goog.global.CLOSURE_UNCOMPILED_DEFINES,s=goog.global.CLOSURE_DEFINES,r&&void 0===r.nodeType&&Object.prototype.hasOwnProperty.call(r,e)?t=r[e]:s&&void 0===s.nodeType&&Object.prototype.hasOwnProperty.call(s,e)&&(t=s[e])),goog.exportPath_(e,t)},goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var r=e;(r=r.substring(0,r.lastIndexOf(".")))&&!goog.getObjectByName(r);)goog.implicitNamespaces_[r]=!0}goog.exportPath_(e,t)},goog.getScriptNonce=function(){return null===goog.cspNonce_&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document)||""),goog.cspNonce_},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.cspNonce_=null,goog.getScriptNonce_=function(e){return(e=e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(e)?e:null},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){if(!COMPILED&&e in goog.loadedModules_){if(goog.loadedModules_[e].type!=goog.ModuleType.GOOG)throw Error("Can only goog.module.get for goog.modules.");if(goog.loadedModules_[e].moduleId!=e)throw Error("Cannot goog.module.get by path.")}return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e].exports;if(!goog.implicitNamespaces_[e])return null!=(e=goog.getObjectByName(e))?e:null}return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var e=goog.global.$jscomp;return!!e&&("function"==typeof e.getCurrentModulePath&&!!e.getCurrentModulePath())},goog.getModulePath_=function(){return goog.moduleLoaderState_&&goog.moduleLoaderState_.path},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){e=e.split("."),t=t||goog.global;for(var r=0;r<e.length;r++)if(t=t[e[r]],!goog.isDefAndNotNull(t))return null;return t},goog.globalize=function(e,t){for(var r in t=t||goog.global,e)t[r]=e[r]},goog.addDependency=function(e,t,r,s){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(e,t,r,s)},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.isPath_=function(e){return 0==e.indexOf("./")||0==e.indexOf("../")},goog.require=function(e){if(goog.isPath_(e)){if(!goog.isInGoogModuleLoader_())throw Error("Cannot require by path outside of goog.modules.");if(!goog.getModulePath_())throw Error("Current module has no path information. Was it loaded via goog.loadModule without a path argument?");e=goog.normalizePath_(goog.getModulePath_()+"/../"+e)}if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(e),goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(e)}finally{goog.moduleLoaderState_=t}}return null}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_||(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.TRANSPILER="transpile.js",goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(b){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(e){return"(function(){"+e+"\n;})();\n"},goog.loadModule=function(e,t){var r=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG,path:t},goog.isFunction(e))var s=e.call(void 0,{});else{if(!goog.isString(e))throw Error("Invalid module definition");goog.useSafari10Workaround()&&(e=goog.workaroundSafari10EvalBug(e)),s=goog.loadModuleFromSource_.call(void 0,e)}var n=goog.moduleLoaderState_.moduleName;if(!goog.isString(n)||!n)throw Error('Invalid module name "'+n+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(n,s):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof s&&null!=s&&Object.seal(s);var i={exports:s,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};goog.loadedModules_[n]=i,t&&(goog.loadedModules_[t]=i)}finally{goog.moduleLoaderState_=r}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.transpile_=function(a,b){var c=goog.global.$jscomp,d=(c||(goog.global.$jscomp=c={}),c.transpile);if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);if(f){if(!function(){eval(f+"\n//# sourceURL="+e)}.call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,c=goog.global.$jscomp,d=c.transpile}}return d=d||(c.transpile=function(e,t){return goog.logToConsole_(t+" requires transpilation but no transpiler was found."),e}),d(a,b)},goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t,r=goog.typeOf(e);if("object"!=r&&"array"!=r)return e;if("function"==typeof e.clone)return e.clone();for(t in r="array"==r?[]:{},e)r[t]=goog.cloneObject(e[t]);return r},goog.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(t,r,e){if(!t)throw Error();var s;return 2<arguments.length?(s=Array.prototype.slice.call(arguments,2),function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,s),t.apply(r,e)}):function(){return t.apply(r,arguments)}},goog.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}},goog.mixin=function(e,t){for(var r in t)e[r]=t[r]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_){try{goog.global.eval("var _evalTest_ = 1;")}catch(e){}if(void 0!==goog.global._evalTest_){try{delete goog.global._evalTest_}catch(e){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}var t,r;goog.evalWorksForGlobals_?goog.global.eval(e):((r=(t=goog.global.document).createElement("SCRIPT")).type="text/javascript",r.defer=!1,r.appendChild(t.createTextNode(e)),t.head.appendChild(r),t.head.removeChild(r))}},goog.evalWorksForGlobals_=null,goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);function s(e){return goog.cssNameMapping_[e]||e}var r=function(e){e=e.split("-");for(var t=[],r=0;r<e.length;r++)t.push(s(e[r]));return t.join("-")},r=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?s:r:function(e){return e};return e=t?e+"-"+r(t):r(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(e):e},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,r){return e=r?e.replace(/\{\$([^}]+)}/g,function(e,t){return null!=r&&t in r?r[t]:e}):e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,r){goog.exportPath_(e,t,r)},goog.exportProperty=function(e,t,r){e[t]=r},goog.inherits=function(e,i){function t(){}t.prototype=i.prototype,e.superClass_=i.prototype,e.prototype=new t,(e.prototype.constructor=e).base=function(e,t,r){for(var s=Array(arguments.length-2),n=2;n<arguments.length;n++)s[n-2]=arguments[n];return i.prototype[t].apply(e,s)}},goog.base=function(e,t,r){var s=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!s)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(void 0!==s.superClass_){for(var n=Array(arguments.length-1),i=1;i<arguments.length;i++)n[i-1]=arguments[i];return s.superClass_.constructor.apply(e,n)}if("string"!=typeof t&&"symbol"!=typeof t)throw Error("method names provided to goog.base must be a string or a symbol");for(n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var i=!1,a=e.constructor;a;a=a.superClass_&&a.superClass_.constructor)if(a.prototype[t]===s)i=!0;else if(i)return a.prototype[t].apply(e,n);if(e[t]===s)return e.constructor.prototype[t].apply(e,n);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var r=t.constructor,s=t.statics;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=goog.defineClass.createSealingConstructor_(r,e),e&&goog.inherits(r,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(r.prototype,t),null!=s&&(s instanceof Function?s(r):goog.defineClass.applyProperties_(r,s)),r},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(t,e){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return t;function r(){var e=t.apply(this,arguments)||this;return e[goog.UID_PROPERTY_]=e[goog.UID_PROPERTY_],this.constructor===r&&s&&Object.seal instanceof Function&&Object.seal(e),e}var s=!goog.defineClass.isUnsealable_(e);return r},goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);for(var s=0;s<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;s++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[s],Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},goog.tagUnsealableClass=function(e){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.isDocumentLoading_=function(){var e=goog.global.document;return e.attachEvent?"complete"!=e.readyState:"loading"==e.readyState},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document,t=(e=(t=e.currentScript)?[t]:e.getElementsByTagName("SCRIPT")).length-1;0<=t;--t){var r=e[t].src,s=-1==(s=r.lastIndexOf("?"))?r.length:s;if("base.js"==r.substr(s-7,7)){goog.basePath=r.substr(0,s-7);break}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function a(e,t){d?c[e]=!0:t()?c[e]=!1:d=c[e]=!0}function b(a){try{return!!eval(a)}catch(g){return!1}}var c={es3:!1},d=!1,e=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";return a("es5",function(){return b("[1,].length==1")}),a("es6",function(){var t=e.match(/Edge\/(\d+)(\.\d)*/i);return!(t&&Number(t[1])<15)&&b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')}),a("es6-impl",function(){return!0}),a("es7",function(){return b("2 ** 2 == 4")}),a("es8",function(){return b("async () => 1, true")}),a("es9",function(){return b("({...rest} = {}), true")}),a("es_next",function(){return!1}),c},goog.Transpiler.prototype.needsTranspile=function(e,t){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(this.requiresTranspilation_||(this.requiresTranspilation_=this.createRequiresTranspilation_()),e in this.requiresTranspilation_)return!!this.requiresTranspilation_[e]||!(!goog.inHtmlDocument_()||"es6"!=t||"noModule"in goog.global.document.createElement("script"));throw Error("Unknown language mode: "+e)},goog.Transpiler.prototype.transpile=function(e,t){return goog.transpile_(e,t)},goog.transpiler_=new goog.Transpiler,goog.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={},this.idToPath_={},this.written_={},this.loadingDeps_=[],this.depsToLoad_=[],this.paused_=!1,this.factory_=new goog.DependencyFactory(goog.transpiler_),this.deferredCallbacks_={},this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(e,t){function r(){s&&(goog.global.setTimeout(s,0),s=null)}var s=t;if(e.length){t=[];for(var n=0;n<e.length;n++){var i=this.getPathFromDeps_(e[n]);if(!i)throw Error("Unregonized namespace: "+e[n]);t.push(this.dependencies_[i])}for(var i=goog.require,a=0,n=0;n<e.length;n++)i(e[n]),t[n].onLoad(function(){++a==e.length&&r()})}else r()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{},!1)),this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(e,t){(e=this.getPathFromDeps_(e))&&(t||this.areDepsLoaded_(this.dependencies_[e].requires))&&(t=this.deferredCallbacks_[e])&&(delete this.deferredCallbacks_[e],t())},goog.DebugLoader_.prototype.setDependencyFactory=function(e){this.factory_=e},goog.DebugLoader_.prototype.load_=function(e){if(!this.getPathFromDeps_(e))throw goog.logToConsole_(e="goog.require could not find: "+e),Error(e);var r=this,s=[],n=function(e){var t=r.getPathFromDeps_(e);if(!t)throw Error("Bad dependency path or symbol: "+e);if(!r.written_[t]){for(r.written_[t]=!0,e=r.dependencies_[t],t=0;t<e.requires.length;t++)goog.isProvided_(e.requires[t])||n(e.requires[t]);s.push(e)}};n(e),e=!!this.depsToLoad_.length,this.depsToLoad_=this.depsToLoad_.concat(s),this.paused_||e||this.loadDeps_()},goog.DebugLoader_.prototype.loadDeps_=function(){for(var n=this,i=this.paused_;this.depsToLoad_.length&&!i;)!function(){var t=!1,r=n.depsToLoad_.shift(),e=!1,s=(n.loading_(r),{pause:function(){if(t)throw Error("Cannot call pause after the call to load.");i=!0},resume:function(){t?n.resume_():i=!1},loaded:function(){if(e)throw Error("Double call to loaded.");e=!0,n.loaded_(r)},pending:function(){for(var e=[],t=0;t<n.loadingDeps_.length;t++)e.push(n.loadingDeps_[t]);return e},setModuleState:function(e,t){goog.moduleLoaderState_={path:e,type:t,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(e,t){goog.loadedModules_[e]={exports:t,type:goog.ModuleType.ES6,moduleId:""}},registerGoogModuleExports:function(e,t){goog.loadedModules_[e]={exports:t,type:goog.ModuleType.GOOG,moduleId:e}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(e){if(t)throw Error("Cannot register with defer after the call to load.");n.defer_(r,e)},areDepsLoaded:function(){return n.areDepsLoaded_(r.requires)}});try{r.load(s)}finally{t=!0}}();i&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(e){this.loadingDeps_.push(e)},goog.DebugLoader_.prototype.loaded_=function(e){for(var t=0;t<this.loadingDeps_.length;t++)if(this.loadingDeps_[t]==e){this.loadingDeps_.splice(t,1);break}for(t=0;t<this.deferredQueue_.length;t++)if(this.deferredQueue_[t]==e.path){this.deferredQueue_.splice(t,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);e.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(e){for(var t=0;t<e.length;t++){var r=this.getPathFromDeps_(e[t]);if(!r||!(r in this.deferredCallbacks_||goog.isProvided_(e[t])))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=function(e){return e in this.idToPath_?this.idToPath_[e]:e in this.dependencies_?e:null},goog.DebugLoader_.prototype.defer_=function(e,t){this.deferredCallbacks_[e.path]=t,this.deferredQueue_.push(e.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(e,t){},goog.LoadController.prototype.setModuleState=function(e,t){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(e){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(e,t,r,s,n){this.path=e,this.relativePath=t,this.provides=r,this.requires=s,this.loadFlags=n,this.loaded_=!1,this.loadCallbacks_=[]},goog.Dependency.prototype.onLoad=function(e){this.loaded_?e():this.loadCallbacks_.push(e)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var e=this.loadCallbacks_;this.loadCallbacks_=[];for(var t=0;t<e.length;t++)e[t]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(e){var t=Math.random().toString(32);return goog.Dependency.callbackMap_[t]=e,t},goog.Dependency.unregisterCallback_=function(e){delete goog.Dependency.callbackMap_[e]},goog.Dependency.callback_=function(e,t){if(!(e in goog.Dependency.callbackMap_))throw Error("Callback key "+e+" does not exist (was base.js loaded more than once?).");for(var r=goog.Dependency.callbackMap_[e],s=[],n=1;n<arguments.length;n++)s.push(arguments[n]);r.apply(void 0,s)},goog.Dependency.prototype.load=function(t){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?t.loaded():t.pause();else if(goog.inHtmlDocument_()){var r,e,s,n=goog.global.document;if("complete"==n.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path))return void t.loaded();throw Error('Cannot write "'+this.path+'" after document load')}!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()?(r=goog.Dependency.registerCallback_(function(e){goog.DebugLoader_.IS_OLD_IE_&&"complete"!=e.readyState||(goog.Dependency.unregisterCallback_(r),t.loaded())}),n.write('<script src="'+this.path+'" '+(goog.DebugLoader_.IS_OLD_IE_?"onreadystatechange":"onload")+"=\"goog.Dependency.callback_('"+r+'\', this)" type="text/javascript" '+(goog.Dependency.defer_?"defer":"")+"><\/script>")):((e=n.createElement("script")).defer=goog.Dependency.defer_,e.async=!1,e.type="text/javascript",(s=goog.getScriptNonce())&&(e.nonce=s),goog.DebugLoader_.IS_OLD_IE_?(t.pause(),e.onreadystatechange=function(){"loaded"!=e.readyState&&"complete"!=e.readyState||(t.loaded(),t.resume())}):e.onload=function(){e.onload=null,t.loaded()},e.src=this.path,n.head.appendChild(e))}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or seting CLOSURE_NO_DEPS to true."),t.loaded()):t.pause()},goog.Es6ModuleDependency=function(e,t,r,s,n){goog.Dependency.call(this,e,t,r,s,n)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(t){var n,r,e,s,i,a;goog.global.CLOSURE_IMPORT_SCRIPT?goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?t.loaded():t.pause():goog.inHtmlDocument_()?(n=goog.global.document,r=this,goog.isDocumentLoading_()?(e=function(e,t){t?n.write('<script type="module" crossorigin>'+t+"<\/script>"):n.write('<script type="module" crossorigin src="'+e+'"><\/script>')},goog.Dependency.defer_=!0):e=function(e,t){var r=n.createElement("script"),s=(r.defer=!0,r.async=!1,r.type="module",r.setAttribute("crossorigin",!0),goog.getScriptNonce());s&&(r.nonce=s),t?r.textContent=t:r.src=e,n.head.appendChild(r)},e(void 0,'goog.Dependency.callback_("'+(s=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(s),t.setModuleState(r.path,goog.ModuleType.ES6)}))+'")'),e(this.path,void 0),i=goog.Dependency.registerCallback_(function(e){goog.Dependency.unregisterCallback_(i),t.registerEs6ModuleExports(r.path,e)}),e(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+i+'", m)'),e(void 0,'goog.Dependency.callback_("'+(a=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(a),t.clearModuleState(),t.loaded()}))+'")')):(goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),t.pause())},goog.TransformedDependency=function(e,t,r,s,n){goog.Dependency.call(this,e,t,r,s,n),this.contents_=null},goog.inherits(goog.TransformedDependency,goog.Dependency),goog.TransformedDependency.prototype.load=function(t){function r(){l.contents_=goog.loadFileSync_(l.path),l.contents_&&(l.contents_=l.transform(l.contents_),l.contents_&&(l.contents_+="\n//# sourceURL="+l.path))}function e(){if(r(),l.contents_){s&&t.setModuleState(l.path,goog.ModuleType.ES6);try{var e=l.contents_;l.contents_=null,goog.globalEval(e)}finally{s&&t.clearModuleState()}s&&goog.global.$jscomp.require.ensure([l.path],function(){t.registerEs6ModuleExports(l.path,goog.global.$jscomp.require(l.path))}),t.loaded()}}var s,n,i,a,o,l=this;goog.global.CLOSURE_IMPORT_SCRIPT?(r(),this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,t.loaded()):t.pause()):(s=this.loadFlags.module==goog.ModuleType.ES6,1<t.pending().length&&goog.DebugLoader_.IS_OLD_IE_||goog.Dependency.defer_&&goog.isDocumentLoading_()?t.defer(function(){e()}):s&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(goog.Dependency.defer_=!0,n=goog.global.document,t.pause(),i=n.onreadystatechange,n.onreadystatechange=function(){(n.attachEvent?"complete"==n.readyState:"interactive"==n.readyState)&&(n.onreadystatechange=i,e(),t.resume()),goog.isFunction(i)&&i.apply(void 0,arguments)}):!goog.DebugLoader_.IS_OLD_IE_&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(a=goog.global.document,o=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(o),e()}),a.write('<script type="text/javascript">'+goog.protectScriptTag_('goog.Dependency.callback_("'+o+'");')+"<\/script>")):e())},goog.TransformedDependency.prototype.transform=function(e){},goog.TranspiledDependency=function(e,t,r,s,n,i){goog.TransformedDependency.call(this,e,t,r,s,n),this.transpiler=i},goog.inherits(goog.TranspiledDependency,goog.TransformedDependency),goog.TranspiledDependency.prototype.transform=function(e){return this.transpiler.transpile(e,this.path)},goog.GoogModuleDependency=function(e,t,r,s,n,i,a){goog.TransformedDependency.call(this,e,t,r,s,n),this.needsTranspile_=i,this.transpiler_=a},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(e){return this.needsTranspile_&&(e=this.transpiler_.transpile(e,this.path)),goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+this.path+"\n")+', "'+this.path+'");':'goog.loadModule(function(exports) {"use strict";'+e+'\n;return exports}, "'+this.path+'");\n//# sourceURL='+this.path+"\n"},goog.DebugLoader_.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader_.prototype.addDependency=function(e,t,r,s){t=t||[],e=e.replace(/\\/g,"/");var n=goog.normalizePath_(goog.basePath+e);for(s&&"boolean"!=typeof s||(s=s?{module:goog.ModuleType.GOOG}:{}),r=this.factory_.createDependency(n,e,t,r,s,goog.transpiler_.needsTranspile(s.lang||"es3",s.module)),this.dependencies_[n]=r,r=0;r<t.length;r++)this.idToPath_[t[r]]=n;this.idToPath_[e]=n},goog.DependencyFactory=function(e){this.transpiler=e},goog.DependencyFactory.prototype.createDependency=function(e,t,r,s,n,i){return n.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(e,t,r,s,n,i,this.transpiler):i?new goog.TranspiledDependency(e,t,r,s,n,this.transpiler):new(n.module==goog.ModuleType.ES6?goog.Es6ModuleDependency:goog.Dependency)(e,t,r,s,n)},goog.debugLoader_=new goog.DebugLoader_,goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(e){goog.debugLoader_.setDependencyFactory(e)},goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(e,t){goog.debugLoader_.bootstrap(e,t)}),{Variables:function(){}});sre.Variables.VERSION="2.2.2",sre.Variables.LOCALES=["en","es"],sre.Variables.mathjaxVersion="2.7.4",sre.Variables.url="https://cdn.jsdelivr.net/npm/speech-rule-engine@"+sre.Variables.VERSION+"/lib/mathmaps",sre.Variables.WGXpath="https://cdnjs.cloudflare.com/ajax/libs/mathjax/"+sre.Variables.mathjaxVersion+"/extensions/a11y/wgxpath.install.js",sre.SystemExternal=function(){},sre.SystemExternal.require=function(e){return"undefined"!=typeof process&&"undefined"!=typeof require?require(e):null},sre.SystemExternal.documentSupported=function(){return"undefined"!=typeof document},sre.SystemExternal.process=sre.SystemExternal.require("process"),sre.SystemExternal.xmldom=sre.SystemExternal.documentSupported()?window:sre.SystemExternal.require("xmldom-sre"),sre.SystemExternal.document=sre.SystemExternal.documentSupported()?document:(new sre.SystemExternal.xmldom.DOMImplementation).createDocument("","",0),sre.SystemExternal.xpath=sre.SystemExternal.documentSupported()?document:function(){var e={document:{}};return sre.SystemExternal.require("wicked-good-xpath").install(e),e.document.XPathResult=e.XPathResult,e.document}(),sre.SystemExternal.commander=sre.SystemExternal.documentSupported()?null:sre.SystemExternal.require("commander"),sre.SystemExternal.fs=sre.SystemExternal.documentSupported()?null:sre.SystemExternal.require("fs"),sre.SystemExternal.xm=sre.SystemExternal.documentSupported()?null:sre.SystemExternal.require("xml-mapping"),sre.SystemExternal.url=sre.Variables.url,sre.SystemExternal.jsonPath=(sre.SystemExternal.process&&"undefined"!=typeof global?sre.SystemExternal.process.env.SRE_JSON_PATH||global.SRE_JSON_PATH||sre.SystemExternal.process.cwd():sre.SystemExternal.url)+"/",sre.SystemExternal.WGXpath=sre.Variables.WGXpath,sre.SystemExternal.wgxpath=null,sre.BrowserUtil={},sre.BrowserUtil.detectIE=function(){return"undefined"!=typeof window&&"ActiveXObject"in window&&"clipboardData"in window&&(sre.BrowserUtil.loadMapsForIE_(),sre.BrowserUtil.loadWGXpath_(),!0)},sre.BrowserUtil.detectEdge=function(){return"undefined"!=typeof window&&"MSGestureEvent"in window&&"chrome"in window&&null==window.chrome.loadTimes&&(document.evaluate=null,sre.BrowserUtil.loadWGXpath_(!0),!0)},sre.BrowserUtil.mapsForIE=null,sre.BrowserUtil.loadWGXpath_=function(e){sre.BrowserUtil.loadScript(sre.SystemExternal.WGXpath),sre.BrowserUtil.installWGXpath_(e)},sre.BrowserUtil.installWGXpath_=function(e,t){var r=t||1;"undefined"==typeof wgxpath&&r<10?setTimeout(function(){sre.BrowserUtil.installWGXpath_(e,r++)},200):10<=r||(sre.SystemExternal.wgxpath=wgxpath,e?sre.SystemExternal.wgxpath.install({document:document}):sre.SystemExternal.wgxpath.install(),sre.XpathUtil.xpathEvaluate=document.evaluate,sre.XpathUtil.xpathResult=XPathResult,sre.XpathUtil.createNSResolver=document.createNSResolver)},sre.BrowserUtil.loadMapsForIE_=function(){sre.BrowserUtil.loadScript(sre.SystemExternal.jsonPath+"mathmaps_ie.js")},sre.BrowserUtil.loadScript=function(e){var t=sre.SystemExternal.document.createElement("script");t.type="text/javascript",t.src=e,(sre.SystemExternal.document.head||sre.SystemExternal.document.body).appendChild(t)},sre.DynamicProperties=function(e,t){this.properties_=e,this.order_=t||Object.keys(e)},sre.DynamicProperties.prototype.getProperties=function(){return this.properties_},sre.DynamicProperties.prototype.getOrder=function(){return this.order_},sre.DynamicProperties.prototype.getAxes=function(){return this.order_},sre.DynamicProperties.prototype.getProperty=function(e){return this.properties_[e]},sre.DynamicProperties.prototype.updateProperties=function(e){this.properties_=e},sre.DynamicProperties.prototype.allProperties=function(){var t=[];return this.order_.forEach(goog.bind(function(e){t.push(this.getProperty(e))},this)),t},sre.DynamicProperties.prototype.toString=function(){var t=[];return this.order_.forEach(goog.bind(function(e){t.push(e+": "+this.getProperty(e).toString())},this)),t.join("\n")},sre.DynamicCstr=function(e,t){var r,s={};for(r in this.components_=e){var n=e[r];s[r]=[n],sre.DynamicCstr.Values_.getInstance().add(r,n)}sre.DynamicProperties.call(this,s,t)},goog.inherits(sre.DynamicCstr,sre.DynamicProperties),sre.DynamicCstr.prototype.getComponents=function(){return this.components_},sre.DynamicCstr.prototype.getValue=function(e){return this.components_[e]},sre.DynamicCstr.prototype.getValues=function(){var t=[];return this.order_.forEach(goog.bind(function(e){t.push(this.getValue(e))},this)),t},sre.DynamicCstr.prototype.toString=function(){return this.getValues().join(".")},sre.DynamicCstr.prototype.equal=function(e){var t=e.getAxes();if(this.order_.length!==t.length)return!1;for(var r,s=0;r=t[s];s++){var n=this.getValue(r);if(!n||e.getValue(r)!==n)return!1}return!0},sre.DynamicCstr.Axis={DOMAIN:"domain",STYLE:"style",LOCALE:"locale",TOPIC:"topic",MODALITY:"modality"},sre.DynamicCstr.Values_=function(){this.axisToValues=sre.DynamicCstr.Values_.makeAxisValueObject_()},goog.addSingletonGetter(sre.DynamicCstr.Values_),sre.DynamicCstr.Values_.prototype.add=function(e,t){this.axisToValues[e][t]=!0},sre.DynamicCstr.Values_.prototype.get=function(){var e,t={},r=sre.DynamicCstr.Values_.getInstance().axisToValues;for(e in r)t[e]=Object.keys(r[e]);return t},sre.DynamicCstr.Values_.makeAxisValueObject_=function(){var e,t={};for(e in sre.DynamicCstr.Axis)t[sre.DynamicCstr.Axis[e]]={};return t},sre.DynamicCstr.getAxisValues=function(){return sre.DynamicCstr.Values_.getInstance().get()},sre.DynamicCstr.DEFAULT_ORDER=[sre.DynamicCstr.Axis.LOCALE,sre.DynamicCstr.Axis.DOMAIN,sre.DynamicCstr.Axis.STYLE,sre.DynamicCstr.Axis.TOPIC,sre.DynamicCstr.Axis.MODALITY],sre.DynamicCstr.DEFAULT_VALUE="default",sre.DynamicCstr.DEFAULT_VALUES={},sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]="en",sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.TOPIC]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.Parser=function(e){this.order_=e},sre.DynamicCstr.Parser.prototype.parse=function(e){var t={};if((e=e.split(".")).length>this.order_.length)throw Error("Invalid dynamic constraint: "+t);for(var r,s=0;r=this.order_[s],e.length;s++){var n=e.shift();t[r]=n}return new sre.DynamicCstr(t,this.order_.slice(0,s))},sre.DynamicCstr.Comparator=function(){},sre.DynamicCstr.Comparator.prototype.getReference=function(){},sre.DynamicCstr.Comparator.prototype.setReference=function(e,t){},sre.DynamicCstr.Comparator.prototype.match=function(e){},sre.DynamicCstr.Comparator.prototype.compare=function(e,t){},sre.DynamicCstr.DefaultComparator=function(e,t){this.reference_=e,this.fallback_=t||new sre.DynamicProperties(e.getProperties(),e.getOrder()),this.order_=this.reference_.getOrder()},sre.DynamicCstr.DefaultComparator.prototype.getReference=function(){return this.reference_},sre.DynamicCstr.DefaultComparator.prototype.setReference=function(e,t){this.reference_=e,this.fallback_=t||new sre.DynamicProperties(e.getProperties(),e.getOrder()),this.order_=this.reference_.getOrder()},sre.DynamicCstr.DefaultComparator.prototype.match=function(r){var e=r.getAxes();return e.length===this.reference_.getAxes().length&&e.every(goog.bind(function(e){var t=r.getValue(e);return t===this.reference_.getValue(e)||-1!==this.fallback_.getProperty(e).indexOf(t)},this))},sre.DynamicCstr.DefaultComparator.prototype.compare=function(e,t){for(var r,s=!1,n=0;r=this.order_[n];n++){var i=e.getValue(r),a=t.getValue(r);if(!s){var o=this.reference_.getValue(r);if(o===i&&o!==a)return-1;if(o===a&&o!==i)return 1;if(o===i&&o===a)continue;o!==i&&o!==a&&(s=!0)}if((i=(r=this.fallback_.getProperty(r)).indexOf(i))<(a=r.indexOf(a)))return-1;if(a<i)return 1}return 0},sre.DynamicProperties.create=function(e){for(var t=sre.DynamicCstr.DEFAULT_ORDER,r={},s=Array.prototype.slice.call(arguments,0),n=0,i=s.length,a=t.length;n<i&&n<a;n++)r[t[n]]=s[n];return new sre.DynamicProperties(r)},sre.DynamicCstr.create=function(e){for(var t=sre.DynamicCstr.DEFAULT_ORDER,r={},s=Array.prototype.slice.call(arguments,0),n=0,i=s.length,a=t.length;n<i&&n<a;n++)r[t[n]]=s[n];return new sre.DynamicCstr(r)},sre.DynamicCstr.defaultCstr=function(){return sre.DynamicCstr.create.apply(null,sre.DynamicCstr.DEFAULT_ORDER.map(function(e){return sre.DynamicCstr.DEFAULT_VALUES[e]}))},sre.DynamicCstr.validOrder=function(e){var t=sre.DynamicCstr.DEFAULT_ORDER.slice();return e.every(function(e){return-1!==(e=t.indexOf(e))&&t.splice(e,1)})},sre.Engine=function(){this.alternativeHost=this.activeHost=null,this.evaluator=sre.Engine.defaultEvaluator,this.dynamicCstr=sre.DynamicCstr.defaultCstr(),this.comparator=null,this.domain=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN],this.style="short",this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],this.walker="Syntax",this.semantics=!0,this.mode=sre.Engine.Mode.SYNC,this.speech=sre.Engine.Speech.SHALLOW,this.structure=!1,this.ruleSets=[],this.cache=!0,this.markup=sre.Engine.Markup.NONE,this.isEdge=this.isIE=this.strict=!1,this.setupTests_=[]},goog.addSingletonGetter(sre.Engine),sre.Engine.personalityProps={PITCH:"pitch",RATE:"rate",VOLUME:"volume",PAUSE:"pause"},sre.Engine.Mode={SYNC:"sync",ASYNC:"async",HTTP:"http"},sre.Engine.Speech={NONE:"none",SHALLOW:"shallow",DEEP:"deep"},sre.Engine.Markup={NONE:"none",SSML:"ssml",ACSS:"acss",SABLE:"sable",VOICEXML:"voicexml"},sre.Engine.registerTest=function(e){sre.Engine.getInstance().setupTests_.push(e)},sre.Engine.isReady=function(){return sre.Engine.getInstance().setupTests_.every(function(e){return e()})},sre.Engine.prototype.setupBrowsers=function(){this.isIE=sre.BrowserUtil.detectIE(),this.isEdge=sre.BrowserUtil.detectEdge()},sre.Engine.prototype.getAxisValues=function(){return sre.DynamicCstr.getAxisValues()},sre.Engine.defaultEvaluator=function(e,t){return e},sre.AudioUtil={},sre.AudioUtil.mergePause=function(e,t,r){return e?{pause:(r||function(e,t){return e+t}).call(null,e.pause,t.pause)}:t},sre.AudioUtil.mergeMarkup=function(t,r){delete t.open,r.close.forEach(function(e){delete t[e]}),r.open.forEach(function(e){t[e]=r[e]});var e=Object.keys(t);t.open=e},sre.AudioUtil.sortClose=function(r,e){if(r.length<=1)return r;for(var t,s=[],n=0;t=e[n],r.length;n++)t.close&&t.close.length&&t.close.forEach(function(e){var t=r.indexOf(e);-1!==t&&(s.unshift(e),r.splice(t,1))});return s},sre.AudioUtil.PersonalityRanges_={},sre.AudioUtil.LastOpen_=[],sre.AudioUtil.personalityMarkup=function(e){sre.AudioUtil.PersonalityRanges_={},sre.AudioUtil.LastOpen_=[];for(var t=[],r={},s=0;n=e[s];s++){var n,i=null,a=n.descriptionString();void 0!==(n=n.personality)[sre.Engine.personalityProps.PAUSE]&&((i={})[sre.Engine.personalityProps.PAUSE]=n[sre.Engine.personalityProps.PAUSE],delete n[sre.Engine.personalityProps.PAUSE]),n=sre.AudioUtil.personalityDiff_(n,r),sre.AudioUtil.appendMarkup_(t,a,n,i,!0)}return t},sre.AudioUtil.isMarkupElement=function(e){return"object"==typeof e&&e.open},sre.AudioUtil.isPauseElement=function(e){return"object"==typeof e&&1===Object.keys(e).length&&Object.keys(e)[0]===sre.Engine.personalityProps.PAUSE},sre.AudioUtil.isStringElement=function(e){return"object"==typeof e&&1===Object.keys(e).length&&"string"===Object.keys(e)[0]},sre.AudioUtil.appendMarkup_=function(e,t,r,s,n){var i;n&&((n=e[e.length-1])&&!t&&s&&sre.AudioUtil.isPauseElement(n)&&(n[i=sre.Engine.personalityProps.PAUSE]+=s[i],s=null),n&&t&&0===Object.keys(r).length&&sre.AudioUtil.isStringElement(n)&&(n.string+=" "+t,t="")),0!==Object.keys(r).length&&e.push(r),t&&e.push({string:t}),s&&e.push(s)},sre.AudioUtil.personalityDiff_=function(e,t){if(!t)return e;var r={};for(o in sre.Engine.personalityProps){var s,n=sre.Engine.personalityProps[o],i=e[n],a=t[n];!i&&!a||i&&a&&i===a||(s=i||0,sre.AudioUtil.isMarkupElement(r)||(r.open=[],r.close=[]),i||r.close.push(n),a||r.open.push(n),a&&i&&(r.close.push(n),r.open.push(n)),t[n]=s,r[n]=s,sre.AudioUtil.PersonalityRanges_[n]?sre.AudioUtil.PersonalityRanges_[n].push(s):sre.AudioUtil.PersonalityRanges_[n]=[s])}if(sre.AudioUtil.isMarkupElement(r)){for(e=r.close.slice();0<e.length;){var o=sre.AudioUtil.LastOpen_.pop(),n=sre.BaseUtil.setdifference(o,e);if(e=sre.BaseUtil.setdifference(e,o),o=n,0===e.length)0!==o.length&&sre.AudioUtil.LastOpen_.push(o);else if(0!==o.length)for(r.close=r.close.concat(o),r.open=r.open.concat(o),n=0;i=o[n];n++)r[i]=t[i]}sre.AudioUtil.LastOpen_.push(r.open)}return r},sre.AudioRenderer=function(){},sre.AudioRenderer.prototype.setSeparator=function(e){},sre.AudioRenderer.prototype.getSeparator=function(){},sre.AudioRenderer.prototype.markup=function(e){},sre.AudioRenderer.prototype.error=function(e){},sre.AudioRenderer.prototype.merge=function(e){},sre.AbstractAudioRenderer=function(){this.separator_=" "},sre.AbstractAudioRenderer.prototype.setSeparator=function(e){this.separator_=e},sre.AbstractAudioRenderer.prototype.getSeparator=function(){return this.separator_},sre.AbstractAudioRenderer.prototype.markup=goog.abstractMethod,sre.AbstractAudioRenderer.prototype.error=function(e){return null},sre.AbstractAudioRenderer.prototype.merge=function(e){return e.join(" ")},sre.MarkupRenderer=function(){sre.AbstractAudioRenderer.call(this),this.scaleFunction_=null},goog.inherits(sre.MarkupRenderer,sre.AbstractAudioRenderer),sre.MarkupRenderer.prototype.setScaleFunction=function(t,r,s,n,e){var i=e||0;this.scaleFunction_=function(e){return e=(e-t)/(r-t),+(Math.round(s*(1-e)+n*e+"e+"+i)+"e-"+i)}},sre.MarkupRenderer.prototype.applyScaleFunction=function(e){return this.scaleFunction_?this.scaleFunction_(e):e},sre.MarkupRenderer.prototype.pause=goog.abstractMethod,sre.MarkupRenderer.prototype.prosodyElement=goog.abstractMethod,sre.AcssRenderer=function(){sre.MarkupRenderer.call(this)},goog.inherits(sre.AcssRenderer,sre.MarkupRenderer),sre.AcssRenderer.prototype.markup=function(e){this.setScaleFunction(-2,2,0,10,0),e=sre.AudioUtil.personalityMarkup(e);for(var t,r,s=[],n={open:[]},i=null,a=!1,o=0;t=e[o];o++)sre.AudioUtil.isMarkupElement(t)?sre.AudioUtil.mergeMarkup(n,t):sre.AudioUtil.isPauseElement(t)?a&&(i=sre.AudioUtil.mergePause(i,t,Math.max)):(t='"'+t.string+'"',a=!0,i&&(s.push(this.pause(i)),i=null),r=this.prosody_(n),s.push(r?"(text ("+r+") "+t+")":t));return"(exp "+s.join(this.getSeparator())+")"},sre.AcssRenderer.prototype.merge=function(e){return"(exp "+e.map(function(e){return e.replace(/^\(exp /,"").replace(/\)$/,"")}).join(" ")+")"},sre.AcssRenderer.prototype.error=function(e){return'(error "'+e+'")'},sre.AcssRenderer.prototype.prosody_=function(e){for(var t,r=e.open,s=[],n=0;t=r[n];n++)s.push(this.prosodyElement(t,e[t]));return s.join(" ")},sre.AcssRenderer.prototype.prosodyElement=function(e,t){switch(t=this.applyScaleFunction(t),e){case sre.Engine.personalityProps.RATE:return"(richness . "+t+")";case sre.Engine.personalityProps.PITCH:return"(average-pitch . "+t+")";case sre.Engine.personalityProps.VOLUME:return"(stress . "+t+")"}return"(value . "+t+")"},sre.AcssRenderer.prototype.pause=function(e){return"(pause . "+e[sre.Engine.personalityProps.PAUSE]+")"},sre.XmlRenderer=function(){sre.MarkupRenderer.call(this)},goog.inherits(sre.XmlRenderer,sre.MarkupRenderer),sre.XmlRenderer.prototype.markup=function(e){this.setScaleFunction(-2,2,-100,100,2),e=sre.AudioUtil.personalityMarkup(e);for(var t,r=[],s=[],n=0;t=e[n];n++)if(t.string)r.push(t.string);else if(sre.AudioUtil.isPauseElement(t))r.push(this.pause(t));else{if(t.close.length)for(var i=0;i<t.close.length;i++){var a=s.pop();if(-1===t.close.indexOf(a))throw Error("Unknown closing markup element: "+a);r.push(this.closeTag(a))}t.open.length&&sre.AudioUtil.sortClose(t.open.slice(),e.slice(n+1)).forEach(goog.bind(function(e){r.push(this.prosodyElement(e,t[e])),s.push(e)},this))}return r.join(this.getSeparator())},sre.XmlRenderer.prototype.closeTag=goog.abstractMethod,sre.SableRenderer=function(){sre.XmlRenderer.call(this)},goog.inherits(sre.SableRenderer,sre.XmlRenderer),sre.SableRenderer.prototype.pause=function(e){return'<BREAK MSEC="'+e[sre.Engine.personalityProps.PAUSE]+'"/>'},sre.SableRenderer.prototype.prosodyElement=function(e,t){switch(t=this.applyScaleFunction(t),e){case sre.Engine.personalityProps.PITCH:return'<PITCH BASE="'+t+'%">';case sre.Engine.personalityProps.RATE:return'<RATE SPEED="'+t+'%">';case sre.Engine.personalityProps.VOLUME:return'<VOLUME LEVEL="'+t+'%">';default:return"<"+e.toUpperCase()+' VALUE="'+t+'">'}},sre.SableRenderer.prototype.closeTag=function(e){return"</"+e.toUpperCase()+">"},sre.SsmlRenderer=function(){sre.XmlRenderer.call(this)},goog.inherits(sre.SsmlRenderer,sre.XmlRenderer),sre.SsmlRenderer.prototype.pause=function(e){return'<BREAK TIME="'+e[sre.Engine.personalityProps.PAUSE]+'ms"/>'},sre.SsmlRenderer.prototype.prosodyElement=function(e,t){return t=(t=this.applyScaleFunction(t))<0?t.toString():"+"+t,"<PROSODY "+e.toUpperCase()+'="'+t+(e===sre.Engine.personalityProps.VOLUME?">":'%">')},sre.SsmlRenderer.prototype.closeTag=function(e){return"</PROSODY>"},sre.BaseUtil={},sre.BaseUtil.removeEmpty=function(e){return e.filter(function(e){return e})},sre.BaseUtil.interleaveLists=function(e,t){for(var r=[];e.length||t.length;)e.length&&r.push(e.shift()),t.length&&r.push(t.shift());return r},sre.BaseUtil.setdifference=function(e,t){return e?t?e.filter(function(e){return t.indexOf(e)<0}):e:[]},sre.BaseUtil.union=function(e,t){return e&&t?e.concat(sre.BaseUtil.setdifference(t,e)):e||t||[]},sre.BaseUtil.makePath=function(e){return e.match("/$")?e:e+"/"},sre.StringRenderer=function(){sre.AbstractAudioRenderer.call(this)},goog.inherits(sre.StringRenderer,sre.AbstractAudioRenderer),sre.StringRenderer.prototype.markup=function(e){return sre.BaseUtil.removeEmpty(e.map(function(e){return e.descriptionString()})).join(this.getSeparator())},sre.AuralRendering=function(){},goog.addSingletonGetter(sre.AuralRendering),sre.AuralRendering.prototype.setSeparator=function(e){var t=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];t&&t.setSeparator(e)},sre.AuralRendering.prototype.getSeparator=function(){var e=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return e?e.getSeparator():""},sre.AuralRendering.prototype.markup=function(e){var t=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return t?t.markup(e):""},sre.AuralRendering.prototype.merge=function(e){var t=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return t?t.merge(e):e.join()},sre.AuralRendering.prototype.error=function(e){var t=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return t?t.error(e):""},sre.AuralRendering.registerRenderer=function(e,t){sre.AuralRendering.rendererMapping_[e]=t},sre.AuralRendering.rendererMapping_={},sre.AuralRendering.registerRenderer(sre.Engine.Markup.NONE,new sre.StringRenderer),sre.AuralRendering.registerRenderer(sre.Engine.Markup.ACSS,new sre.AcssRenderer),sre.AuralRendering.registerRenderer(sre.Engine.Markup.SABLE,new sre.SableRenderer),sre.AuralRendering.xmlInstance=new sre.SsmlRenderer,sre.AuralRendering.registerRenderer(sre.Engine.Markup.VOICEXML,sre.AuralRendering.xmlInstance),sre.AuralRendering.registerRenderer(sre.Engine.Markup.SSML,sre.AuralRendering.xmlInstance),sre.Debugger=function(){this.isActive_=!1,this.outputFunction_=console.log,this.stream_=null},goog.addSingletonGetter(sre.Debugger),sre.Debugger.prototype.init=function(e){e&&this.startDebugFile_(e),this.isActive_=!0},sre.Debugger.prototype.startDebugFile_=function(e){this.stream_=sre.SystemExternal.fs.createWriteStream(e),this.outputFunction_=goog.bind(function(e){var t=Array.prototype.slice.call(arguments,0);this.stream_.write(t.join(" ")),this.stream_.write("\n")},this),this.stream_.on("error",goog.bind(function(e){console.log("Invalid log file. Debug information sent to console."),this.outputFunction_=console.log},this)),this.stream_.on("finish",function(){console.log("Finalizing debug file.")})},sre.Debugger.prototype.output_=function(e){this.outputFunction_.apply(console.log===this.outputFunction_?console:this.outputFunction_,["Speech Rule Engine Debugger:"].concat(e))},sre.Debugger.prototype.output=function(e){this.isActive_&&this.output_(Array.prototype.slice.call(arguments,0))},sre.Debugger.prototype.generateOutput=function(e){this.isActive_&&this.output_(e.apply(e,[]))},sre.Debugger.prototype.exit=function(e){this.isActive_&&this.stream_&&this.stream_.end("","",e||function(){})},sre.XpathUtil={},sre.XpathUtil.xpathSupported=function(){return"undefined"!=typeof XPathResult},sre.XpathUtil.currentDocument=null,sre.XpathUtil.xpathEvaluate=(sre.XpathUtil.xpathSupported()?document:sre.SystemExternal.xpath).evaluate,sre.XpathUtil.xpathResult=sre.XpathUtil.xpathSupported()?XPathResult:sre.SystemExternal.xpath.XPathResult,sre.XpathUtil.createNSResolver=(sre.XpathUtil.xpathSupported()?document:sre.SystemExternal.xpath).createNSResolver,sre.XpathUtil.nameSpaces_={xhtml:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},sre.XpathUtil.resolveNameSpace=function(e){return sre.XpathUtil.nameSpaces_[e]||null},sre.XpathUtil.resolver_=function(){this.lookupNamespaceURI=sre.XpathUtil.resolveNameSpace},sre.XpathUtil.evaluateXpath_=function(e,t,r){var s=sre.Engine.getInstance();return s.mode!==sre.Engine.Mode.HTTP||s.isIE||s.isEdge?sre.XpathUtil.xpathEvaluate(e,t,new sre.XpathUtil.resolver_,r,null):sre.XpathUtil.currentDocument.evaluate(e,t,sre.XpathUtil.resolveNameSpace,r,null)},sre.XpathUtil.evalXPath=function(e,t){try{var r=sre.XpathUtil.evaluateXpath_(e,t,sre.XpathUtil.xpathResult.ORDERED_NODE_ITERATOR_TYPE)}catch(e){return[]}for(e=[],t=r.iterateNext();t;t=r.iterateNext())e.push(t);return e},sre.XpathUtil.getLeafNodes=function(e){return sre.XpathUtil.evalXPath(".//*[count(*)=0]",e)},sre.XpathUtil.evaluateBoolean=function(e,t){try{var r=sre.XpathUtil.evaluateXpath_(e,t,sre.XpathUtil.xpathResult.BOOLEAN_TYPE)}catch(e){return!1}return r.booleanValue},sre.XpathUtil.evaluateString=function(e,t){try{var r=sre.XpathUtil.evaluateXpath_(e,t,sre.XpathUtil.xpathResult.STRING_TYPE)}catch(e){return""}return r.stringValue},sre.DomUtil={},sre.DomUtil.toArray=function(e){for(var t=[],r=0,s=e.length;r<s;r++)t.push(e[r]);return t},sre.DomUtil.trimInput_=function(e){return(e=e.replace(/&nbsp;/g," ")).replace(/>\s+</g,"><").trim()},sre.DomUtil.XML_ENTITIES={"&lt;":!0,"&gt;":!0,"&amp;":!0,"&quot;":!0,"&apos;":!0},sre.DomUtil.parseInput=function(e,t){t=t||Error;var r=new sre.SystemExternal.xmldom.DOMParser,s=!!(e=sre.DomUtil.trimInput_(e)).match(/&(?!lt|gt|amp|quot|apos)\w+;/g);if(!e)throw new t("Empty input!");try{var n=r.parseFromString(e,s?"text/html":"text/xml");return sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP?(sre.XpathUtil.currentDocument=n,s?n.body.childNodes[0]:n.documentElement):n.documentElement}catch(e){throw new t("Illegal input: "+e.message)}},sre.DomUtil.NodeType={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},sre.DomUtil.replaceNode=function(e,t){e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))},sre.DomUtil.createElement=function(e){return sre.SystemExternal.document.createElement(e)},sre.DomUtil.createTextNode=function(e){return sre.SystemExternal.document.createTextNode(e)},sre.DomUtil.formatXml=function(e){e=(e=e.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3")).replace(/(>)(.+)(<c)/g,"$1\r\n$2\r\n$3");var t="",r="";return e.split("\r\n").forEach(function(e){e.match(/.+<\/\w[^>]*>$/)?t+=r+e+"\r\n":e.match(/^<\/\w/)?r&&(r=r.slice(2),t+=r+e+"\r\n"):e.match(/^<\w[^>]*[^\/]>.*$/)?(t+=r+e+"\r\n",r+="  "):t+=r+e+"\r\n"}),t},sre.DomUtil.dataAttribute=function(e){return(e=e.match(/^data-/)?e.substr(5):e).replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})},sre.DomUtil.getDataAttribute=function(e,t){return e.dataset?e.dataset[sre.DomUtil.dataAttribute(t)]:e.getAttribute(t)},sre.DomUtil.querySelectorAllByAttr=function(e,t){return e.querySelectorAll?sre.DomUtil.toArray(e.querySelectorAll("["+t+"]")):sre.XpathUtil.evalXPath(".//*[@"+t+"]",e)},sre.DomUtil.querySelectorAllByAttrValue=function(e,t,r){return e.querySelectorAll?sre.DomUtil.toArray(e.querySelectorAll("["+t+'="'+r+'"]')):sre.XpathUtil.evalXPath(".//*[@"+t+'="'+r+'"]',e)},sre.DomUtil.querySelectorAll=function(e,t){return e.querySelectorAll?sre.DomUtil.toArray(e.querySelectorAll(t)):sre.XpathUtil.evalXPath(".//"+t,e)},sre.DomUtil.tagName=function(e){return e.tagName.toUpperCase()},sre.EnrichCase=function(){},sre.EnrichCase.prototype.getMathml=function(){},sre.AbstractEnrichCase=function(e){this.semantic=e},sre.AbstractEnrichCase.prototype.getMathml=goog.abstractMethod,sre.AbstractEnrichCase.test=goog.abstractMethod,sre.EnrichCaseFactory=function(){},sre.EnrichCaseFactory.getEmbellishedCase=function(e){return new sre.EnrichCaseFactory.embellishedCase(e)},sre.EnrichCaseFactory.cases=[],sre.EnrichCaseFactory.getCase=function(e){for(var t,r=0;t=sre.EnrichCaseFactory.cases[r];r++)if(t.test(e))return new t.constr(e);return null},sre.SemanticUtil=function(){},sre.SemanticUtil.objectsToKeys=function(e){e=Array.prototype.slice.call(arguments,0);var t=[];return t.concat.apply(t,e.map(Object.keys))},sre.SemanticUtil.objectsToValues=function(e){e=Array.prototype.slice.call(arguments,0);var r=[];return e.forEach(function(e){for(var t in e)r.push(e[t])}),r},sre.SemanticUtil.unicodeToNumber=function(e){return!e||2<e.length?null:2==e.length?(t=e.charCodeAt(0),e=e.charCodeAt(1),55296<=t&&t<=56319&&!isNaN(e)?1024*(t-55296)+(e-56320)+65536:null):e.charCodeAt(0);var t},sre.SemanticUtil.numberToUnicode=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode((e-65536)/1024+55296,(e-65536)%1024+56320)},sre.SemanticUtil.splitUnicode=function(e){e=e.split("");for(var t,r=[],s=0;t=e[s];s++)"\ud800"<=t&&t<="\udbff"&&e[s+1]?r.push(t+e[++s]):r.push(t);return r},sre.SemanticUtil.LEAFTAGS=["MO","MI","MN","MTEXT","MS"],sre.SemanticUtil.IGNORETAGS="MERROR MPHANTOM MSPACE MALIGNGROUP MALIGNMARK MPRESCRIPTS ANNOTATION ANNOTATION-XML".split(" "),sre.SemanticUtil.EMPTYTAGS="MATH MROW MPADDED MACTION NONE MSTYLE SEMANTICS".split(" "),sre.SemanticUtil.hasMathTag=function(e){return!!e&&"MATH"===sre.DomUtil.tagName(e)},sre.SemanticUtil.hasIgnoreTag=function(e){return!!e&&-1!==sre.SemanticUtil.IGNORETAGS.indexOf(sre.DomUtil.tagName(e))},sre.SemanticUtil.hasEmptyTag=function(e){return!!e&&-1!==sre.SemanticUtil.EMPTYTAGS.indexOf(sre.DomUtil.tagName(e))},sre.SemanticUtil.purgeNodes=function(e){for(var t,r=[],s=0;t=e[s];s++){var n=sre.DomUtil.tagName(t);-1!=sre.SemanticUtil.IGNORETAGS.indexOf(n)||-1!=sre.SemanticUtil.EMPTYTAGS.indexOf(n)&&0==t.childNodes.length||r.push(t)}return r},sre.SemanticUtil.isZeroLength=function(e){return!!e&&(-1!=="negativeveryverythinmathspace negativeverythinmathspace negativethinmathspace negativemediummathspace negativethickmathspace negativeverythickmathspace negativeveryverythickmathspace".split(" ").indexOf(e)||!!(e=e.match(/[0-9\.]+/))&&0===parseFloat(e))},sre.SemanticAttr=function(){this.generalPunctuations='!"#%&:;?@\\'.split(""),this.invisibleComma_=sre.SemanticUtil.numberToUnicode(8291),this.commas=[",",this.invisibleComma_],this.ellipses="".split(""),this.fullStops=[".","",""],this.dashes="".split(""),this.primes="'".split(""),this.openClosePairs={"(":")","[":"]","{":"}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},this.topBottomPairs={"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},this.leftFences=sre.SemanticUtil.objectsToKeys(this.openClosePairs),this.rightFences=sre.SemanticUtil.objectsToValues(this.openClosePairs),this.rightFences.push(""),this.topFences=sre.SemanticUtil.objectsToKeys(this.topBottomPairs),this.bottomFences=sre.SemanticUtil.objectsToValues(this.topBottomPairs),this.neutralFences="|".split(""),this.allFences=this.neutralFences.concat(this.leftFences,this.rightFences,this.topFences,this.bottomFences),this.capitalLatin="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),this.smallLatin="abcdefghijklmnopqrstuvwxyz".split(""),this.capitalLatinFullWidth="".split(""),this.smallLatinFullWidth="".split(""),this.capitalLatinBold="                         ".split(" "),this.smallLatinBold="                         ".split(" "),this.capitalLatinItalic="                         ".split(" "),this.smallLatinItalic="                           ".split(" "),this.capitalLatinScript="                          ".split(" "),this.smallLatinScript="                          ".split(" "),this.capitalLatinBoldScript="                         ".split(" "),this.smallLatinBoldScript="                         ".split(" "),this.capitalLatinFraktur="                         ".split(" "),this.smallLatinFraktur="                         ".split(" "),this.capitalLatinDoubleStruck="                         ".split(" "),this.smallLatinDoubleStruck="                         ".split(" "),this.capitalLatinBoldFraktur="                         ".split(" "),this.smallLatinBoldFraktur="                         ".split(" "),this.capitalLatinSansSerif="                         ".split(" "),this.smallLatinSansSerif="                         ".split(" "),this.capitalLatinSansSerifBold="                         ".split(" "),this.smallLatinSansSerifBold="                         ".split(" "),this.capitalLatinSansSerifItalic="                         ".split(" "),this.smallLatinSansSerifItalic="                         ".split(" "),this.capitalLatinMonospace="                         ".split(" "),this.smallLatinMonospace="                         ".split(" "),this.latinDoubleStruckItalic=["","","","",""],this.capitalGreek="".split(""),this.smallGreek="".split(""),this.capitalGreekBold="                       ".split(" "),this.smallGreekBold="                        ".split(" "),this.capitalGreekItalic="                       ".split(" "),this.smallGreekItalic="                        ".split(" "),this.capitalGreekSansSerifBold="                       ".split(" "),this.smallGreekSansSerifBold="                        ".split(" "),this.greekDoubleStruck=["","","",""],this.greekSpecial="".split(""),this.greekSpecialBold="     ".split(" "),this.greekSpecialItalic="     ".split(" "),this.greekSpecialSansSerifBold="     ".split(" "),this.hebrewLetters=["","","",""],this.allLetters=this.capitalLatin.concat(this.smallLatin,this.capitalLatinFullWidth,this.smallLatinFullWidth,this.capitalLatinBold,this.smallLatinBold,this.capitalLatinItalic,this.smallLatinItalic,this.capitalLatinScript,this.smallLatinScript,this.capitalLatinBoldScript,this.smallLatinBoldScript,this.capitalLatinFraktur,this.smallLatinFraktur,this.capitalLatinDoubleStruck,this.smallLatinDoubleStruck,this.capitalLatinBoldFraktur,this.smallLatinBoldFraktur,this.capitalLatinSansSerif,this.smallLatinSansSerif,this.capitalLatinSansSerifBold,this.smallLatinSansSerifBold,this.capitalLatinSansSerifItalic,this.smallLatinSansSerifItalic,this.capitalLatinMonospace,this.smallLatinMonospace,this.latinDoubleStruckItalic,this.capitalGreek,this.smallGreek,this.capitalGreekBold,this.smallGreekBold,this.capitalGreekItalic,this.smallGreekItalic,this.capitalGreekSansSerifBold,this.smallGreekSansSerifBold,this.greekDoubleStruck,this.greekSpecial,this.greekSpecialBold,this.greekSpecialItalic,this.greekSpecialSansSerifBold,this.hebrewLetters),this.additions="+".split(""),this.invisiblePlus_=sre.SemanticUtil.numberToUnicode(8292),this.additions.push(this.invisiblePlus_),this.multiplications="*".split(""),this.invisibleTimes_=sre.SemanticUtil.numberToUnicode(8290),this.multiplications.push(this.invisibleTimes_),this.subtractions="-".split(""),this.divisions="/".split(""),this.functionApplication_=sre.SemanticUtil.numberToUnicode(8289),this.equalities="=~".split(""),this.inequalities="<>".split(""),this.relations=[],this.arrows="".split(""),this.sumOps="".split(""),this.intOps="".split(""),this.prefixOps="".split(""),this.prefixOpsBold=["","","",""],this.prefixOpsItalic=["",""],this.prefixOpsSansSerifBold=["",""],this.operatorBits="".split(""),this.digitsNormal="0123456789".split(""),this.digitsFullWidth="".split(""),this.digitsBold="         ".split(" "),this.digitsDoubleStruck="         ".split(" "),this.digitsSansSerif="         ".split(" "),this.digitsSansSerifBold="         ".split(" "),this.digitsMonospace="         ".split(" "),this.digitsSuperscript="".split(""),this.digitsSubscript="".split(""),this.fractions="".split(""),this.enclosedNumbers="".split(""),this.fencedNumbers="".split(""),this.punctuatedNumbers="                              ".split(" "),this.digits=this.digitsNormal.concat(this.digitsFullWidth,this.digitsBold,this.digitsDoubleStruck,this.digitsSansSerif,this.digitsSansSerifBold,this.digitsMonospace),this.numbers=this.fractions.concat(this.digitsSuperscript,this.digitsSubscript,this.enclosedNumbers,this.fencedNumbers,this.punctuatedNumbers),this.allNumbers=this.digits.concat(this.numbers),this.trigonometricFunctions="cos cot csc sec sin tan arccos arccot arccsc arcsec arcsin arctan".split(" "),this.hyperbolicFunctions="cosh coth csch sech sinh tanh arcosh arcoth arcsch arsech arsinh artanh arccosh arccoth arccsch arcsech arcsinh arctanh".split(" "),this.algebraicFunctions="deg det dim hom ker Tr tr".split(" "),this.elementaryFunctions="log ln lg exp expt gcd gcd arg im re Pr".split(" "),this.prefixFunctions=this.trigonometricFunctions.concat(this.hyperbolicFunctions,this.algebraicFunctions,this.elementaryFunctions),this.limitFunctions="inf lim liminf limsup max min sup injlim projlim".split(" "),this.infixFunctions=["mod","rem"],this.symbolSetToSemantic_=[{set:this.generalPunctuations,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.UNKNOWN},{set:this.commas,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.COMMA},{set:this.ellipses,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.ELLIPSIS},{set:this.fullStops,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.FULLSTOP},{set:this.dashes,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.DASH},{set:this.primes,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.PRIME},{set:this.leftFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.OPEN},{set:this.rightFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.CLOSE},{set:this.topFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.TOP},{set:this.bottomFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.BOTTOM},{set:this.neutralFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.NEUTRAL},{set:this.smallLatin,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalLatin,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallLatinFullWidth,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalLatinFullWidth,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallLatinBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.capitalLatinBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.smallLatinItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.capitalLatinItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.smallLatinScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SCRIPT},{set:this.capitalLatinScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SCRIPT},{set:this.smallLatinBoldScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDSCRIPT},{set:this.capitalLatinBoldScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDSCRIPT},{set:this.smallLatinFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.FRAKTUR},{set:this.capitalLatinFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.FRAKTUR},{set:this.smallLatinDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.capitalLatinDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.smallLatinBoldFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDFRAKTUR},{set:this.capitalLatinBoldFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDFRAKTUR},{set:this.smallLatinSansSerif,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.capitalLatinSansSerif,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.smallLatinSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.capitalLatinSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.smallLatinSansSerifItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFITALIC},{set:this.capitalLatinSansSerifItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFITALIC},{set:this.smallLatinMonospace,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.capitalLatinMonospace,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.latinDoubleStruckItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCKITALIC},{set:this.smallGreek,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalGreek,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallGreekBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.capitalGreekBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.smallGreekItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.capitalGreekItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.smallGreekSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.capitalGreekSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.greekDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.greekSpecial,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.greekSpecialBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.greekSpecialItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.greekSpecialSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.hebrewLetters,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.OTHERLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsNormal,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsFullWidth,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsBold,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.BOLD},{set:this.digitsDoubleStruck,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.digitsSansSerif,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.digitsSansSerifBold,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.digitsMonospace,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.numbers,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.FLOAT},{set:this.additions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.ADDITION},{set:this.multiplications,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.MULTIPLICATION},{set:this.subtractions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.SUBTRACTION},{set:this.divisions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.DIVISION},{set:this.prefixOps,type:sre.SemanticAttr.Type.PREFIXOP,role:sre.SemanticAttr.Role.PREFIXFUNC},{set:this.prefixOpsBold,type:sre.SemanticAttr.Type.PREFIXOP,role:sre.SemanticAttr.Role.PREFIXFUNC,font:sre.SemanticAttr.Font.BOLD},{set:this.prefixOpsItalic,type:sre.SemanticAttr.Type.PREFIXOP,role:sre.SemanticAttr.Role.PREFIXFUNC,font:sre.SemanticAttr.Font.ITALIC},{set:this.prefixOpsSansSerifBold,type:sre.SemanticAttr.Type.PREFIXOP,role:sre.SemanticAttr.Role.PREFIXFUNC,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.equalities,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.EQUALITY},{set:this.inequalities,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.INEQUALITY},{set:this.relations,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.UNKNOWN},{set:this.arrows,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.ARROW},{set:this.sumOps,type:sre.SemanticAttr.Type.LARGEOP,role:sre.SemanticAttr.Role.SUM},{set:this.intOps,type:sre.SemanticAttr.Type.LARGEOP,role:sre.SemanticAttr.Role.INTEGRAL},{set:this.limitFunctions,type:sre.SemanticAttr.Type.FUNCTION,role:sre.SemanticAttr.Role.LIMFUNC},{set:this.prefixFunctions,type:sre.SemanticAttr.Type.FUNCTION,role:sre.SemanticAttr.Role.PREFIXFUNC},{set:this.infixFunctions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.MULTIPLICATION}],this.meaning_=this.initMeaning_()},goog.addSingletonGetter(sre.SemanticAttr),sre.SemanticAttr.Type={PUNCTUATION:"punctuation",FENCE:"fence",NUMBER:"number",IDENTIFIER:"identifier",TEXT:"text",OPERATOR:"operator",RELATION:"relation",LARGEOP:"largeop",FUNCTION:"function",ACCENT:"accent",FENCED:"fenced",FRACTION:"fraction",PUNCTUATED:"punctuated",RELSEQ:"relseq",MULTIREL:"multirel",INFIXOP:"infixop",PREFIXOP:"prefixop",POSTFIXOP:"postfixop",APPL:"appl",INTEGRAL:"integral",BIGOP:"bigop",SQRT:"sqrt",ROOT:"root",LIMUPPER:"limupper",LIMLOWER:"limlower",LIMBOTH:"limboth",SUBSCRIPT:"subscript",SUPERSCRIPT:"superscript",UNDERSCORE:"underscore",OVERSCORE:"overscore",TENSOR:"tensor",TABLE:"table",MULTILINE:"multiline",MATRIX:"matrix",VECTOR:"vector",CASES:"cases",ROW:"row",LINE:"line",CELL:"cell",ENCLOSE:"enclose",UNKNOWN:"unknown",EMPTY:"empty"},sre.SemanticAttr.Role={COMMA:"comma",ELLIPSIS:"ellipsis",FULLSTOP:"fullstop",DASH:"dash",PRIME:"prime",VBAR:"vbar",OPENFENCE:"openfence",CLOSEFENCE:"closefence",APPLICATION:"application",DUMMY:"dummy",UNIT:"unit",LABEL:"label",OPEN:"open",CLOSE:"close",TOP:"top",BOTTOM:"bottom",NEUTRAL:"neutral",LATINLETTER:"latinletter",GREEKLETTER:"greekletter",OTHERLETTER:"otherletter",INTEGER:"integer",FLOAT:"float",OTHERNUMBER:"othernumber",MIXED:"mixed",MULTIACCENT:"multiaccent",OVERACCENT:"overaccent",UNDERACCENT:"underaccent",UNDEROVER:"underover",SUBSUP:"subsup",LEFTSUB:"leftsub",LEFTSUPER:"leftsuper",RIGHTSUB:"rightsub",RIGHTSUPER:"rightsuper",LEFTRIGHT:"leftright",ABOVEBELOW:"abovebelow",STRING:"string",SEQUENCE:"sequence",ENDPUNCT:"endpunct",STARTPUNCT:"startpunct",TEXT:"text",NEGATIVE:"negative",NEGATION:"negation",MULTIOP:"multiop",LIMFUNC:"limit function",INFIXFUNC:"infix function",PREFIXFUNC:"prefix function",POSTFIXFUNC:"postfix function",SIMPLEFUNC:"simple function",SUM:"sum",INTEGRAL:"integral",ADDITION:"addition",MULTIPLICATION:"multiplication",SUBTRACTION:"subtraction",IMPLICIT:"implicit",DIVISION:"division",VULGAR:"vulgar",EQUALITY:"equality",INEQUALITY:"inequality",ELEMENT:"element",ARROW:"arrow",DETERMINANT:"determinant",ROWVECTOR:"rowvector",BINOMIAL:"binomial",SQUAREMATRIX:"squarematrix",MULTILINE:"multiline",MATRIX:"matrix",VECTOR:"vector",CASES:"cases",TABLE:"table",UNKNOWN:"unknown",PROTECTED:"protected"},sre.SemanticAttr.Font={BOLD:"bold",BOLDFRAKTUR:"bold-fraktur",BOLDITALIC:"bold-italic",BOLDSCRIPT:"bold-script",CALIGRAPHIC:"caligraphic",CALIGRAPHICBOLD:"caligraphic-bold",DOUBLESTRUCK:"double-struck",DOUBLESTRUCKITALIC:"double-struck-italic",FRAKTUR:"fraktur",ITALIC:"italic",MONOSPACE:"monospace",NORMAL:"normal",OLDSTYLE:"oldstyle",OLDSTYLEBOLD:"oldstyle-bold",SCRIPT:"script",SANSSERIF:"sans-serif",SANSSERIFITALIC:"sans-serif-italic",SANSSERIFBOLD:"sans-serif-bold",SANSSERIFBOLDITALIC:"sans-serif-bold-italic",UNKNOWN:"unknown"},sre.SemanticAttr.prototype.lookupType=function(e){return sre.SemanticAttr.Type.UNKNOWN},sre.SemanticAttr.prototype.lookupRole=function(e){return sre.SemanticAttr.Role.UNKNOWN},sre.SemanticAttr.lookupMeaning=function(e){return sre.SemanticAttr.getInstance().lookupMeaning_(e)},sre.SemanticAttr.invisibleTimes=function(){return sre.SemanticAttr.getInstance().invisibleTimes_},sre.SemanticAttr.invisibleComma=function(){return sre.SemanticAttr.getInstance().invisibleComma_},sre.SemanticAttr.functionApplication=function(){return sre.SemanticAttr.getInstance().functionApplication_},sre.SemanticAttr.isMatchingFenceRole=function(e,t){return e==sre.SemanticAttr.Role.OPEN&&t==sre.SemanticAttr.Role.CLOSE||e==sre.SemanticAttr.Role.NEUTRAL&&t==sre.SemanticAttr.Role.NEUTRAL||e==sre.SemanticAttr.Role.TOP&&t==sre.SemanticAttr.Role.BOTTOM},sre.SemanticAttr.isMatchingFence=function(e,t){return sre.SemanticAttr.getInstance().isMatchingFence_(e,t)},sre.SemanticAttr.isOpeningFence=function(e){return e==sre.SemanticAttr.Role.OPEN||e==sre.SemanticAttr.Role.NEUTRAL},sre.SemanticAttr.isClosingFence=function(e){return e==sre.SemanticAttr.Role.CLOSE||e==sre.SemanticAttr.Role.NEUTRAL},sre.SemanticAttr.isEmbellishedType=function(e){return e===sre.SemanticAttr.Type.OPERATOR||e===sre.SemanticAttr.Type.RELATION||e===sre.SemanticAttr.Type.FENCE||e===sre.SemanticAttr.Type.PUNCTUATION},sre.SemanticAttr.isCharacterD=function(e){return-1!="d             ".split(" ").indexOf(e)},sre.SemanticAttr.prototype.isMatchingFence_=function(e,t){return-1!=this.neutralFences.indexOf(e)?e==t:this.openClosePairs[e]==t||this.topBottomPairs[e]==t},sre.SemanticAttr.prototype.initMeaning_=function(){for(var t,r={},e=0;t=this.symbolSetToSemantic_[e];e++)t.set.forEach(function(e){r[e]={role:t.role||sre.SemanticAttr.Role.UNKNOWN,type:t.type||sre.SemanticAttr.Type.UNKNOWN,font:t.font||sre.SemanticAttr.Font.UNKNOWN}});return r},sre.SemanticAttr.prototype.lookupMeaning_=function(e){return this.meaning_[e]||{role:sre.SemanticAttr.Role.UNKNOWN,type:sre.SemanticAttr.Type.UNKNOWN,font:sre.SemanticAttr.Font.UNKNOWN}},sre.MathUtil={},sre.MathUtil.isMathmlNodeOfClass_=function(e,t){return-1!=t.indexOf(e.tagName.toUpperCase())},sre.MathUtil.isMathjaxNodeOfClass_=function(e,t){return"SPAN"==e.tagName&&e.className.split(" ").some(function(e){return-1!=t.indexOf(e.toUpperCase())})},sre.MathUtil.isMathNodeOfClass_=function(e,t){return e.nodeType==sre.DomUtil.NodeType.ELEMENT_NODE&&(sre.MathUtil.isMathmlNodeOfClass_(e,t)||sre.MathUtil.isMathjaxNodeOfClass_(e,t))},sre.MathUtil.TOKEN_LIST="MI MN MO MTEXT MSPACE MS".split(" "),sre.MathUtil.isToken=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.TOKEN_LIST)},sre.MathUtil.LAYOUT_LIST="MROW MFRAC MSQRT MROOT MSTYLE MERROR MPADDED MPHANTOM MFENCED MENCLOSE".split(" "),sre.MathUtil.isLayout=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.LAYOUT_LIST)},sre.MathUtil.SCRIPT_LIST="MSUB MSUP MSUBSUP MUNDER MOVER MUNDEROVER MMULTISCRIPTS MPRESCRIPTS".split(" "),sre.MathUtil.isScript=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.SCRIPT_LIST)},sre.MathUtil.TABLES_LIST="MTABLE MLABELEDTR MTR MTD MALIGNGROUP MALIGNMARK".split(" "),sre.MathUtil.isTables=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.TABLES_LIST)},sre.MathUtil.ELEMENTARY_LIST="MSTACK MLONGDIV MSGROUP MSROW MSCARRIES MSCARRY MSLINE".split(" "),sre.MathUtil.isElementary=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.ELEMENTARY_LIST)},sre.MathUtil.MATHML_TAG_LIST=[sre.MathUtil.TOKEN_LIST,sre.MathUtil.LAYOUT_LIST,sre.MathUtil.SCRIPT_LIST,sre.MathUtil.TABLES_LIST,sre.MathUtil.ELEMENTARY_LIST].reduce(function(e,t){return e.concat(t)}),sre.MathUtil.isMathmlTag=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.MATHML_TAG_LIST)},sre.MathUtil.WHITESPACE_LIST=["MSROW","MROW","MSPACE","MPHANTOM","MPADDED"],sre.MathUtil.isWhitespace=function(e){return sre.MathUtil.isMathNodeOfClass_(e,sre.MathUtil.WHITESPACE_LIST)},sre.MathUtil.isNotWhitespace=function(e){return sre.MathUtil.isMathmlTag(e)&&!sre.MathUtil.isWhitespace(e)},sre.MathUtil.nextSeparatorFunction=function(e){if(e){if(e.match(/^\s+$/))return null;var t=e.replace(/\s/g,"").split("").filter(function(e){return e})}else t=[","];return function(){return 1<t.length?t.shift():t[0]}},sre.SemanticNode=function(e){this.id=e,this.mathml=[],this.parent=null,this.type=sre.SemanticAttr.Type.UNKNOWN,this.role=sre.SemanticAttr.Role.UNKNOWN,this.font=sre.SemanticAttr.Font.UNKNOWN,this.embellished=null,this.fencePointer="",this.childNodes=[],this.textContent="",this.mathmlTree=null,this.contentNodes=[]},sre.SemanticNode.prototype.querySelectorAll=function(e){for(var t,r=[],s=0;t=this.childNodes[s];s++)r=r.concat(t.querySelectorAll(e));return e(this)&&r.unshift(this),r},sre.SemanticNode.prototype.xml=function(n,i){function e(e,t){t=t.map(function(e){return e.xml(n,i)}),e=n.createElementNS("",e);for(var r,s=0;r=t[s];s++)e.appendChild(r);return e}var t=n.createElementNS("",this.type);return i||this.xmlAttributes_(t),t.textContent=this.textContent,0<this.contentNodes.length&&t.appendChild(e("content",this.contentNodes)),0<this.childNodes.length&&t.appendChild(e("children",this.childNodes)),t},sre.SemanticNode.prototype.toString=function(e){var t=new sre.SystemExternal.xmldom.XMLSerializer,r=(new sre.SystemExternal.xmldom.DOMParser).parseFromString("","text/xml");return t.serializeToString(this.xml(r,e))},sre.SemanticNode.prototype.xmlAttributes_=function(e){e.setAttribute("role",this.role),this.font!=sre.SemanticAttr.Font.UNKNOWN&&e.setAttribute("font",this.font),this.embellished&&e.setAttribute("embellished",this.embellished),this.fencePointer&&e.setAttribute("fencepointer",this.fencePointer),e.setAttribute("id",this.id)},sre.SemanticNode.prototype.updateContent=function(e){var t=e.trim();this.textContent!=(e=e&&!t?e:t)&&(t=sre.SemanticAttr.lookupMeaning(e),this.textContent=e,this.role=t.role,this.type=t.type,this.font=t.font)},sre.SemanticNode.prototype.addMathmlNodes=function(e){for(var t,r=0;t=e[r];r++)-1==this.mathml.indexOf(t)&&this.mathml.push(t)},sre.SemanticNode.prototype.removeMathmlNodes_=function(e){for(var t,r=this.mathml,s=0;t=e[s];s++)-1!=(t=r.indexOf(t))&&r.splice(t,1);this.mathml=r},sre.SemanticNode.prototype.appendChild=function(e){this.childNodes.push(e),this.addMathmlNodes(e.mathml),e.parent=this},sre.SemanticNode.prototype.replaceChild=function(t,r){var e,s=this.childNodes.indexOf(t);-1!=s&&(t.parent=null,(r.parent=this).childNodes[s]=r,s=t.mathml.filter(function(e){return-1==r.mathml.indexOf(e)}),e=r.mathml.filter(function(e){return-1==t.mathml.indexOf(e)}),this.removeMathmlNodes_(s),this.addMathmlNodes(e))},sre.SemanticNode.prototype.appendContentNode=function(e){e&&(this.contentNodes.push(e),this.addMathmlNodes(e.mathml),e.parent=this)},sre.SemanticNode.prototype.removeContentNode=function(e){e&&(-1!=(e=this.contentNodes.indexOf(e))&&this.contentNodes.slice(e,1))},sre.SemanticNode.prototype.equals=function(e){if(!e||this.type!==e.type||this.role!==e.role||this.textContent!==e.textContent||this.childNodes.length!==e.childNodes.length||this.contentNodes.length!==e.contentNodes.length)return!1;for(var t,r,s=0;t=this.childNodes[s],r=e.childNodes[s];s++)if(!t.equals(r))return!1;for(s=0;t=this.contentNodes[s],r=e.contentNodes[s];s++)if(!t.equals(r))return!1;return!0},sre.SemanticNode.prototype.displayTree=function(t){t++;var e=Array(t).join("  ");console.log(e+this.toString()),console.log(e+"MathmlTree:"),console.log(e+this.mathmlTreeString_()),console.log(e+"MathML:");for(var r,s=0;r=this.mathml[s];s++)console.log(e+r.toString());console.log(e+"Begin Content"),this.contentNodes.forEach(function(e){e.displayTree(t)}),console.log(e+"End Content"),console.log(e+"Begin Children"),this.childNodes.forEach(function(e){e.displayTree(t)}),console.log(e+"End Children")},sre.SemanticNode.prototype.mathmlTreeString_=function(){return this.mathmlTree?this.mathmlTree.toString():"EMPTY"},sre.SemanticNodeFactory=function(){this.idCounter_=0},sre.SemanticNodeFactory.prototype.createNode_=function(){return new sre.SemanticNode(this.idCounter_++)},sre.SemanticNodeFactory.prototype.makeUnprocessed=function(e){var t=this.createNode_();return t.mathml=[e],t},sre.SemanticNodeFactory.prototype.makeEmptyNode=function(){var e=this.createNode_();return e.type=sre.SemanticAttr.Type.EMPTY,e},sre.SemanticNodeFactory.prototype.makeContentNode=function(e){var t=this.createNode_();return t.updateContent(e),t},sre.SemanticNodeFactory.prototype.makeMultipleContentNodes=function(e,t){for(var r=[],s=0;s<e;s++)r.push(this.makeContentNode(t));return r},sre.SemanticNodeFactory.prototype.makeLeafNode=function(e,t){return e?((e=this.makeContentNode(e)).font=t||e.font,e):this.makeEmptyNode()},sre.SemanticNodeFactory.prototype.makeBranchNode=function(e,t,r,s){var n=this.createNode_();return s&&n.updateContent(s),n.type=e,n.childNodes=t,n.contentNodes=r,t.concat(r).forEach(function(e){(e.parent=n).addMathmlNodes(e.mathml)}),n},sre.SemanticParser=function(){},sre.SemanticParser.prototype.parse=function(e){},sre.SemanticParser.prototype.getFactory=function(){},sre.SemanticParser.prototype.setFactory=function(e){},sre.SemanticParser.prototype.getType=function(){},sre.SemanticAbstractParser=function(e){this.type_=e,this.factory_=new sre.SemanticNodeFactory},sre.SemanticAbstractParser.prototype.getFactory=function(){return this.factory_},sre.SemanticAbstractParser.prototype.setFactory=function(e){this.factory_=e},sre.SemanticAbstractParser.prototype.getType=function(){return this.type_},sre.SemanticAbstractParser.prototype.parse=goog.abstractMethod,sre.SemanticPred={},sre.SemanticPred.isAttribute=function(r,s){return function(e){switch(e=e[r],r){case"role":var t=sre.SemanticAttr.Role[s];break;case"font":t=sre.SemanticAttr.Font[s];break;default:t=sre.SemanticAttr.Type[s]}return e===t}},sre.SemanticPred.isAccent=function(e){return sre.SemanticPred.isAttribute("type","FENCE")(e)||sre.SemanticPred.isAttribute("type","PUNCTUATION")(e)||sre.SemanticPred.isAttribute("type","OPERATOR")(e)||sre.SemanticPred.isAttribute("type","RELATION")(e)||sre.SemanticPred.isAttribute("type","IDENTIFIER")(e)&&sre.SemanticPred.isAttribute("role","UNKNOWN")(e)&&!e.textContent.match(new RegExp(sre.SemanticAttr.getInstance().allLetters.join("|")))},sre.SemanticPred.isSimpleFunction=function(e){return 0===(e=e.childNodes).length||!(1<e.length)&&((e=e[0]).type!==sre.SemanticAttr.Type.INFIXOP||e.role===sre.SemanticAttr.Role.IMPLICIT&&!e.childNodes.some(sre.SemanticPred.isAttribute("type","INFIXOP")))},sre.SemanticPred.isPrefixFunctionBoundary=function(e){return sre.SemanticPred.isOperator(e)||sre.SemanticPred.isGeneralFunctionBoundary(e)},sre.SemanticPred.isIntegralDxBoundary=function(e,t){return!!t&&sre.SemanticPred.isAttribute("type","IDENTIFIER")(t)&&sre.SemanticAttr.isCharacterD(e.textContent)},sre.SemanticPred.isIntegralDxBoundarySingle=function(e){var t;return!!sre.SemanticPred.isAttribute("type","IDENTIFIER")(e)&&((t=e.textContent[0])&&e.textContent[1]&&sre.SemanticAttr.isCharacterD(t))},sre.SemanticPred.isGeneralFunctionBoundary=function(e){return sre.SemanticPred.isRelation(e)||sre.SemanticPred.isPunctuation(e)},sre.SemanticPred.isEmbellished=function(e){return e.embellished||(sre.SemanticAttr.isEmbellishedType(e.type)?e.type:null)},sre.SemanticPred.isOperator=function(e){return sre.SemanticPred.isAttribute("type","OPERATOR")(e)||sre.SemanticPred.isAttribute("embellished","OPERATOR")(e)},sre.SemanticPred.isRelation=function(e){return sre.SemanticPred.isAttribute("type","RELATION")(e)||sre.SemanticPred.isAttribute("embellished","RELATION")(e)},sre.SemanticPred.isPunctuation=function(e){return sre.SemanticPred.isAttribute("type","PUNCTUATION")(e)||sre.SemanticPred.isAttribute("embellished","PUNCTUATION")(e)},sre.SemanticPred.isFence=function(e){return sre.SemanticPred.isAttribute("type","FENCE")(e)||sre.SemanticPred.isAttribute("embellished","FENCE")(e)},sre.SemanticPred.isElligibleEmbellishedFence=function(e){if(!e||!sre.SemanticPred.isFence(e))return!1;if(!e.embellished)return!0;function t(e){return!e.embellished||!(!(!sre.SemanticPred.isAttribute("type","TENSOR")(e)||sre.SemanticPred.isAttribute("type","EMPTY")(e.childNodes[1])&&sre.SemanticPred.isAttribute("type","EMPTY")(e.childNodes[2])||sre.SemanticPred.isAttribute("type","EMPTY")(e.childNodes[3])&&sre.SemanticPred.isAttribute("type","EMPTY")(e.childNodes[4]))||sre.SemanticPred.isAttribute("role","CLOSE")(e)&&sre.SemanticPred.isAttribute("type","TENSOR")(e)||sre.SemanticPred.isAttribute("role","OPEN")(e)&&(sre.SemanticPred.isAttribute("type","SUBSCRIPT")(e)||sre.SemanticPred.isAttribute("type","SUPERSCRIPT")(e)))&&t(e.childNodes[0])}return t(e)},sre.SemanticPred.isTableOrMultiline=function(e){return!!e&&(sre.SemanticPred.isAttribute("type","TABLE")(e)||sre.SemanticPred.isAttribute("type","MULTILINE")(e))},sre.SemanticPred.tableIsMatrixOrVector=function(e){return!!e&&sre.SemanticPred.isAttribute("type","FENCED")(e)&&(sre.SemanticPred.isAttribute("role","LEFTRIGHT")(e)||sre.SemanticPred.isAttribute("role","NEUTRAL")(e))&&1===e.childNodes.length&&sre.SemanticPred.isTableOrMultiline(e.childNodes[0])},sre.SemanticPred.tableIsCases=function(e,t){return 0<t.length&&sre.SemanticPred.isAttribute("role","OPENFENCE")(t[t.length-1])},sre.SemanticPred.tableIsMultiline=function(e){return e.childNodes.every(function(e){return e.childNodes.length<=1})},sre.SemanticPred.isBinomial=function(e){return 2===e.childNodes.length},sre.SemanticPred.isLimitBase=function(e){return sre.SemanticPred.isAttribute("type","LARGEOP")(e)||sre.SemanticPred.isAttribute("type","LIMBOTH")(e)||sre.SemanticPred.isAttribute("type","LIMLOWER")(e)||sre.SemanticPred.isAttribute("type","LIMUPPER")(e)||sre.SemanticPred.isAttribute("type","FUNCTION")(e)&&sre.SemanticPred.isAttribute("role","LIMFUNC")(e)},sre.SemanticPred.isSimpleFunctionHead=function(e){return e.type===sre.SemanticAttr.Type.IDENTIFIER||e.role===sre.SemanticAttr.Role.LATINLETTER||e.role===sre.SemanticAttr.Role.GREEKLETTER||e.role===sre.SemanticAttr.Role.OTHERLETTER},sre.SemanticPred.singlePunctAtPosition=function(e,t,r){return 1===t.length&&e[r].type===sre.SemanticAttr.Type.PUNCTUATION&&e[r]===t[0]},sre.SemanticProcessor=function(){this.factory_=new sre.SemanticNodeFactory},goog.addSingletonGetter(sre.SemanticProcessor),sre.SemanticProcessor.prototype.setNodeFactory=function(e){this.factory_=e},sre.SemanticProcessor.prototype.identifierNode=function(e,t,r){if(e=sre.SemanticProcessor.getInstance().factory_.makeLeafNode(e,t),"MathML-Unit"===r)e.type=sre.SemanticAttr.Type.IDENTIFIER,e.role=sre.SemanticAttr.Role.UNIT;else if(!t&&1===e.textContent.length&&(e.role===sre.SemanticAttr.Role.INTEGER||e.role===sre.SemanticAttr.Role.LATINLETTER||e.role===sre.SemanticAttr.Role.GREEKLETTER)&&e.font===sre.SemanticAttr.Font.NORMAL)return e.font=sre.SemanticAttr.Font.ITALIC,e;return e.type===sre.SemanticAttr.Type.UNKNOWN&&(e.type=sre.SemanticAttr.Type.IDENTIFIER),sre.SemanticProcessor.exprFont_(e),e},sre.SemanticProcessor.prototype.implicitNode_=function(e){if(e=sre.SemanticProcessor.getInstance().getMixedNumbers_(e),1===(e=sre.SemanticProcessor.getInstance().combineUnits_(e)).length)return e[0];var t=sre.SemanticProcessor.getInstance().factory_.makeMultipleContentNodes(e.length-1,sre.SemanticAttr.invisibleTimes()),r=sre.SemanticProcessor.getInstance().infixNode_(e,t[0]);return r.role=sre.SemanticAttr.Role.IMPLICIT,t.forEach(function(e){e.parent=r}),r.contentNodes=t,r},sre.SemanticProcessor.prototype.infixNode_=function(e,t){return(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.INFIXOP,e,[t],sre.SemanticProcessor.getEmbellishedInner_(t).textContent)).role=t.role,e},sre.SemanticProcessor.prototype.concatNode_=function(e,t,r){if(0===t.length)return e;var s=t.map(function(e){return sre.SemanticProcessor.getEmbellishedInner_(e).textContent}).join(" ");return e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(r,[e],t,s),1<t.length&&(e.role=sre.SemanticAttr.Role.MULTIOP),e},sre.SemanticProcessor.prototype.prefixNode_=function(e,t){for(t=sre.SemanticProcessor.partitionNodes_(t,sre.SemanticPred.isAttribute("role","SUBTRACTION")),e=sre.SemanticProcessor.getInstance().concatNode_(e,t.comp.pop(),sre.SemanticAttr.Type.PREFIXOP);0<t.rel.length;)(e=sre.SemanticProcessor.getInstance().concatNode_(e,[t.rel.pop()],sre.SemanticAttr.Type.PREFIXOP)).role=sre.SemanticAttr.Role.NEGATIVE,e=sre.SemanticProcessor.getInstance().concatNode_(e,t.comp.pop(),sre.SemanticAttr.Type.PREFIXOP);return e},sre.SemanticProcessor.prototype.postfixNode_=function(e,t){return t.length?sre.SemanticProcessor.getInstance().concatNode_(e,t,sre.SemanticAttr.Type.POSTFIXOP):e},sre.SemanticProcessor.prototype.text=function(e,t,r){return(e=sre.SemanticProcessor.getInstance().factory_.makeLeafNode(e,t)).type=sre.SemanticAttr.Type.TEXT,"MS"===r&&(e.role=sre.SemanticAttr.Role.STRING),sre.SemanticProcessor.exprFont_(e),e},sre.SemanticProcessor.prototype.row=function(e){return 0===(e=e.filter(function(e){return!sre.SemanticPred.isAttribute("type","EMPTY")(e)})).length?sre.SemanticProcessor.getInstance().factory_.makeEmptyNode():(e=sre.SemanticProcessor.getInstance().getFencesInRow_(e),e=sre.SemanticProcessor.getInstance().tablesInRow(e),e=sre.SemanticProcessor.getInstance().getPunctuationInRow_(e),e=sre.SemanticProcessor.getInstance().getTextInRow_(e),e=sre.SemanticProcessor.getInstance().getFunctionsInRow_(e),sre.SemanticProcessor.getInstance().relationsInRow_(e))},sre.SemanticProcessor.prototype.combineUnits_=function(e){var t=sre.SemanticProcessor.partitionNodes_(e,function(e){return!sre.SemanticPred.isAttribute("role","UNIT")(e)});if(e.length===t.rel.length)return t.rel;e=[];do{var r,s=t.comp.shift(),n=t.rel.shift()}while(1===s.length&&(e=e.concat(s)),1<s.length&&(r=sre.SemanticProcessor.getInstance().factory_.makeContentNode(sre.SemanticAttr.invisibleTimes()),(s=sre.SemanticProcessor.getInstance().infixNode_(s,r)).role=sre.SemanticAttr.Role.UNIT,e.push(s)),n&&e.push(n),n);return e},sre.SemanticProcessor.prototype.getMixedNumbers_=function(e){var t=sre.SemanticProcessor.partitionNodes_(e,function(e){return sre.SemanticPred.isAttribute("type","FRACTION")(e)&&sre.SemanticPred.isAttribute("role","VULGAR")(e)});if(!t.rel.length)return e;e=[];for(var r,s=0;r=t.rel[s];s++){var n=t.comp[s],i=n.length-1;(e=n[i]&&sre.SemanticPred.isAttribute("type","NUMBER")(n[i])&&sre.SemanticPred.isAttribute("role","INTEGER")(n[i])?((r=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.NUMBER,[n[i],r],[])).role=sre.SemanticAttr.Role.MIXED,e.concat(n.slice(0,i))):e.concat(n)).push(r)}return e.concat(t.comp[t.comp.length-1])},sre.SemanticProcessor.prototype.getTextInRow_=function(e){if(e.length<=1)return e;var t=sre.SemanticProcessor.partitionNodes_(e,sre.SemanticPred.isAttribute("type","TEXT"));if(0===t.rel.length)return e;e=[];var r=t.comp[0];0<r.length&&e.push(sre.SemanticProcessor.getInstance().row(r));for(var s=0;r=t.rel[s];s++)e.push(r),0<(r=t.comp[s+1]).length&&e.push(sre.SemanticProcessor.getInstance().row(r));return[sre.SemanticProcessor.getInstance().dummyNode_(e)]},sre.SemanticProcessor.prototype.relationsInRow_=function(e){var t=sre.SemanticProcessor.partitionNodes_(e,sre.SemanticPred.isRelation),r=t.rel[0];return r?1===e.length?e[0]:(e=t.comp.map(goog.bind(sre.SemanticProcessor.getInstance().operationsInRow_,this)),t.rel.some(function(e){return!e.equals(r)})?(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.MULTIREL,e,t.rel),t.rel.every(function(e){return e.role===r.role})&&(e.role=r.role)):(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.RELSEQ,e,t.rel,sre.SemanticProcessor.getEmbellishedInner_(r).textContent)).role=r.role,e):sre.SemanticProcessor.getInstance().operationsInRow_(e)},sre.SemanticProcessor.prototype.operationsInRow_=function(e){if(0===e.length)return sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();if(1===e.length)return e[0];for(var t=[];0<e.length&&sre.SemanticPred.isOperator(e[0]);)t.push(e.shift());return 0===e.length?sre.SemanticProcessor.getInstance().prefixNode_(t.pop(),t):1===e.length?sre.SemanticProcessor.getInstance().prefixNode_(e[0],t):(e=sre.SemanticProcessor.sliceNodes_(e,sre.SemanticPred.isOperator),t=sre.SemanticProcessor.getInstance().prefixNode_(sre.SemanticProcessor.getInstance().implicitNode_(e.head),t),e.div?sre.SemanticProcessor.getInstance().operationsTree_(e.tail,t,e.div):t)},sre.SemanticProcessor.prototype.operationsTree_=function(e,t,r,s){return s=s||[],0===e.length?(s.unshift(r),t.type===sre.SemanticAttr.Type.INFIXOP?(s=sre.SemanticProcessor.getInstance().postfixNode_(t.childNodes.pop(),s),t.appendChild(s),t):sre.SemanticProcessor.getInstance().postfixNode_(t,s)):0===(e=sre.SemanticProcessor.sliceNodes_(e,sre.SemanticPred.isOperator)).head.length?(s.push(e.div),sre.SemanticProcessor.getInstance().operationsTree_(e.tail,t,r,s)):(s=sre.SemanticProcessor.getInstance().prefixNode_(sre.SemanticProcessor.getInstance().implicitNode_(e.head),s),t=sre.SemanticProcessor.getInstance().appendOperand_(t,r,s),e.div?sre.SemanticProcessor.getInstance().operationsTree_(e.tail,t,e.div,[]):t)},sre.SemanticProcessor.prototype.appendOperand_=function(e,t,r){return e.type!==sre.SemanticAttr.Type.INFIXOP?sre.SemanticProcessor.getInstance().infixNode_([e,r],t):sre.SemanticProcessor.getInstance().appendExistingOperator_(e,t,r)?e:t.role===sre.SemanticAttr.Role.MULTIPLICATION?sre.SemanticProcessor.getInstance().appendMultiplicativeOp_(e,t,r):sre.SemanticProcessor.getInstance().appendAdditiveOp_(e,t,r)},sre.SemanticProcessor.prototype.appendMultiplicativeOp_=function(e,t,r){if(e.role===sre.SemanticAttr.Role.IMPLICIT)return sre.SemanticProcessor.getInstance().infixNode_([e,r],t);for(var s=e,n=e.childNodes[e.childNodes.length-1];n&&n.type===sre.SemanticAttr.Type.INFIXOP;)n=(s=n).childNodes[e.childNodes.length-1];return t=sre.SemanticProcessor.getInstance().infixNode_([s.childNodes.pop(),r],t),s.appendChild(t),e},sre.SemanticProcessor.prototype.appendAdditiveOp_=function(e,t,r){return sre.SemanticProcessor.getInstance().infixNode_([e,r],t)},sre.SemanticProcessor.prototype.appendExistingOperator_=function(e,t,r){return!(!e||e.type!==sre.SemanticAttr.Type.INFIXOP||e.role===sre.SemanticAttr.Role.IMPLICIT)&&(e.contentNodes[0].equals(t)?(e.appendContentNode(t),e.appendChild(r),!0):sre.SemanticProcessor.getInstance().appendExistingOperator_(e.childNodes[e.childNodes.length-1],t,r))},sre.SemanticProcessor.prototype.getFencesInRow_=function(e){e=sre.SemanticProcessor.partitionNodes_(e,sre.SemanticPred.isFence);var t=(e=sre.SemanticProcessor.purgeFences_(e)).comp.shift();return sre.SemanticProcessor.getInstance().fences_(e.rel,e.comp,[],[t])},sre.SemanticProcessor.prototype.fences_=function(e,t,r,s){if(0===e.length&&0===r.length)return s[0];var n,i,a=sre.SemanticPred.isAttribute("role","OPEN");if(0!==e.length)return n=r[r.length-1],(i=e[0].role)!==sre.SemanticAttr.Role.OPEN&&(i!==sre.SemanticAttr.Role.NEUTRAL||n&&e[0].textContent===n.textContent)?n&&(i===sre.SemanticAttr.Role.CLOSE&&n.role===sre.SemanticAttr.Role.OPEN||i===sre.SemanticAttr.Role.NEUTRAL&&e[0].textContent===n.textContent)?(a=sre.SemanticProcessor.getInstance().horizontalFencedNode_(r.pop(),e.shift(),s.pop()),s.push(s.pop().concat([a],t.shift())),sre.SemanticProcessor.getInstance().fences_(e,t,r,s)):n&&i===sre.SemanticAttr.Role.CLOSE&&n.role===sre.SemanticAttr.Role.NEUTRAL&&r.some(a)?(r=sre.SemanticProcessor.sliceNodes_(r,a,!0),a=s.pop(),n=s.length-r.tail.length+1,i=sre.SemanticProcessor.getInstance().neutralFences_(r.tail,s.slice(n)),s=s.slice(0,n),a=sre.SemanticProcessor.getInstance().horizontalFencedNode_(r.div,e.shift(),s.pop().concat(i,a)),s.push(s.pop().concat([a],t.shift())),sre.SemanticProcessor.getInstance().fences_(e,t,r.head,s)):(a=e.shift(),sre.SemanticProcessor.fenceToPunct_(a),s.push(s.pop().concat([a],t.shift())),sre.SemanticProcessor.getInstance().fences_(e,t,r,s)):(r.push(e.shift()),(a=t.shift())&&s.push(a),sre.SemanticProcessor.getInstance().fences_(e,t,r,s));for(e=s.shift();0<r.length;)a(r[0])?(t=r.shift(),sre.SemanticProcessor.fenceToPunct_(t),e.push(t)):(n=(r=sre.SemanticProcessor.sliceNodes_(r,a)).head.length-1,i=sre.SemanticProcessor.getInstance().neutralFences_(r.head,s.slice(0,n)),s=s.slice(n),e.push.apply(e,i),r.div&&r.tail.unshift(r.div),r=r.tail),e.push.apply(e,s.shift());return e},sre.SemanticProcessor.prototype.neutralFences_=function(e,t){if(0===e.length)return e;if(1===e.length)return sre.SemanticProcessor.fenceToPunct_(e[0]),e;var r=e.shift(),s=sre.SemanticProcessor.sliceNodes_(e,function(e){return sre.SemanticProcessor.getEmbellishedInner_(e).textContent==sre.SemanticProcessor.getEmbellishedInner_(r).textContent});return s.div?(t=sre.SemanticProcessor.getInstance().combineFencedContent_(r,s.div,s.head,t),0<s.tail.length?(e=t.shift(),s=sre.SemanticProcessor.getInstance().neutralFences_(s.tail,t),e.concat(s)):t[0]):(sre.SemanticProcessor.fenceToPunct_(r),(s=t.shift()).unshift(r),s.concat(sre.SemanticProcessor.getInstance().neutralFences_(e,t)))},sre.SemanticProcessor.prototype.combineFencedContent_=function(e,t,r,s){if(0===r.length)return e=sre.SemanticProcessor.getInstance().horizontalFencedNode_(e,t,s.shift()),0<s.length?s[0].unshift(e):s=[[e]],s;var n=s.shift(),i=r.length-1,a=s.slice(0,i),i=(s=s.slice(i)).shift();return r=sre.SemanticProcessor.getInstance().neutralFences_(r,a),n.push.apply(n,r),n.push.apply(n,i),e=sre.SemanticProcessor.getInstance().horizontalFencedNode_(e,t,n),0<s.length?s[0].unshift(e):s=[[e]],s},sre.SemanticProcessor.FENCE_TO_PUNCT_={},sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.NEUTRAL]=sre.SemanticAttr.Role.VBAR,sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.OPEN]=sre.SemanticAttr.Role.OPENFENCE,sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.CLOSE]=sre.SemanticAttr.Role.CLOSEFENCE,sre.SemanticProcessor.fenceToPunct_=function(e){var t=sre.SemanticProcessor.FENCE_TO_PUNCT_[e.role];if(t){for(;e.embellished;)e.embellished=sre.SemanticAttr.Type.PUNCTUATION,e.role=t,e=e.childNodes[0];e.type=sre.SemanticAttr.Type.PUNCTUATION,e.role=t}},sre.SemanticProcessor.prototype.horizontalFencedNode_=function(e,t,r){return r=sre.SemanticProcessor.getInstance().row(r),(t=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.FENCED,[r],[e,t])).role=e.role===sre.SemanticAttr.Role.OPEN?sre.SemanticAttr.Role.LEFTRIGHT:e.role,sre.SemanticProcessor.rewriteFencedNode_(t)},sre.SemanticProcessor.prototype.getPunctuationInRow_=function(e){if(e.length<=1)return e;var t=sre.SemanticProcessor.partitionNodes_(e,function(e){return sre.SemanticPred.isPunctuation(e)&&!sre.SemanticPred.isAttribute("role","ELLIPSIS")(e)});if(0===t.rel.length)return e;e=[];var r=t.comp.shift();0<r.length&&e.push(sre.SemanticProcessor.getInstance().row(r));for(var s=0;0<t.comp.length;)e.push(t.rel[s++]),0<(r=t.comp.shift()).length&&e.push(sre.SemanticProcessor.getInstance().row(r));return[sre.SemanticProcessor.getInstance().punctuatedNode_(e,t.rel)]},sre.SemanticProcessor.prototype.punctuatedNode_=function(e,t){var r=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.PUNCTUATED,e,t);if(t.length===e.length){var s=t[0].role;if(s!==sre.SemanticAttr.Role.UNKNOWN&&t.every(function(e){return e.role===s}))return r.role=s,r}return sre.SemanticPred.singlePunctAtPosition(e,t,0)?r.role=sre.SemanticAttr.Role.STARTPUNCT:sre.SemanticPred.singlePunctAtPosition(e,t,e.length-1)?r.role=sre.SemanticAttr.Role.ENDPUNCT:t.every(sre.SemanticPred.isAttribute("role","DUMMY"))?r.role=sre.SemanticAttr.Role.TEXT:r.role=sre.SemanticAttr.Role.SEQUENCE,r},sre.SemanticProcessor.prototype.dummyNode_=function(e){var t=sre.SemanticProcessor.getInstance().factory_.makeMultipleContentNodes(e.length-1,sre.SemanticAttr.invisibleComma());return t.forEach(function(e){e.role=sre.SemanticAttr.Role.DUMMY}),sre.SemanticProcessor.getInstance().punctuatedNode_(e,t)},sre.SemanticProcessor.MML_TO_LIMIT_={MSUB:sre.SemanticAttr.Type.LIMLOWER,MUNDER:sre.SemanticAttr.Type.LIMLOWER,MSUP:sre.SemanticAttr.Type.LIMUPPER,MOVER:sre.SemanticAttr.Type.LIMUPPER,MSUBSUP:sre.SemanticAttr.Type.LIMBOTH,MUNDEROVER:sre.SemanticAttr.Type.LIMBOTH},sre.SemanticProcessor.prototype.limitNode=function(e,t){var r=t[0];if(sre.SemanticPred.isLimitBase(r))e=sre.SemanticProcessor.MML_TO_LIMIT_[e];else switch(e){case"MSUB":e=sre.SemanticAttr.Type.SUBSCRIPT;break;case"MSUP":e=sre.SemanticAttr.Type.SUPERSCRIPT;break;case"MSUBSUP":var s=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.SUBSCRIPT,[r,t[1]],[]);s.role=sre.SemanticAttr.Role.SUBSUP,t=[s,t[2]],e=sre.SemanticAttr.Type.SUPERSCRIPT;break;case"MOVER":e=sre.SemanticAttr.Type.OVERSCORE,sre.SemanticPred.isAccent(t[1])&&(t[1].role=sre.SemanticAttr.Role.OVERACCENT);break;case"MUNDER":e=sre.SemanticAttr.Type.UNDERSCORE,sre.SemanticPred.isAccent(t[1])&&(t[1].role=sre.SemanticAttr.Role.UNDERACCENT);break;default:s=sre.SemanticPred.isAccent(t[1]),e=sre.SemanticPred.isAccent(t[2]),s&&(t[1].role=sre.SemanticAttr.Role.UNDERACCENT),e&&(t[2].role=sre.SemanticAttr.Role.OVERACCENT),e=e&&!s?(t=[s=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.OVERSCORE,[r,t[2]],[]),t[1]],sre.SemanticAttr.Type.UNDERSCORE):(t=[s=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.UNDERSCORE,[r,t[1]],[]),t[2]],sre.SemanticAttr.Type.OVERSCORE),s.role=sre.SemanticAttr.Role.UNDEROVER}return t=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(e,t,[]),e=sre.SemanticPred.isEmbellished(r),s&&(s.embellished=e),t.embellished=e,t.role=r.role,t},sre.SemanticProcessor.prototype.getFunctionsInRow_=function(e,t){if(t=t||[],0===e.length)return t;var r=e.shift(),s=sre.SemanticProcessor.classifyFunction_(r,e);return s?(e=sre.SemanticProcessor.getInstance().getFunctionsInRow_(e,[]),e=sre.SemanticProcessor.getInstance().getFunctionArgs_(r,e,s),t.concat(e)):(t.push(r),sre.SemanticProcessor.getInstance().getFunctionsInRow_(e,t))},sre.SemanticProcessor.CLASSIFY_FUNCTION_={},sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.INTEGRAL]="integral",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.SUM]="bigop",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.PREFIXFUNC]="prefix",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.LIMFUNC]="prefix",sre.SemanticProcessor.classifyFunction_=function(e,t){return e.type===sre.SemanticAttr.Type.APPL||e.type===sre.SemanticAttr.Type.BIGOP||e.type===sre.SemanticAttr.Type.INTEGRAL?"":t[0]&&t[0].textContent===sre.SemanticAttr.functionApplication()?(t.shift(),t=sre.SemanticAttr.Role.SIMPLEFUNC,e.role!==sre.SemanticAttr.Role.PREFIXFUNC&&e.role!==sre.SemanticAttr.Role.LIMFUNC||(t=e.role),sre.SemanticProcessor.propagateFunctionRole_(e,t),"prefix"):(t=sre.SemanticProcessor.CLASSIFY_FUNCTION_[e.role])?t:sre.SemanticPred.isSimpleFunctionHead(e)?"simple":""},sre.SemanticProcessor.propagateFunctionRole_=function(e,t){e&&(sre.SemanticPred.isAttribute("role","SUBSUP")(e)||(e.role=t),sre.SemanticProcessor.propagateFunctionRole_(e.childNodes[0],t))},sre.SemanticProcessor.prototype.getFunctionArgs_=function(e,t,r){switch(r){case"integral":t=sre.SemanticProcessor.getInstance().getIntegralArgs_(t);var s=sre.SemanticProcessor.getInstance().row(t.integrand);return e=sre.SemanticProcessor.getInstance().integralNode_(e,s,t.intvar),t.rest.unshift(e),t.rest;case"prefix":if(t[0]&&t[0].type===sre.SemanticAttr.Type.FENCED)return e=sre.SemanticProcessor.getInstance().functionNode_(e,t.shift()),t.unshift(e),t;case"bigop":return(s=sre.SemanticProcessor.sliceNodes_(t,sre.SemanticPred.isPrefixFunctionBoundary)).head.length?(t=sre.SemanticProcessor.getInstance().row(s.head),e="prefix"===r?sre.SemanticProcessor.getInstance().functionNode_(e,t):sre.SemanticProcessor.getInstance().bigOpNode_(e,t),s.div&&s.tail.unshift(s.div),s.tail.unshift(e),s.tail):(t.unshift(e),t);default:return 0===t.length?[e]:((s=t[0]).type===sre.SemanticAttr.Type.FENCED&&s.role!==sre.SemanticAttr.Role.NEUTRAL&&sre.SemanticPred.isSimpleFunction(s)&&(sre.SemanticProcessor.propagateFunctionRole_(e,sre.SemanticAttr.Role.SIMPLEFUNC),e=sre.SemanticProcessor.getInstance().functionNode_(e,t.shift())),t.unshift(e),t)}},sre.SemanticProcessor.prototype.getIntegralArgs_=function(e,t){if(t=t||[],0===e.length)return{integrand:t,intvar:null,rest:e};var r,s=e[0];return sre.SemanticPred.isGeneralFunctionBoundary(s)?{integrand:t,intvar:null,rest:e}:sre.SemanticPred.isIntegralDxBoundarySingle(s)?{integrand:t,intvar:s,rest:e.slice(1)}:e[1]&&sre.SemanticPred.isIntegralDxBoundary(s,e[1])?(r=sre.SemanticProcessor.getInstance().factory_.makeContentNode(sre.SemanticAttr.invisibleComma()),(s=sre.SemanticProcessor.getInstance().punctuatedNode_([s,r,e[1]],[r])).role=sre.SemanticAttr.Role.INTEGRAL,{integrand:t,intvar:s,rest:e.slice(2)}):(t.push(e.shift()),sre.SemanticProcessor.getInstance().getIntegralArgs_(e,t))},sre.SemanticProcessor.prototype.functionNode_=function(e,t){var r=sre.SemanticProcessor.getInstance().factory_.makeContentNode(sre.SemanticAttr.functionApplication()),s=(r.type=sre.SemanticAttr.Type.PUNCTUATION,r.role=sre.SemanticAttr.Role.APPLICATION,sre.SemanticProcessor.getFunctionOp_(e,function(e){return sre.SemanticPred.isAttribute("type","FUNCTION")(e)||sre.SemanticPred.isAttribute("type","IDENTIFIER")(e)&&sre.SemanticPred.isAttribute("role","SIMPLEFUNC")(e)}));return sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.APPL,[e,t],s,[r])},sre.SemanticProcessor.prototype.bigOpNode_=function(e,t){var r=sre.SemanticProcessor.getFunctionOp_(e,sre.SemanticPred.isAttribute("type","LARGEOP"));return sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.BIGOP,[e,t],r,[])},sre.SemanticProcessor.prototype.integralNode_=function(e,t,r){t=t||sre.SemanticProcessor.getInstance().factory_.makeEmptyNode(),r=r||sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();var s=sre.SemanticProcessor.getFunctionOp_(e,sre.SemanticPred.isAttribute("type","LARGEOP"));return sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.INTEGRAL,[e,t,r],s,[])},sre.SemanticProcessor.prototype.functionalNode_=function(e,t,r,s){var n,i=t[0];return r&&(n=r.parent,s.push(r)),(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(e,t,s)).role=i.role,n&&(r.parent=n),e},sre.SemanticProcessor.getFunctionOp_=function(e,t){if(t(e))return e;for(var r,s=0;r=e.childNodes[s];s++)if(r=sre.SemanticProcessor.getFunctionOp_(r,t))return r;return null},sre.SemanticProcessor.prototype.tablesInRow=function(e){e=sre.SemanticProcessor.partitionNodes_(e,sre.SemanticPred.tableIsMatrixOrVector);for(var t,r=[],s=0;t=e.rel[s];s++)(r=r.concat(e.comp.shift())).push(sre.SemanticProcessor.tableToMatrixOrVector_(t));for(r=r.concat(e.comp.shift()),e=sre.SemanticProcessor.partitionNodes_(r,sre.SemanticPred.isTableOrMultiline),r=[],s=0;t=e.rel[s];s++){var n=e.comp.shift();sre.SemanticPred.tableIsCases(t,n)&&sre.SemanticProcessor.tableToCases_(t,n.pop()),(r=r.concat(n)).push(t)}return r.concat(e.comp.shift())},sre.SemanticProcessor.tableToMatrixOrVector_=function(e){var t,r=e.childNodes[0];for(sre.SemanticPred.isAttribute("type","MULTILINE")(r)?sre.SemanticProcessor.tableToVector_(e):sre.SemanticProcessor.tableToMatrix_(e),e.contentNodes.forEach(goog.bind(r.appendContentNode,r)),e=0;t=r.childNodes[e];e++)sre.SemanticProcessor.assignRoleToRow_(t,sre.SemanticProcessor.getComponentRoles_(r));return r.parent=null,r},sre.SemanticProcessor.tableToVector_=function(e){var t=e.childNodes[0];t.type=sre.SemanticAttr.Type.VECTOR,1===t.childNodes.length?sre.SemanticProcessor.tableToSquare_(e):sre.SemanticProcessor.binomialForm_(t)},sre.SemanticProcessor.binomialForm_=function(e){sre.SemanticPred.isBinomial(e)&&(e.role=sre.SemanticAttr.Role.BINOMIAL,e.childNodes[0].role=sre.SemanticAttr.Role.BINOMIAL,e.childNodes[1].role=sre.SemanticAttr.Role.BINOMIAL)},sre.SemanticProcessor.tableToMatrix_=function(e){var t=e.childNodes[0];t.type=sre.SemanticAttr.Type.MATRIX,t.childNodes&&0<t.childNodes.length&&t.childNodes[0].childNodes&&t.childNodes.length===t.childNodes[0].childNodes.length?sre.SemanticProcessor.tableToSquare_(e):t.childNodes&&1===t.childNodes.length&&(t.role=sre.SemanticAttr.Role.ROWVECTOR)},sre.SemanticProcessor.tableToSquare_=function(e){var t=e.childNodes[0];sre.SemanticPred.isAttribute("role","NEUTRAL")(e)?t.role=sre.SemanticAttr.Role.DETERMINANT:t.role=sre.SemanticAttr.Role.SQUAREMATRIX},sre.SemanticProcessor.getComponentRoles_=function(e){var t=e.role;return t&&t!==sre.SemanticAttr.Role.UNKNOWN?t:sre.SemanticAttr.Role[e.type.toUpperCase()]||sre.SemanticAttr.Role.UNKNOWN},sre.SemanticProcessor.tableToCases_=function(e,t){for(var r,s=0;r=e.childNodes[s];s++)sre.SemanticProcessor.assignRoleToRow_(r,sre.SemanticAttr.Role.CASES);return e.type=sre.SemanticAttr.Type.CASES,e.appendContentNode(t),sre.SemanticPred.tableIsMultiline(e)&&sre.SemanticProcessor.binomialForm_(e),e},sre.SemanticProcessor.tableToMultiline=function(e){if(sre.SemanticPred.tableIsMultiline(e)){e.type=sre.SemanticAttr.Type.MULTILINE;for(var t,r=0;t=e.childNodes[r];r++)sre.SemanticProcessor.rowToLine_(t,sre.SemanticAttr.Role.MULTILINE);sre.SemanticProcessor.binomialForm_(e),sre.SemanticProcessor.classifyMultiline(e)}else sre.SemanticProcessor.classifyTable(e)},sre.SemanticProcessor.rowToLine_=function(t,e){e=e||sre.SemanticAttr.Role.UNKNOWN,sre.SemanticPred.isAttribute("type","ROW")(t)&&(t.type=sre.SemanticAttr.Type.LINE,t.role=e,1===t.childNodes.length&&sre.SemanticPred.isAttribute("type","CELL")(t.childNodes[0])&&(t.childNodes=t.childNodes[0].childNodes,t.childNodes.forEach(function(e){e.parent=t})))},sre.SemanticProcessor.assignRoleToRow_=function(e,t){var r;sre.SemanticPred.isAttribute("type","LINE")(e)?e.role=t:sre.SemanticPred.isAttribute("type","ROW")(e)&&(e.role=t,r=sre.SemanticPred.isAttribute("type","CELL"),e.childNodes.forEach(function(e){r(e)&&(e.role=t)}))},sre.SemanticProcessor.sliceNodes_=function(e,t,r){r&&e.reverse();for(var s,n=[],i=0;s=e[i];i++){if(t(s))return r?{head:e.slice(i+1).reverse(),div:s,tail:n.reverse()}:{head:n,div:s,tail:e.slice(i+1)};n.push(s)}return r?{head:[],div:null,tail:n.reverse()}:{head:n,div:null,tail:[]}},sre.SemanticProcessor.partitionNodes_=function(e,t){var r=[],s=[];do{var n=sre.SemanticProcessor.sliceNodes_(e,t)}while(s.push(n.head),r.push(n.div),e=n.tail,n.div);return r.pop(),{rel:r,comp:s}},sre.SemanticProcessor.prototype.mfenced=function(e,t,r,s){var n,i;return r&&0<s.length&&(n=sre.MathUtil.nextSeparatorFunction(r),i=[s.shift()],s.forEach(goog.bind(function(e){i.push(sre.SemanticProcessor.getInstance().factory_.makeContentNode(n())),i.push(e)},this)),s=i),e&&t?sre.SemanticProcessor.getInstance().horizontalFencedNode_(sre.SemanticProcessor.getInstance().factory_.makeContentNode(e),sre.SemanticProcessor.getInstance().factory_.makeContentNode(t),s):(e&&s.unshift(sre.SemanticProcessor.getInstance().factory_.makeContentNode(e)),t&&s.push(sre.SemanticProcessor.getInstance().factory_.makeContentNode(t)),sre.SemanticProcessor.getInstance().row(s))},sre.SemanticProcessor.number=function(e){e.type!==sre.SemanticAttr.Type.UNKNOWN&&e.type!==sre.SemanticAttr.Type.IDENTIFIER||(e.type=sre.SemanticAttr.Type.NUMBER),sre.SemanticProcessor.numberRole_(e),sre.SemanticProcessor.exprFont_(e)},sre.SemanticProcessor.numberRole_=function(e){var t;e.role===sre.SemanticAttr.Role.UNKNOWN&&((t=sre.SemanticUtil.splitUnicode(e.textContent).map(sre.SemanticAttr.lookupMeaning)).every(function(e){return e.type===sre.SemanticAttr.Type.NUMBER&&e.role===sre.SemanticAttr.Role.INTEGER||e.type===sre.SemanticAttr.Type.PUNCTUATION&&e.role===sre.SemanticAttr.Role.COMMA})?e.role=sre.SemanticAttr.Role.INTEGER:t.every(function(e){return e.type===sre.SemanticAttr.Type.NUMBER&&e.role===sre.SemanticAttr.Role.INTEGER||e.type===sre.SemanticAttr.Type.PUNCTUATION})?e.role=sre.SemanticAttr.Role.FLOAT:e.role=sre.SemanticAttr.Role.OTHERNUMBER)},sre.SemanticProcessor.exprFont_=function(e){var t;e.font!==sre.SemanticAttr.Font.UNKNOWN||(t=sre.SemanticUtil.splitUnicode(e.textContent).map(sre.SemanticAttr.lookupMeaning).reduce(function(e,t){return e&&t.font&&t.font!==sre.SemanticAttr.Font.UNKNOWN&&t.font!==e?e===sre.SemanticAttr.Font.UNKNOWN?t.font:null:e},sre.SemanticAttr.Font.UNKNOWN))&&(e.font=t)},sre.SemanticProcessor.prototype.fractionLikeNode=function(e,t,r){return sre.SemanticUtil.isZeroLength(e)?(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.LINE,[t],[]),r=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.LINE,[r],[]),r=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.MULTILINE,[e,r],[]),sre.SemanticProcessor.binomialForm_(r),sre.SemanticProcessor.classifyMultiline(r),r):sre.SemanticProcessor.getInstance().fractionNode_(t,r)},sre.SemanticProcessor.prototype.fractionNode_=function(e,t){return(e=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.FRACTION,[e,t],[])).role=e.childNodes.every(function(e){return sre.SemanticPred.isAttribute("role","INTEGER")(e)})?sre.SemanticAttr.Role.VULGAR:e.childNodes.every(function(e){return sre.SemanticPred.isAttribute("role","UNIT")(e)})?sre.SemanticAttr.Role.UNIT:sre.SemanticAttr.Role.DIVISION,e},sre.SemanticProcessor.prototype.tensor=function(e,t,r,s,n){return(t=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.TENSOR,[e,sre.SemanticProcessor.getInstance().scriptNode_(t,sre.SemanticAttr.Role.LEFTSUB),sre.SemanticProcessor.getInstance().scriptNode_(r,sre.SemanticAttr.Role.LEFTSUPER),sre.SemanticProcessor.getInstance().scriptNode_(s,sre.SemanticAttr.Role.RIGHTSUB),sre.SemanticProcessor.getInstance().scriptNode_(n,sre.SemanticAttr.Role.RIGHTSUPER)],[])).role=e.role,t.embellished=sre.SemanticPred.isEmbellished(e),t},sre.SemanticProcessor.prototype.pseudoTensor=function(e,t,r){var s=t.filter(n=function(e){return!sre.SemanticPred.isAttribute("type","EMPTY")(e)}).length,n=r.filter(n).length;if(!s&&!n)return e;var i=s?n?"MSUBSUP":"MSUB":"MSUP";return e=[e],s&&e.push(sre.SemanticProcessor.getInstance().scriptNode_(t,sre.SemanticAttr.Role.RIGHTSUB,!0)),n&&e.push(sre.SemanticProcessor.getInstance().scriptNode_(r,sre.SemanticAttr.Role.RIGHTSUPER,!0)),sre.SemanticProcessor.getInstance().limitNode(i,e)},sre.SemanticProcessor.prototype.scriptNode_=function(e,t,r){switch(e.length){case 0:e=sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();break;case 1:if(e=e[0],r)return e;break;default:e=sre.SemanticProcessor.getInstance().dummyNode_(e)}return e.role=t,e},sre.SemanticProcessor.getEmbellishedInner_=function(e){return e&&e.embellished&&0<e.childNodes.length?sre.SemanticProcessor.getEmbellishedInner_(e.childNodes[0]):e},sre.SemanticProcessor.purgeFences_=function(e){var t=e.rel;e=e.comp;for(var r=[],s=[];0<t.length;){var n=t.shift(),i=e.shift();sre.SemanticPred.isElligibleEmbellishedFence(n)?(r.push(n),s.push(i)):(sre.SemanticProcessor.fenceToPunct_(n),i.push(n),i=i.concat(e.shift()),e.unshift(i))}return s.push(e.shift()),{rel:r,comp:s}},sre.SemanticProcessor.rewriteFencedNode_=function(e){var t=e.contentNodes[1],r=sre.SemanticProcessor.rewriteFence_(e,e.contentNodes[0]);return e.contentNodes[0]=r.fence,r=sre.SemanticProcessor.rewriteFence_(r.node,t),e.contentNodes[1]=r.fence,(e.contentNodes[0].parent=e).contentNodes[1].parent=e,r.node.parent=null,r.node},sre.SemanticProcessor.rewriteFence_=function(e,t){if(!t.embellished)return{node:e,fence:t};var r=t.childNodes[0],s=sre.SemanticProcessor.rewriteFence_(e,r);return sre.SemanticPred.isAttribute("type","SUPERSCRIPT")(t)||sre.SemanticPred.isAttribute("type","SUBSCRIPT")(t)||sre.SemanticPred.isAttribute("type","TENSOR")(t)?(sre.SemanticPred.isAttribute("role","SUBSUP")(t)||(t.role=e.role),r!==s.node&&(t.replaceChild(r,s.node),r.parent=e),sre.SemanticProcessor.propagateFencePointer_(t,r),{node:t,fence:s.fence}):(t.replaceChild(r,s.fence),t.mathmlTree&&-1===t.mathml.indexOf(t.mathmlTree)&&t.mathml.push(t.mathmlTree),{node:s.node,fence:t})},sre.SemanticProcessor.propagateFencePointer_=function(e,t){e.fencePointer=t.fencePointer||t.id.toString(),e.embellished=null},sre.SemanticProcessor.classifyMultiline=function(e){for(var t,r,s=0,n=e.childNodes.length;s<n&&(!(t=e.childNodes[s])||!t.childNodes.length);)s++;n<=s||(r=t.childNodes[0].role)!==sre.SemanticAttr.Role.UNKNOWN&&e.childNodes.every(function(e){return!(e=e.childNodes[0])||e.role===r&&(sre.SemanticPred.isAttribute("type","RELATION")(e)||sre.SemanticPred.isAttribute("type","RELSEQ")(e))})&&(e.role=r)},sre.SemanticProcessor.classifyTable=function(e){var t=sre.SemanticProcessor.computeColumns_(e);sre.SemanticProcessor.classifyByColumns_(e,t,"EQUALITY")||sre.SemanticProcessor.classifyByColumns_(e,t,"INEQUALITY",["EQUALITY"])||sre.SemanticProcessor.classifyByColumns_(e,t,"ARROW")},sre.SemanticProcessor.classifyByColumns_=function(e,t,r,s){return!!(3===t.length&&sre.SemanticProcessor.testColumns_(t,1,function(e){return sre.SemanticProcessor.isPureRelation_(e,r)})||2===t.length&&(sre.SemanticProcessor.testColumns_(t,1,function(e){return sre.SemanticProcessor.isEndRelation_(e,r)||sre.SemanticProcessor.isPureRelation_(e,r)})||sre.SemanticProcessor.testColumns_(t,0,function(e){return sre.SemanticProcessor.isEndRelation_(e,r,!0)||sre.SemanticProcessor.isPureRelation_(e,r)})))&&(e.role=sre.SemanticAttr.Role[r],!0)},sre.SemanticProcessor.isEndRelation_=function(e,t,r){return r=r?e.childNodes.length-1:0,sre.SemanticPred.isAttribute("type","RELSEQ")(e)&&sre.SemanticPred.isAttribute("role",t)(e)&&sre.SemanticPred.isAttribute("type","EMPTY")(e.childNodes[r])},sre.SemanticProcessor.isPureRelation_=function(e,t){return sre.SemanticPred.isAttribute("type","RELATION")(e)&&sre.SemanticPred.isAttribute("role",t)(e)},sre.SemanticProcessor.computeColumns_=function(e){for(var t,r=[],s=0;t=e.childNodes[s];s++)for(var n,i=0;n=t.childNodes[i];i++)r[i]?r[i].push(n):r[i]=[n];return r},sre.SemanticProcessor.testColumns_=function(e,t,r){return!!(e=e[t])&&(e.some(function(e){return e.childNodes.length&&r(e.childNodes[0])})&&e.every(function(e){return!e.childNodes.length||r(e.childNodes[0])}))},sre.SemanticProcessor.MATHJAX_FONTS={"-tex-caligraphic":sre.SemanticAttr.Font.CALIGRAPHIC,"-tex-caligraphic-bold":sre.SemanticAttr.Font.CALIGRAPHICBOLD,"-tex-oldstyle":sre.SemanticAttr.Font.OLDSTYLE,"-tex-oldstyle-bold":sre.SemanticAttr.Font.OLDSTYLEBOLD,"-tex-mathit":sre.SemanticAttr.Font.ITALIC},sre.SemanticProcessor.prototype.font=function(e){var t=sre.SemanticProcessor.MATHJAX_FONTS[e];return t||e},sre.SemanticMathml=function(){sre.SemanticAbstractParser.call(this,"MathML"),this.parseMap_={SEMANTICS:goog.bind(this.semantics_,this),MATH:goog.bind(this.rows_,this),MROW:goog.bind(this.rows_,this),MPADDED:goog.bind(this.rows_,this),MSTYLE:goog.bind(this.rows_,this),MFRAC:goog.bind(this.fraction_,this),MSUB:goog.bind(this.limits_,this),MSUP:goog.bind(this.limits_,this),MSUBSUP:goog.bind(this.limits_,this),MOVER:goog.bind(this.limits_,this),MUNDER:goog.bind(this.limits_,this),MUNDEROVER:goog.bind(this.limits_,this),MROOT:goog.bind(this.root_,this),MSQRT:goog.bind(this.sqrt_,this),MTABLE:goog.bind(this.table_,this),MLABELEDTR:goog.bind(this.tableLabeledRow_,this),MTR:goog.bind(this.tableRow_,this),MTD:goog.bind(this.tableCell_,this),MS:goog.bind(this.text_,this),MTEXT:goog.bind(this.text_,this),"ANNOTATION-XML":goog.bind(this.text_,this),MI:goog.bind(this.identifier_,this),MN:goog.bind(this.number_,this),MO:goog.bind(this.operator_,this),MFENCED:goog.bind(this.fenced_,this),MENCLOSE:goog.bind(this.enclosed_,this),MMULTISCRIPTS:goog.bind(this.multiscripts_,this),ANNOTATION:goog.bind(this.empty_,this),NONE:goog.bind(this.empty_,this),MACTION:goog.bind(this.action_,this)}},goog.inherits(sre.SemanticMathml,sre.SemanticAbstractParser),sre.SemanticMathml.prototype.parse=function(e){sre.SemanticProcessor.getInstance().setNodeFactory(this.getFactory());var t=sre.DomUtil.toArray(e.childNodes),r=sre.DomUtil.tagName(e),s=this.parseMap_[r],t=(s||goog.bind(this.dummy_,this))(e,t);return-1!==["MATH","MROW","MPADDED","MSTYLE","SEMANTICS"].indexOf(r)||(t.mathml.unshift(e),t.mathmlTree=e),t},sre.SemanticMathml.prototype.parseNodes_=function(e){for(var t,r=[],s=0;t=e[s];s++)r.push(this.parse(t));return r},sre.SemanticMathml.prototype.semantics_=function(e,t){return t.length?this.parse(t[0]):this.getFactory().makeEmptyNode()},sre.SemanticMathml.prototype.rows_=function(e,t){return(t=1===(t=sre.SemanticUtil.purgeNodes(t)).length?this.parse(t[0]):sre.SemanticProcessor.getInstance().row(this.parseNodes_(t))).mathml.unshift(e),t},sre.SemanticMathml.prototype.fraction_=function(e,t){return sre.SemanticProcessor.getInstance().fractionLikeNode(e.getAttribute("linethickness"),this.parse(t[0]),this.parse(t[1]))},sre.SemanticMathml.prototype.limits_=function(e,t){return sre.SemanticProcessor.getInstance().limitNode(sre.DomUtil.tagName(e),this.parseNodes_(t))},sre.SemanticMathml.prototype.root_=function(e,t){return this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROOT,[this.parse(t[1]),this.parse(t[0])],[])},sre.SemanticMathml.prototype.sqrt_=function(e,t){return e=this.parseNodes_(sre.SemanticUtil.purgeNodes(t)),this.getFactory().makeBranchNode(sre.SemanticAttr.Type.SQRT,[sre.SemanticProcessor.getInstance().row(e)],[])},sre.SemanticMathml.prototype.table_=function(e,t){return e=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.TABLE,this.parseNodes_(t),[]),sre.SemanticProcessor.tableToMultiline(e),e},sre.SemanticMathml.prototype.tableRow_=function(e,t){return(e=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROW,this.parseNodes_(t),[])).role=sre.SemanticAttr.Role.TABLE,e},sre.SemanticMathml.prototype.tableLabeledRow_=function(e,t){return t.length?((e=this.parse(t[0])).role=sre.SemanticAttr.Role.LABEL,(t=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROW,this.parseNodes_(t.slice(1)),[e])).role=sre.SemanticAttr.Role.TABLE,t):this.tableRow_(e,t)},sre.SemanticMathml.prototype.tableCell_=function(e,t){return e=(e=this.parseNodes_(sre.SemanticUtil.purgeNodes(t))).length?1===e.length&&sre.SemanticPred.isAttribute("type","EMPTY")(e[0])?e:[sre.SemanticProcessor.getInstance().row(e)]:[],(e=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.CELL,e,[])).role=sre.SemanticAttr.Role.TABLE,e},sre.SemanticMathml.prototype.text_=function(e,t){return sre.SemanticProcessor.getInstance().text(e.textContent,sre.SemanticProcessor.getInstance().font(e.getAttribute("mathvariant")),sre.DomUtil.tagName(e))},sre.SemanticMathml.prototype.identifier_=function(e,t){return sre.SemanticProcessor.getInstance().identifierNode(e.textContent,sre.SemanticProcessor.getInstance().font(e.getAttribute("mathvariant")),e.getAttribute("class"))},sre.SemanticMathml.prototype.number_=function(e,t){return e=this.leaf_(e),sre.SemanticProcessor.number(e),e},sre.SemanticMathml.prototype.operator_=function(e,t){return(e=this.leaf_(e)).type===sre.SemanticAttr.Type.UNKNOWN&&(e.type=sre.SemanticAttr.Type.OPERATOR),e},sre.SemanticMathml.prototype.fenced_=function(e,t){t=this.parseNodes_(sre.SemanticUtil.purgeNodes(t));var r=sre.SemanticMathml.getAttribute_(e,"separators",","),s=sre.SemanticMathml.getAttribute_(e,"open","(");return e=sre.SemanticMathml.getAttribute_(e,"close",")"),e=sre.SemanticProcessor.getInstance().mfenced(s,e,r,t),sre.SemanticProcessor.getInstance().tablesInRow([e])[0]},sre.SemanticMathml.prototype.enclosed_=function(e,t){return t=this.parseNodes_(sre.SemanticUtil.purgeNodes(t)),(t=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ENCLOSE,[sre.SemanticProcessor.getInstance().row(t)],[])).role=e.getAttribute("notation")||sre.SemanticAttr.Role.UNKNOWN,t},sre.SemanticMathml.prototype.multiscripts_=function(e,t){if(!t.length)return this.getFactory().makeEmptyNode();if(e=this.parse(t.shift()),!t.length)return e;for(var r,s=[],n=[],i=[],a=[],o=!1,l=0,c=0;r=t[c];c++)"MPRESCRIPTS"===sre.DomUtil.tagName(r)?(o=!0,l=0):((o?1&l?s:n:1&l?i:a).push(r),l++);return sre.SemanticUtil.purgeNodes(s).length||sre.SemanticUtil.purgeNodes(n).length?sre.SemanticProcessor.getInstance().tensor(e,this.parseNodes_(n),this.parseNodes_(s),this.parseNodes_(a),this.parseNodes_(i)):sre.SemanticProcessor.getInstance().pseudoTensor(e,this.parseNodes_(a),this.parseNodes_(i))},sre.SemanticMathml.prototype.empty_=function(e,t){return this.getFactory().makeEmptyNode()},sre.SemanticMathml.prototype.action_=function(e,t){return 1<t.length?this.parse(t[1]):this.getFactory().makeUnprocessed(e)},sre.SemanticMathml.prototype.dummy_=function(e,t){return this.getFactory().makeUnprocessed(e)},sre.SemanticMathml.prototype.leaf_=function(e){return this.getFactory().makeLeafNode(e.textContent,sre.SemanticProcessor.getInstance().font(e.getAttribute("mathvariant")))},sre.SemanticMathml.getAttribute_=function(e,t,r){return e.hasAttribute(t)?(e=e.getAttribute(t)).match(/^\s*$/)?null:e:r},sre.SemanticTree=function(e){this.mathml=e,this.parser=new sre.SemanticMathml,this.root=this.parser.parse(e)},sre.SemanticTree.empty=function(){var e=sre.DomUtil.parseInput("<math/>"),t=new sre.SemanticTree(e);return t.mathml=e,t},sre.SemanticTree.fromNode=function(e,t){var r=sre.SemanticTree.empty();return r.root=e,t&&(r.mathml=t),r},sre.SemanticTree.fromRoot=function(e,t){for(;e.parent;)e=e.parent;return e=sre.SemanticTree.fromNode(e),t&&(e.mathml=t),e},sre.SemanticTree.prototype.xml=function(e){var t=sre.DomUtil.parseInput("<stree></stree>");return e=this.root.xml(t.ownerDocument,e),t.appendChild(e),t},sre.SemanticTree.prototype.toString=function(e){return(new sre.SystemExternal.xmldom.XMLSerializer).serializeToString(this.xml(e))},sre.SemanticTree.prototype.formatXml=function(e){return e=this.toString(e),sre.DomUtil.formatXml(e)},sre.SemanticTree.prototype.displayTree=function(){this.root.displayTree(0)},sre.SemanticTree.prototype.replaceNode=function(e,t){var r=e.parent;r?r.replaceChild(e,t):this.root=t},sre.Semantic={},sre.Semantic.Font=sre.SemanticAttr.Font,sre.Semantic.Role=sre.SemanticAttr.Role,sre.Semantic.Type=sre.SemanticAttr.Type,sre.Semantic.xmlTree=function(e){return sre.Semantic.getTree(e).xml()},sre.Semantic.getTree=function(e){return new sre.SemanticTree(e)},sre.Semantic.getTreeFromString=function(e){return e=sre.DomUtil.parseInput(e),sre.Semantic.getTree(e)},sre.SemanticSkeleton=function(e){this.array=e=0===e?e:e||[],this.levelsMap=this.parents=null},sre.SemanticSkeleton.prototype.populate=function(){this.parents&&this.levelsMap||(this.parents={},this.levelsMap={},this.populate_(this.array,this.array,[]))},sre.SemanticSkeleton.prototype.populate_=function(e,t,r){if(sre.SemanticSkeleton.simpleCollapseStructure(e))this.levelsMap[e]=t,this.parents[e]=e===r[0]?r.slice(1):r;else{r=[(t=sre.SemanticSkeleton.contentCollapseStructure(e)?e.slice(1):e)[0]].concat(r);for(var s=0,n=t.length;s<n;s++)this.populate_(t[s],e,r)}},sre.SemanticSkeleton.prototype.toString=function(){return sre.SemanticSkeleton.makeSexp_(this.array)},sre.SemanticSkeleton.makeSexp_=function(e){return sre.SemanticSkeleton.simpleCollapseStructure(e)?e.toString():sre.SemanticSkeleton.contentCollapseStructure(e)?"(c "+e.slice(1).map(sre.SemanticSkeleton.makeSexp_).join(" ")+")":"("+e.map(sre.SemanticSkeleton.makeSexp_).join(" ")+")"},sre.SemanticSkeleton.fromTree=function(e){return sre.SemanticSkeleton.fromNode(e.root)},sre.SemanticSkeleton.fromNode=function(e){return new sre.SemanticSkeleton(sre.SemanticSkeleton.fromNode_(e))},sre.SemanticSkeleton.fromString=function(e){return new sre.SemanticSkeleton(sre.SemanticSkeleton.fromString_(e))},sre.SemanticSkeleton.fromString_=function(e){return e=(e=(e=(e=e.replace(/\(/g,"[")).replace(/\)/g,"]")).replace(/ /g,",")).replace(/c/g,'"c"'),JSON.parse(e)},sre.SemanticSkeleton.fromNode_=function(e){if(!e)return[];var t,r=e.contentNodes,s=(r.length&&(t=r.map(sre.SemanticSkeleton.fromNode_)).unshift("c"),e.childNodes);return s.length?(s=s.map(sre.SemanticSkeleton.fromNode_),r.length&&s.unshift(t),s.unshift(e.id),s):r.length?[e.id,t]:e.id},sre.SemanticSkeleton.simpleCollapseStructure=function(e){return"number"==typeof e},sre.SemanticSkeleton.contentCollapseStructure=function(e){return!!e&&!sre.SemanticSkeleton.simpleCollapseStructure(e)&&"c"===e[0]},sre.SemanticSkeleton.interleaveIds=function(e,t){return sre.BaseUtil.interleaveLists(sre.SemanticSkeleton.collapsedLeafs(e),sre.SemanticSkeleton.collapsedLeafs(t))},sre.SemanticSkeleton.collapsedLeafs=function(e){return Array.prototype.slice.call(arguments,0).reduce(function(e,t){return e.concat((e=t,sre.SemanticSkeleton.simpleCollapseStructure(e)?[e]:sre.SemanticSkeleton.contentCollapseStructure(e[1])?e.slice(2):e.slice(1)))},[])},sre.SemanticSkeleton.fromStructure=function(e){return new sre.SemanticSkeleton(sre.SemanticSkeleton.tree_(e.root))},sre.SemanticSkeleton.tree_=function(e){if(!e)return[];if(!e.childNodes.length)return e.id;var t=[e.id];e=sre.SemanticSkeleton.combineContentChildren(e,e.contentNodes.map(function(e){return e}),e.childNodes.map(function(e){return e}));for(var r,s=0;r=e[s];s++)t.push(sre.SemanticSkeleton.tree_(r));return t},sre.SemanticSkeleton.combineContentChildren=function(e,t,r){switch(e.type){case sre.Semantic.Type.RELSEQ:case sre.Semantic.Type.INFIXOP:case sre.Semantic.Type.MULTIREL:return sre.BaseUtil.interleaveLists(r,t);case sre.Semantic.Type.PREFIXOP:return t.concat(r);case sre.Semantic.Type.POSTFIXOP:return r.concat(t);case sre.Semantic.Type.FENCED:return r.unshift(t[0]),r.push(t[1]),r;case sre.Semantic.Type.APPL:return[r[0],t[0],r[1]];case sre.Semantic.Type.ROOT:return[r[1],r[0]];case sre.Semantic.Type.ROW:case sre.Semantic.Type.LINE:return t.length&&r.unshift(t[0]),r;default:return r}},sre.EnrichMathml={},sre.EnrichMathml.Error=function(e){Error.call(this),this.message=e||"",this.name="MathML Enrichment Error"},goog.inherits(sre.EnrichMathml.Error,Error),sre.EnrichMathml.SETTINGS={collapsed:!0,implicit:!0},sre.EnrichMathml.ATTRIBUTE_PREFIX_="data-semantic-",sre.EnrichMathml.Attribute={ADDED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"added",ALTERNATIVE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"alternative",CHILDREN:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"children",COLLAPSED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"collapsed",CONTENT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"content",EMBELLISHED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"embellished",FENCEPOINTER:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"fencepointer",FONT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"font",ID:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"id",OPERATOR:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"operator",PARENT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"parent",PREFIX:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"prefix",ROLE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"role",SPEECH:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"speech",STRUCTURE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"structure",TYPE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"type"},sre.EnrichMathml.enrich=function(e,t){var r=e.cloneNode(!0);return sre.EnrichMathml.walkTree(t.root),sre.Engine.getInstance().structure&&e.setAttribute(sre.EnrichMathml.Attribute.STRUCTURE,sre.SemanticSkeleton.fromStructure(t).toString()),sre.Debugger.getInstance().generateOutput(function(){return sre.EnrichMathml.formattedOutput(r,e,t,!0),[]}),e},sre.EnrichMathml.walkTree=function(e){var t=sre.EnrichCaseFactory.getCase(e);if(t)return t=t.getMathml(),sre.EnrichMathml.ascendNewNode(t);if(1===e.mathml.length)return sre.Debugger.getInstance().output("Walktree Case 0"),t=e.mathml[0],sre.EnrichMathml.setAttributes(t,e),sre.EnrichMathml.ascendNewNode(t);t=e.contentNodes.map(sre.EnrichMathml.cloneContentNode),sre.EnrichMathml.setOperatorAttribute_(e,t);var r,s=e.childNodes.map(sre.EnrichMathml.walkTree),s=sre.SemanticSkeleton.combineContentChildren(e,t,s);return t=null===(t=e.mathmlTree)?(sre.Debugger.getInstance().output("Walktree Case 1"),sre.EnrichMathml.introduceNewLayer(s)):(r=sre.EnrichMathml.attachedElement_(s),sre.Debugger.getInstance().output("Walktree Case 2"),r?(sre.Debugger.getInstance().output("Walktree Case 2.1"),r.parentNode):(sre.Debugger.getInstance().output("Walktree Case 2.2"),sre.EnrichMathml.getInnerNode(t))),t=sre.EnrichMathml.rewriteMfenced(t),sre.EnrichMathml.mergeChildren_(t,s),sre.EnrichMathml.setAttributes(t,e),sre.EnrichMathml.ascendNewNode(t)},sre.EnrichMathml.introduceNewLayer=function(e){var t=sre.EnrichMathml.mathmlLca_(e),r=t.node,s=t.type;return s===sre.EnrichMathml.lcaType.VALID&&sre.SemanticUtil.hasEmptyTag(r)||(sre.Debugger.getInstance().output("Walktree Case 1.1"),r=sre.DomUtil.createElement("mrow"),s===sre.EnrichMathml.lcaType.PRUNED?(sre.Debugger.getInstance().output("Walktree Case 1.1.0"),r=sre.EnrichMathml.introduceLayerAboveLca(r,t.node,e)):e[0]&&(sre.Debugger.getInstance().output("Walktree Case 1.1.1"),t=sre.EnrichMathml.attachedElement_(e),e=sre.EnrichMathml.childrenSubset_(t.parentNode,e),sre.DomUtil.replaceNode(t,r),e.forEach(function(e){r.appendChild(e)}))),r},sre.EnrichMathml.introduceLayerAboveLca=function(t,e,r){var s,n=sre.EnrichMathml.descendNode_(e);return sre.SemanticUtil.hasMathTag(n)&&(sre.Debugger.getInstance().output("Walktree Case 1.1.0.0"),sre.EnrichMathml.moveSemanticAttributes_(n,t),sre.DomUtil.toArray(n.childNodes).forEach(function(e){t.appendChild(e)}),s=t,t=n,n=s),e=r.indexOf(e),r[e]=n,sre.DomUtil.replaceNode(n,t),t.appendChild(n),r.forEach(function(e){t.appendChild(e)}),t},sre.EnrichMathml.moveSemanticAttributes_=function(e,t){for(var r in sre.EnrichMathml.Attribute){r=sre.EnrichMathml.Attribute[r];e.hasAttribute(r)&&(t.setAttribute(r,e.getAttribute(r)),e.removeAttribute(r))}},sre.EnrichMathml.childrenSubset_=function(e,t){var r=sre.DomUtil.toArray(e.childNodes),s=1/0,n=-1/0;return t.forEach(function(e){-1!==(e=r.indexOf(e))&&(s=Math.min(s,e),n=Math.max(n,e))}),r.slice(s,n+1)},sre.EnrichMathml.mergeChildren_=function(t,e){var r=t.childNodes;if(r.length)for(var s=0;e.length;)r[s]===e[0]||sre.EnrichMathml.functionApplication_(r[s],e[0])?(e.shift(),s++):r[s]&&-1===e.indexOf(r[s])?s++:(sre.EnrichMathml.isDescendant_(e[0],t)||t.insertBefore(e[0],r[s]||null),e.shift());else e.forEach(function(e){t.appendChild(e)})},sre.EnrichMathml.isDescendant_=function(e,t){if(!e)return!1;do{if((e=e.parentNode)===t)return!0}while(e);return!1},sre.EnrichMathml.functionApplication_=function(e,t){var r=sre.SemanticAttr.functionApplication();return!!(e&&t&&e.textContent&&t.textContent&&e.textContent===r&&t.textContent===r&&"true"===t.getAttribute(sre.EnrichMathml.Attribute.ADDED))&&(sre.DomUtil.replaceNode(e,t),!0)},sre.EnrichMathml.lcaType={VALID:"valid",INVALID:"invalid",PRUNED:"pruned"},sre.EnrichMathml.mathmlLca_=function(e){if(!(r=sre.EnrichMathml.attachedElement_(e)))return{type:sre.EnrichMathml.lcaType.INVALID,node:null};var t=sre.EnrichMathml.attachedElement_(e.slice().reverse());if(r===t)return{type:sre.EnrichMathml.lcaType.VALID,node:r};var r=sre.EnrichMathml.pathToRoot_(r),s=sre.EnrichMathml.prunePath_(r,e),n=(t=(e=sre.EnrichMathml.pathToRoot_(t,function(e){return-1!==s.indexOf(e)}))[0],s.indexOf(t));return-1===n?{type:sre.EnrichMathml.lcaType.INVALID,node:null}:{type:s.length!==r.length?sre.EnrichMathml.lcaType.PRUNED:sre.EnrichMathml.validLca_(s[n+1],e[1])?sre.EnrichMathml.lcaType.VALID:sre.EnrichMathml.lcaType.INVALID,node:t}},sre.EnrichMathml.prunePath_=function(e,t){for(var r=0;e[r]&&-1===t.indexOf(e[r]);)r++;return e.slice(0,r+1)},sre.EnrichMathml.attachedElement_=function(e){for(var t=0,r=null;!r&&t<e.length;)e[t].parentNode&&(r=e[t]),t++;return r},sre.EnrichMathml.pathToRoot_=function(e,t){t=t||function(e){return!1};for(var r=[e];!t(e)&&!sre.SemanticUtil.hasMathTag(e)&&e.parentNode;)e=sre.EnrichMathml.parentNode_(e),r.unshift(e);return r},sre.EnrichMathml.validLca_=function(e,t){return!(!e||!t||e.previousSibling||t.nextSibling)},sre.EnrichMathml.ascendNewNode=function(e){for(;!sre.SemanticUtil.hasMathTag(e)&&sre.EnrichMathml.unitChild_(e);)e=sre.EnrichMathml.parentNode_(e);return e},sre.EnrichMathml.descendNode_=function(e){var t=sre.DomUtil.toArray(e.childNodes);return t&&1===(t=t.filter(function(e){return e.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&!sre.SemanticUtil.hasIgnoreTag(e)})).length&&sre.SemanticUtil.hasEmptyTag(t[0])&&!t[0].hasAttribute(sre.EnrichMathml.Attribute.TYPE)?sre.EnrichMathml.descendNode_(t[0]):e},sre.EnrichMathml.unitChild_=function(t){var e=sre.EnrichMathml.parentNode_(t);return!(!e||!sre.SemanticUtil.hasEmptyTag(e))&&sre.DomUtil.toArray(e.childNodes).every(function(e){return e===t||sre.EnrichMathml.isIgnorable_(e)})},sre.EnrichMathml.isIgnorable_=function(e){if(!e||sre.SemanticUtil.hasIgnoreTag(e))return!0;var t=sre.DomUtil.toArray(e.childNodes);return!(!sre.SemanticUtil.hasEmptyTag(e)&&t.length)&&sre.DomUtil.toArray(e.childNodes).every(sre.EnrichMathml.isIgnorable_)},sre.EnrichMathml.parentNode_=function(e){return e.parentNode},sre.EnrichMathml.addCollapsedAttribute=function(e,t){t=new sre.SemanticSkeleton(t),e.setAttribute(sre.EnrichMathml.Attribute.COLLAPSED,t.toString())},sre.EnrichMathml.cloneContentNode=function(e){if(e.mathml.length)return sre.EnrichMathml.walkTree(e);var t=sre.EnrichMathml.SETTINGS.implicit?sre.EnrichMathml.createInvisibleOperator_(e):sre.DomUtil.createElement("mrow");return e.mathml=[t],t},sre.EnrichMathml.makeIdList=function(e){return e.map(function(e){return e.id}).join(",")},sre.EnrichMathml.setAttributes=function(e,t){e.setAttribute(sre.EnrichMathml.Attribute.TYPE,t.type),e.setAttribute(sre.EnrichMathml.Attribute.ROLE,t.role),t.font!=sre.Semantic.Font.UNKNOWN&&e.setAttribute(sre.EnrichMathml.Attribute.FONT,t.font),e.setAttribute(sre.EnrichMathml.Attribute.ID,t.id),t.childNodes.length&&e.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,sre.EnrichMathml.makeIdList(t.childNodes)),t.contentNodes.length&&e.setAttribute(sre.EnrichMathml.Attribute.CONTENT,sre.EnrichMathml.makeIdList(t.contentNodes)),t.parent&&e.setAttribute(sre.EnrichMathml.Attribute.PARENT,t.parent.id),t.embellished&&e.setAttribute(sre.EnrichMathml.Attribute.EMBELLISHED,t.embellished),t.fencePointer&&e.setAttribute(sre.EnrichMathml.Attribute.FENCEPOINTER,t.fencePointer)},sre.EnrichMathml.combineContentChildren_=function(e,t,r){switch(e.type){case sre.Semantic.Type.RELSEQ:case sre.Semantic.Type.INFIXOP:case sre.Semantic.Type.MULTIREL:return sre.BaseUtil.interleaveLists(r,t);case sre.Semantic.Type.PREFIXOP:return t.concat(r);case sre.Semantic.Type.POSTFIXOP:return r.concat(t);case sre.Semantic.Type.FENCED:return r.unshift(t[0]),r.push(t[1]),r;case sre.Semantic.Type.APPL:return[r[0],t[0],r[1]];case sre.Semantic.Type.ROOT:return[r[1],r[0]];case sre.Semantic.Type.ROW:case sre.Semantic.Type.LINE:return t.length&&r.unshift(t[0]),r;default:return r}},sre.EnrichMathml.rewriteMfenced=function(e){if("MFENCED"!==sre.DomUtil.tagName(e))return e;for(var t,r=sre.DomUtil.createElement("mrow"),s=0;t=e.attributes[s];s++)-1===["open","close","separators"].indexOf(t.name)&&r.setAttribute(t.name,t.value);return sre.DomUtil.toArray(e.childNodes).forEach(function(e){r.appendChild(e)}),sre.DomUtil.replaceNode(e,r),r},sre.EnrichMathml.createInvisibleOperator_=function(e){var t=sre.DomUtil.createElement("mo"),r=sre.DomUtil.createTextNode(e.textContent);return t.appendChild(r),sre.EnrichMathml.setAttributes(t,e),t.setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),t},sre.EnrichMathml.setOperatorAttribute_=function(e,t){var r=e.type+(e.textContent?","+e.textContent:"");t.forEach(function(e){sre.EnrichMathml.getInnerNode(e).setAttribute(sre.EnrichMathml.Attribute.OPERATOR,r)})},sre.EnrichMathml.getInnerNode=function(e){if(!(s=sre.DomUtil.toArray(e.childNodes)))return e;for(var t,r,s=s.filter(function(e){return e.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&!sre.EnrichMathml.isIgnorable_(e)}),n=[],i=0;t=s[i];i++)sre.SemanticUtil.hasEmptyTag(t)?(r=sre.EnrichMathml.getInnerNode(t))&&r!==t&&n.push(r):n.push(t);return 1===n.length?n[0]:e},sre.EnrichMathml.formattedOutput=function(e,t,r,s){sre.EnrichMathml.formattedOutput_(e,"Original MathML",s=s||!1),sre.EnrichMathml.formattedOutput_(r,"Semantic Tree",s),sre.EnrichMathml.formattedOutput_(t,"Semantically enriched MathML",s)},sre.EnrichMathml.formattedOutput_=function(e,t,r){e=sre.DomUtil.formatXml(e.toString()),r?console.log(t+":\n```html\n"+sre.EnrichMathml.removeAttributePrefix(e)+"\n```\n"):console.log(e)},sre.EnrichMathml.removeAttributePrefix=function(e){return e.toString().replace(new RegExp(sre.EnrichMathml.ATTRIBUTE_PREFIX_,"g"),"")},sre.EnrichMathml.collapsePunctuated=function(e,t){var r=!!t,s=(t=t||[],e.parent);(i=e.contentNodes.map(function(e){return e.id})).unshift("c");for(var n,i=[e.id,i],a=0;n=e.childNodes[a];a++){var o=sre.EnrichMathml.walkTree(n);t.push(o),o=sre.EnrichMathml.getInnerNode(o),s&&!r&&o.setAttribute(sre.EnrichMathml.Attribute.PARENT,s.id),i.push(n.id)}return i},sre.EnrichMathml.printNodeList__=function(e,t){console.log(e),sre.DomUtil.toArray(t).forEach(function(e){console.log(e.toString())}),console.log("<<<<<<<<<<<<<<<<<")},sre.CaseBinomial=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree},goog.inherits(sre.CaseBinomial,sre.AbstractEnrichCase),sre.CaseBinomial.test=function(e){return!e.mathmlTree&&e.type===sre.SemanticAttr.Type.LINE&&e.role===sre.SemanticAttr.Role.BINOMIAL},sre.CaseBinomial.prototype.getMathml=function(){return this.semantic.childNodes.length&&(this.mml=sre.EnrichMathml.walkTree(this.semantic.childNodes[0]),this.mml.hasAttribute(sre.EnrichMathml.Attribute.TYPE)&&((e=sre.DomUtil.createElement("mrow")).setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),sre.DomUtil.replaceNode(this.mml,e),e.appendChild(this.mml),this.mml=e),sre.EnrichMathml.setAttributes(this.mml,this.semantic)),this.mml;var e},sre.CaseDoubleScript=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree},goog.inherits(sre.CaseDoubleScript,sre.AbstractEnrichCase),sre.CaseDoubleScript.test=function(e){if(!e.mathmlTree||!e.childNodes.length)return!1;var t=sre.DomUtil.tagName(e.mathmlTree);return e=e.childNodes[0].role,"MSUBSUP"===t&&e===sre.SemanticAttr.Role.SUBSUP||"MUNDEROVER"===t&&e===sre.SemanticAttr.Role.UNDEROVER},sre.CaseDoubleScript.prototype.getMathml=function(){var e=this.semantic.childNodes[0],t=e.childNodes[0],r=this.semantic.childNodes[1],s=e.childNodes[1],n=sre.EnrichMathml.walkTree(r),i=sre.EnrichMathml.walkTree(t),a=sre.EnrichMathml.walkTree(s);return sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,sre.EnrichMathml.makeIdList([t,s,r])),[i,a,n].forEach(goog.bind(function(e){sre.EnrichMathml.getInnerNode(e).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.mml.getAttribute(sre.EnrichMathml.Attribute.ID))},this)),this.mml.setAttribute(sre.EnrichMathml.Attribute.TYPE,e.role),sre.EnrichMathml.addCollapsedAttribute(this.mml,[this.semantic.id,[e.id,t.id,s.id],r.id]),this.mml},sre.CaseMultiindex=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree},goog.inherits(sre.CaseMultiindex,sre.AbstractEnrichCase),sre.CaseMultiindex.prototype.completeMultiscript=function(e,t){var i=sre.DomUtil.toArray(this.mml.childNodes).slice(1),a=0,r=goog.bind(function(e){for(var t,r=0;t=e[r];r++){var s,n=i[a];n&&t==sre.EnrichMathml.getInnerNode(n).getAttribute(sre.EnrichMathml.Attribute.ID)?(sre.EnrichMathml.getInnerNode(n).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.semantic.id),a++):(s=this.semantic.querySelectorAll(function(e){return e.id===t}),this.mml.insertBefore(sre.CaseMultiindex.createNone_(s[0]),n||null))}},this);r(e),i[a]&&"MPRESCRIPTS"!==sre.DomUtil.tagName(i[a])?this.mml.insertBefore(i[a],sre.DomUtil.createElement("mprescripts")):a++,r(t)},sre.CaseMultiindex.createNone_=function(e){var t=sre.DomUtil.createElement("none");return e&&sre.EnrichMathml.setAttributes(t,e),t.setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),t},sre.CaseMultiindex.multiscriptIndex=function(e){return e.type===sre.SemanticAttr.Type.PUNCTUATED&&e.contentNodes[0].role===sre.SemanticAttr.Role.DUMMY?sre.EnrichMathml.collapsePunctuated(e):(sre.EnrichMathml.walkTree(e),e.id)},sre.CaseMultiscripts=function(e){sre.CaseMultiindex.call(this,e)},goog.inherits(sre.CaseMultiscripts,sre.CaseMultiindex),sre.CaseMultiscripts.test=function(e){return!!e.mathmlTree&&("MMULTISCRIPTS"===sre.DomUtil.tagName(e.mathmlTree)&&(e.type===sre.SemanticAttr.Type.SUPERSCRIPT||e.type===sre.SemanticAttr.Type.SUBSCRIPT))},sre.CaseMultiscripts.prototype.getMathml=function(){var e,t,r,s,n;return sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.semantic.childNodes[0]&&this.semantic.childNodes[0].role===sre.SemanticAttr.Role.SUBSUP?(t=(e=this.semantic.childNodes[0]).childNodes[0],r=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),s=sre.CaseMultiindex.multiscriptIndex(e.childNodes[1]),n=[this.semantic.id,[e.id,t.id,s],r],sre.EnrichMathml.addCollapsedAttribute(this.mml,n),this.mml.setAttribute(sre.EnrichMathml.Attribute.TYPE,e.role),this.completeMultiscript(sre.SemanticSkeleton.interleaveIds(s,r),[])):(t=this.semantic.childNodes[0],r=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),n=[this.semantic.id,t.id,r],sre.EnrichMathml.addCollapsedAttribute(this.mml,n)),e=sre.SemanticSkeleton.collapsedLeafs(s||[],r),r=sre.EnrichMathml.walkTree(t),sre.EnrichMathml.getInnerNode(r).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.semantic.id),e.unshift(t.id),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,e.join(",")),this.mml},sre.CaseEmbellished=function(e){sre.AbstractEnrichCase.call(this,e),this.ofenceMml=this.ofence=this.fencedMml=this.fenced=null,this.ofenceMap={},this.cfenceMml=this.cfence=null,this.cfenceMap={},this.parentCleanup=[]},goog.inherits(sre.CaseEmbellished,sre.AbstractEnrichCase),sre.CaseEmbellished.test=function(e){return e.mathmlTree&&e.fencePointer},sre.CaseEmbellished.prototype.getMathml=function(){return this.getFenced_(),this.fencedMml=sre.EnrichMathml.walkTree(this.fenced),this.getFencesMml_(),this.rewrite_()},sre.CaseEmbellished.prototype.getFenced_=function(){for(var e=this.semantic;e.type!==sre.SemanticAttr.Type.FENCED;)e=e.childNodes[0];this.fenced=e.childNodes[0],this.ofence=e.contentNodes[0],this.cfence=e.contentNodes[1],sre.CaseEmbellished.fencedMap_(this.ofence,this.ofenceMap),sre.CaseEmbellished.fencedMap_(this.cfence,this.cfenceMap)},sre.CaseEmbellished.fencedMap_=function(e,t){t[e.id]=e.mathmlTree,e.embellished&&sre.CaseEmbellished.fencedMap_(e.childNodes[0],t)},sre.CaseEmbellished.prototype.getFencesMml_=function(){for(var e=this.semantic,t=Object.keys(this.ofenceMap),r=Object.keys(this.cfenceMap);!(this.ofenceMml&&this.cfenceMml||e===this.fenced);)-1===t.indexOf(e.fencePointer)||this.ofenceMml||(this.ofenceMml=e.mathmlTree),-1===r.indexOf(e.fencePointer)||this.cfenceMml||(this.cfenceMml=e.mathmlTree),e=e.childNodes[0];this.ofenceMml||(this.ofenceMml=this.ofence.mathmlTree),this.cfenceMml||(this.cfenceMml=this.cfence.mathmlTree),this.ofenceMml&&(this.ofenceMml=sre.EnrichMathml.ascendNewNode(this.ofenceMml)),this.cfenceMml&&(this.cfenceMml=sre.EnrichMathml.ascendNewNode(this.cfenceMml))},sre.CaseEmbellished.prototype.rewrite_=function(){var e=this.semantic,t=null,r=this.introduceNewLayer_();for(sre.EnrichMathml.setAttributes(r,this.fenced.parent);e.type!==sre.SemanticAttr.Type.FENCED;){var s=e.mathmlTree;if(i=this.specialCase_(e,s))e=i;else{sre.EnrichMathml.setAttributes(s,e);for(var n,i=[],a=1;n=e.childNodes[a];a++)i.push(sre.EnrichMathml.walkTree(n));e=e.childNodes[0]}i=sre.DomUtil.createElement("dummy"),a=r.parentNode,n=s.childNodes[0],sre.DomUtil.replaceNode(s,i),sre.DomUtil.replaceNode(r,s),sre.DomUtil.replaceNode(s.childNodes[0],r),sre.DomUtil.replaceNode(i,n),s.parentNode=a,r=s.childNodes[0],t=t||s}return sre.EnrichMathml.walkTree(this.ofence),sre.EnrichMathml.walkTree(this.cfence),this.cleanupParents_(),t||r},sre.CaseEmbellished.prototype.specialCase_=function(e,t){var r,s=sre.DomUtil.tagName(t),n=null;return"MSUBSUP"===s?(n=e.childNodes[0],r=sre.CaseDoubleScript):"MMULTISCRIPTS"===s&&(e.type===sre.SemanticAttr.Type.SUPERSCRIPT||e.type===sre.SemanticAttr.Type.SUBSCRIPT?r=sre.CaseMultiscripts:e.type===sre.SemanticAttr.Type.TENSOR&&(r=sre.CaseTensor),n=r&&e.childNodes[0]&&e.childNodes[0].role===sre.SemanticAttr.Role.SUBSUP?e.childNodes[0]:e),n?(s=n.childNodes[0],t=sre.CaseEmbellished.makeEmptyNode_(s.id),n.childNodes[0]=t,t=new r(e).getMathml(),n.childNodes[0]=s,this.parentCleanup.push(t),n.childNodes[0]):null},sre.CaseEmbellished.makeEmptyNode_=function(e){var t=sre.DomUtil.createElement("mrow");return(e=new sre.SemanticNode(e)).type=sre.SemanticAttr.Type.EMPTY,e.mathmlTree=t,e},sre.CaseEmbellished.prototype.introduceNewLayer_=function(){var e=this.fullFence(this.ofenceMml),t=this.fullFence(this.cfenceMml),r=sre.DomUtil.createElement("mrow");if(sre.DomUtil.replaceNode(this.fencedMml,r),r.appendChild(this.fencedMml),r.insertBefore(e,this.fencedMml),r.appendChild(t),!r.parentNode){for(e=sre.DomUtil.createElement("mrow");0<r.childNodes.length;)e.appendChild(r.childNodes[0]);r.appendChild(e),r=e}return r},sre.CaseEmbellished.prototype.fullFence=function(e){for(var t=this.fencedMml.parentNode;e.parentNode&&e.parentNode!==t;)e=e.parentNode;return e},sre.CaseEmbellished.prototype.cleanupParents_=function(){this.parentCleanup.forEach(function(e){var t=e.childNodes[1].getAttribute(sre.EnrichMathml.Attribute.PARENT);e.childNodes[0].setAttribute(sre.EnrichMathml.Attribute.PARENT,t)})},sre.CaseLine=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree},goog.inherits(sre.CaseLine,sre.AbstractEnrichCase),sre.CaseLine.test=function(e){return e.mathmlTree&&e.type===sre.SemanticAttr.Type.LINE},sre.CaseLine.prototype.getMathml=function(){return this.semantic.contentNodes.length&&sre.EnrichMathml.walkTree(this.semantic.contentNodes[0]),this.semantic.childNodes.length&&sre.EnrichMathml.walkTree(this.semantic.childNodes[0]),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml},sre.CaseTable=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree,this.inner=[]},goog.inherits(sre.CaseTable,sre.AbstractEnrichCase),sre.CaseTable.test=function(e){return e.mathmlTree&&(e.type===sre.SemanticAttr.Type.MATRIX||e.type===sre.SemanticAttr.Type.VECTOR||e.type===sre.SemanticAttr.Type.CASES)},sre.CaseTable.prototype.getMathml=function(){var e=sre.EnrichMathml.cloneContentNode(this.semantic.contentNodes[0]),t=this.semantic.contentNodes[1]?sre.EnrichMathml.cloneContentNode(this.semantic.contentNodes[1]):null;return this.inner=this.semantic.childNodes.map(sre.EnrichMathml.walkTree),"MFENCED"===sre.DomUtil.tagName(this.mml)?(this.mml.insertBefore(e,this.mml.childNodes[0]||null),t&&this.mml.appendChild(t),this.mml=sre.EnrichMathml.rewriteMfenced(this.mml)):(e=[e,this.mml],t&&e.push(t),this.mml=sre.EnrichMathml.introduceNewLayer(e)),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml},sre.CaseTensor=function(e){sre.CaseMultiindex.call(this,e)},goog.inherits(sre.CaseTensor,sre.CaseMultiindex),sre.CaseTensor.test=function(e){return e.mathmlTree&&e.type===sre.SemanticAttr.Type.TENSOR},sre.CaseTensor.prototype.getMathml=function(){sre.EnrichMathml.walkTree(this.semantic.childNodes[0]);var e=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),t=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[2]),r=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[3]),s=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[4]),n=(sre.EnrichMathml.setAttributes(this.mml,this.semantic),sre.EnrichMathml.addCollapsedAttribute(this.mml,[this.semantic.id,this.semantic.childNodes[0].id,e,t,r,s]),sre.SemanticSkeleton.collapsedLeafs(e,t,r,s));return n.unshift(this.semantic.childNodes[0].id),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,n.join(",")),this.completeMultiscript(sre.SemanticSkeleton.interleaveIds(r,s),sre.SemanticSkeleton.interleaveIds(e,t)),this.mml},sre.CaseText=function(e){sre.AbstractEnrichCase.call(this,e),this.mml=e.mathmlTree},goog.inherits(sre.CaseText,sre.AbstractEnrichCase),sre.CaseText.test=function(e){return e.type===sre.SemanticAttr.Type.PUNCTUATED&&e.role===sre.SemanticAttr.Role.TEXT},sre.CaseText.prototype.getMathml=function(){var e=[],t=sre.EnrichMathml.collapsePunctuated(this.semantic,e);return this.mml=sre.EnrichMathml.introduceNewLayer(e),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml.removeAttribute(sre.EnrichMathml.Attribute.CONTENT),sre.EnrichMathml.addCollapsedAttribute(this.mml,t),this.mml},sre.EnrichCases=function(){},sre.EnrichCaseFactory.cases.push({test:sre.CaseEmbellished.test,constr:sre.CaseEmbellished},{test:sre.CaseDoubleScript.test,constr:sre.CaseDoubleScript},{test:sre.CaseTensor.test,constr:sre.CaseTensor},{test:sre.CaseMultiscripts.test,constr:sre.CaseMultiscripts},{test:sre.CaseLine.test,constr:sre.CaseLine},{test:sre.CaseBinomial.test,constr:sre.CaseBinomial},{test:sre.CaseTable.test,constr:sre.CaseTable},{test:sre.CaseText.test,constr:sre.CaseText}),sre.Enrich={},sre.Enrich.semanticMathmlNode=function(e){e=e.cloneNode(!0);var t=sre.Semantic.getTree(e);return sre.EnrichMathml.enrich(e,t)},sre.Enrich.semanticMathmlSync=function(e){return e=sre.DomUtil.parseInput(e),sre.Enrich.semanticMathmlNode(e)},sre.Enrich.semanticMathml=function(e,t){var r;sre.Engine.isReady()?(r=sre.DomUtil.parseInput(e),t(sre.Enrich.semanticMathmlNode(r))):setTimeout(function(){sre.Enrich.semanticMathml(e,t)},500)},sre.Enrich.testTranslation__=function(e){return new sre.EnrichCases,sre.Debugger.getInstance().init(),e=sre.Enrich.semanticMathmlSync(sre.Enrich.prepareMmlString(e)).toString(),sre.EnrichMathml.removeAttributePrefix(e),sre.Debugger.getInstance().exit(),e},sre.Enrich.prepareMmlString=function(e){return(e=!e.match(/^<math/)?"<math>"+e:e).match(/\/math>$/)||(e+="</math>"),e},sre.ColorPicker=function(e,t){this.foreground=sre.ColorPicker.getChannelColor_(t,sre.ColorPicker.DEFAULT_FOREGROUND_),this.background=sre.ColorPicker.getChannelColor_(e,sre.ColorPicker.DEFAULT_BACKGROUND_)},sre.ColorPicker.DEFAULT_BACKGROUND_="blue",sre.ColorPicker.DEFAULT_FOREGROUND_="black",sre.ColorPicker.namedColors_={red:{red:255,green:0,blue:0},green:{red:0,green:255,blue:0},blue:{red:0,green:0,blue:255},yellow:{red:255,green:255,blue:0},cyan:{red:0,green:255,blue:255},magenta:{red:255,green:0,blue:255},white:{red:255,green:255,blue:255},black:{red:0,green:0,blue:0}},sre.ColorPicker.getChannelColor_=function(e,t){var r=(e=e||{color:t}).color?sre.ColorPicker.namedColors_[e.color]:e;return(r=r||sre.ColorPicker.namedColors_[t]).alpha=e.hasOwnProperty("alpha")?e.alpha:1,sre.ColorPicker.normalizeColor_(r)},sre.ColorPicker.normalizeColor_=function(e){function t(e){return e=Math.max(e,0),e=Math.min(255,e),Math.round(e)}return e.red=t(e.red),e.green=t(e.green),e.blue=t(e.blue),e.alpha=Math.max(e.alpha,0),e.alpha=Math.min(1,e.alpha),e},sre.ColorPicker.prototype.rgba=function(){function e(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"}return{background:e(this.background),foreground:e(this.foreground)}},sre.ColorPicker.prototype.rgb=function(){function e(e){return"rgb("+e.red+","+e.green+","+e.blue+")"}return{background:e(this.background),alphaback:this.background.alpha.toString(),foreground:e(this.foreground),alphafore:this.foreground.alpha.toString()}},sre.ColorPicker.prototype.hex=function(){function e(e){return"#"+sre.ColorPicker.toHex_(e.red)+sre.ColorPicker.toHex_(e.green)+sre.ColorPicker.toHex_(e.blue)}return{background:e(this.background),alphaback:this.background.alpha.toString(),foreground:e(this.foreground),alphafore:this.foreground.alpha.toString()}},sre.ColorPicker.toHex_=function(e){return 1===(e=e.toString(16)).length?"0"+e:e},sre.Highlighter=function(){},sre.Highlighter.prototype.highlight=function(e){},sre.Highlighter.prototype.unhighlight=function(){},sre.Highlighter.prototype.highlightAll=function(e){},sre.Highlighter.prototype.unhighlightAll=function(){},sre.Highlighter.prototype.setColor=function(e){},sre.Highlighter.prototype.addEvents=function(e,t){},sre.AbstractHighlighter=function(){this.currentHighlights_=[],this.color=null,this.mactionName="",this.state_={}},sre.AbstractHighlighter.prototype.highlight=function(e){this.currentHighlights_.push(e.map(goog.bind(function(e){return this.highlightNode(e)},this)))},sre.AbstractHighlighter.prototype.highlightNode=goog.abstractMethod,sre.AbstractHighlighter.prototype.highlightAll=function(e){e=this.getMactionNodes(e);for(var t,r=0;t=e[r];r++)this.highlight([t])},sre.AbstractHighlighter.prototype.unhighlight=function(){var e=this.currentHighlights_.pop();e&&e.forEach(goog.bind(function(e){return this.unhighlightNode(e)},this))},sre.AbstractHighlighter.prototype.unhighlightNode=goog.abstractMethod,sre.AbstractHighlighter.prototype.unhighlightAll=function(){for(;0<this.currentHighlights_.length;)this.unhighlight()},sre.AbstractHighlighter.prototype.setColor=function(e){this.color=e},sre.AbstractHighlighter.prototype.colorString=function(){return this.color.rgba()},sre.AbstractHighlighter.prototype.addEvents=function(e,t){e=this.getMactionNodes(e);for(var r,s=0;r=e[s];s++)for(var n in t)r.addEventListener(n,t[n])},sre.AbstractHighlighter.prototype.getMactionNodes=function(e){return e.getElementsByClassName(this.mactionName)},sre.AbstractHighlighter.prototype.isMactionNode=function(e){return!!(e=e.className||e.getAttribute("class"))&&e.match(new RegExp(this.mactionName))},sre.AbstractHighlighter.prototype.resetState=function(e){delete this.state_[e]},sre.AbstractHighlighter.prototype.setState=function(e,t){this.state_[e]=t},sre.AbstractHighlighter.prototype.getState=function(e){return this.state_[e]},sre.CssHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="mjx-maction"},goog.inherits(sre.CssHighlighter,sre.AbstractHighlighter),sre.CssHighlighter.prototype.highlightNode=function(e){var t={node:e,background:e.style.backgroundColor,foreground:e.style.color},r=this.colorString();return e.style.backgroundColor=r.background,e.style.color=r.foreground,t},sre.CssHighlighter.prototype.unhighlightNode=function(e){e.node.style.backgroundColor=e.background,e.node.style.color=e.foreground},sre.HtmlHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.HtmlHighlighter,sre.AbstractHighlighter),sre.HtmlHighlighter.prototype.setMode=function(e){this.mode=e},sre.HtmlHighlighter.prototype.highlightNode=function(e){var t,r,s={node:e,foreground:e.style.color,position:e.style.position},n=this.color.rgb(),i=(e.style.color=n.foreground,e.style.position="relative",e.bbox);return i&&i.w&&(t=document.createElement("span"),r=parseFloat(e.style.paddingLeft||"0"),t.style.backgroundColor=n.background,t.style.opacity=n.alphaback.toString(),t.style.display="inline-block",t.style.height=i.h+i.d+.1+"em",t.style.verticalAlign=-i.d+"em",t.style.marginTop=t.style.marginBottom="-0.05em",t.style.width=i.w+0+"em",t.style.marginLeft=+r+"em",t.style.marginRight=-i.w-r+"em",e.parentNode.insertBefore(t,e),s.box=t),s},sre.HtmlHighlighter.prototype.unhighlightNode=function(e){var t=e.node;t.style.color=e.foreground,t.style.position=e.position,e.box&&e.box.parentNode.removeChild(e.box)},sre.MmlCssHighlighter=function(){sre.CssHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.MmlCssHighlighter,sre.CssHighlighter),sre.MmlCssHighlighter.prototype.getMactionNodes=function(e){return e.getElementsByTagName(this.mactionName)},sre.MmlCssHighlighter.prototype.isMactionNode=function(e){return e.tagName===this.mactionName},sre.MmlHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.MmlHighlighter,sre.AbstractHighlighter),sre.MmlHighlighter.prototype.highlightNode=function(e){var t=e.getAttribute("style"),t=(t+=";background-color: "+this.colorString().background)+(";color: "+this.colorString().foreground);return e.setAttribute("style",t),{node:e}},sre.MmlHighlighter.prototype.unhighlightNode=function(e){var t=e.node.getAttribute("style");t=(t=t.replace(";background-color: "+this.colorString().background,"")).replace(";color: "+this.colorString().foreground,""),e.node.setAttribute("style",t)},sre.MmlHighlighter.prototype.colorString=function(){return this.color.rgba()},sre.MmlHighlighter.prototype.getMactionNodes=function(e){return e.getElementsByTagName(this.mactionName)},sre.MmlHighlighter.prototype.isMactionNode=function(e){return e.tagName===this.mactionName},sre.SvgHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="mjx-svg-maction"},goog.inherits(sre.SvgHighlighter,sre.AbstractHighlighter),sre.SvgHighlighter.prototype.highlightNode=function(e){var t,r,s;return"svg"===e.tagName?(t={node:e,background:e.style.backgroundColor,foreground:e.style.color},e.style.backgroundColor=this.colorString().background,e.style.color=this.colorString().foreground):(t=document.createElementNS("http://www.w3.org/2000/svg","rect"),"use"===e.nodeName?(r=document.createElementNS("http://www.w3.org/2000/svg","g"),e.parentNode.insertBefore(r,e),r.appendChild(e),s=r.getBBox(),r.parentNode.replaceChild(e,r)):s=e.getBBox(),t.setAttribute("x",s.x-40),t.setAttribute("y",s.y-40),t.setAttribute("width",s.width+80),t.setAttribute("height",s.height+80),(s=e.getAttribute("transform"))&&t.setAttribute("transform",s),t.setAttribute("fill",this.colorString().background),e.parentNode.insertBefore(t,e),t={node:t,foreground:e.getAttribute("fill")},e.setAttribute("fill",this.colorString().foreground)),t},sre.SvgHighlighter.prototype.unhighlightNode=function(e){"background"in e?(e.node.style.backgroundColor=e.background,e.node.style.color=e.foreground):(e.foreground?e.node.nextSibling.setAttribute("fill",e.foreground):e.node.nextSibling.removeAttribute("fill"),e.node.parentNode.removeChild(e.node))},sre.SvgHighlighter.prototype.isMactionNode=function(e){return!!(e=(e=e.className||e.getAttribute("class")).baseVal||e)&&e.match(new RegExp(this.mactionName))},sre.HighlighterFactory={},sre.HighlighterFactory.highlighter=function(e,t,r){return e=new sre.ColorPicker(e,t),(r=sre.HighlighterFactory.highlighterMapping_["NativeMML"===r.renderer&&"Safari"===r.browser?"MML-CSS":r.renderer])?(r.setColor(e),r):null},sre.HighlighterFactory.addEvents=function(e,t,r){(r=sre.HighlighterFactory.highlighterMapping_[r.renderer])&&r.addEvents(e,t)},sre.HighlighterFactory.highlighterMapping_={SVG:new sre.SvgHighlighter,NativeMML:new sre.MmlHighlighter,"HTML-CSS":new sre.HtmlHighlighter,"MML-CSS":new sre.MmlCssHighlighter,CommonHTML:new sre.CssHighlighter},sre.Grammar=function(){this.parameters_={},this.corrections_={},this.preprocessors_={},this.stateStack_=[]},goog.addSingletonGetter(sre.Grammar),sre.Grammar.ATTRIBUTE="grammar",sre.Grammar.prototype.clear=function(){this.parameters_={},this.stateStack_=[]},sre.Grammar.prototype.setParameter=function(e,t){var r=this.parameters_[e];return t?this.parameters_[e]=t:delete this.parameters_[e],r},sre.Grammar.prototype.getParameter=function(e){return this.parameters_[e]},sre.Grammar.prototype.setCorrection=function(e,t){this.corrections_[e]=t},sre.Grammar.prototype.setPreprocessor=function(e,t){this.preprocessors_[e]=t},sre.Grammar.prototype.getCorrection=function(e){return this.corrections_[e]},sre.Grammar.prototype.getState=function(){var e,t=[];for(e in this.parameters_){var r=this.parameters_[e];t.push("string"==typeof r?e+":"+r:e)}return t.join(" ")},sre.Grammar.prototype.pushState=function(e){for(var t in e)e[t]=this.setParameter(t,e[t]);this.stateStack_.push(e)},sre.Grammar.prototype.popState=function(){var e,t=this.stateStack_.pop();for(e in t)this.setParameter(e,t[e])},sre.Grammar.prototype.setAttribute=function(e){var t;!e||e.nodeType!==sre.DomUtil.NodeType.ELEMENT_NODE||(t=this.getState())&&e.setAttribute(sre.Grammar.ATTRIBUTE,t)},sre.Grammar.prototype.preprocess=function(e){return this.runProcessors_(e,this.preprocessors_)},sre.Grammar.prototype.correct=function(e){return this.runProcessors_(e,this.corrections_)},sre.Grammar.prototype.runProcessors_=function(e,t){for(var r in this.parameters_){var s=t[r];s&&(e=!0===(r=this.parameters_[r])?s(e):s(e,r))}return e},sre.Grammar.translateString_=function(e){var t=sre.Engine.getInstance();return t.evaluator(e,t.dynamicCstr)||e},sre.Grammar.prototype.apply=function(e,t){return e=(t=t||{}).adjust||t.preprocess?sre.Grammar.getInstance().preprocess(e):e,(this.parameters_.translate||t.translate)&&(e=sre.Grammar.translateString_(e)),t.adjust||t.correct?sre.Grammar.getInstance().correct(e):e},sre.Grammar.parseState=function(e){for(var t={},r=0,s=(e=e.split(" ")).length;r<s;r++){var n=e[r].split(":"),i=n[1];t[n[0]]=i||!0}return t},sre.Grammar.parseInput=function(e){for(var t={},r=0,s=(e=e.split(":")).length;r<s;r++){var n=e[r].split("="),i=n[0].trim();n[1]?t[i]=n[1].trim():i.match(/^!/)?t[i.slice(1)]=!1:t[i]=!0}return t},sre.Grammar.correctFont_=function(e,t){return t&&e?(t=(t=sre.L10n.getLocale().FONT[t]||t).split(/ |-/),t=new RegExp("^"+t.join("( |-)")+"( |-)"),e.replace(t,"")):e},sre.Grammar.addAnnotation_=function(e,t){return e+":"+t},sre.Grammar.getInstance().setCorrection("ignoreFont",sre.Grammar.correctFont_),sre.Grammar.getInstance().setPreprocessor("annotation",sre.Grammar.addAnnotation_),sre.Messages={},sre.Messages.MS={START:"",FRAC_V:"",FRAC_B:"",FRAC_S:"",END:"",FRAC_OVER:"",TWICE:"",NEST_FRAC:"",ENDFRAC:"",SUPER:"",SUB:"",SUP:"",SUPERSCRIPT:"",SUBSCRIPT:"",BASELINE:"",BASE:"",NESTED:"",NEST_ROOT:"",STARTROOT:"",ENDROOT:"",ROOTINDEX:"",ROOT:"",INDEX:"",UNDER:"",UNDERSCRIPT:"",OVER:"",OVERSCRIPT:""},sre.Messages.MS_FUNC={FRAC_NEST_DEPTH:function(e){return!1},RADICAL_NEST_DEPTH:function(e){return""},COMBINE_ROOT_INDEX:function(e,t){return e}},sre.Messages.MS_ROOT_INDEX={},sre.Messages.FONT={bold:"","bold-fraktur":"","bold-italic":"","bold-script":"",caligraphic:"","caligraphic-bold":"","double-struck":"","double-struck-italic":"",fraktur:"",italic:"",monospace:"",normal:"",oldstyle:"","oldstyle-bold":"",script:"","sans-serif":"","sans-serif-italic":"","sans-serif-bold":"","sans-serif-bold-italic":"",unknown:""},sre.Messages.ROLE={addition:"",multiplication:"",subtraction:"",division:"",equality:"",inequality:"",element:"",arrow:"",determinant:"",rowvector:"",binomial:"",squarematrix:"",multiline:"",matrix:"",vector:"",cases:"",table:"",unknown:""},sre.Messages.ENCLOSE={longdiv:"",actuarial:"",radical:"",box:"",roundedbox:"",circle:"",left:"",right:"",top:"",bottom:"",updiagonalstrike:"",downdiagonalstrike:"",verticalstrike:"",horizontalstrike:"",madruwb:"",updiagonalarrow:"",phasorangle:"",unknown:""},sre.Messages.NAVIGATE={COLLAPSIBLE:"",EXPANDABLE:"",LEVEL:""},sre.MathspeakUtil={},sre.MathspeakUtil.spaceoutText=function(e){return e.textContent.split("").join(" ")},sre.MathspeakUtil.spaceoutNumber=function(e){e=e.textContent.split("");for(var t=[],r=new sre.SystemExternal.xmldom.DOMParser,s=0;a=e[s];s++){var n=sre.Semantic.Type.NUMBER,i=a.match(/\W/)?sre.Semantic.Role.UNKNOWN:sre.Semantic.Role.PROTECTED,a=r.parseFromString("<"+n+' role="'+i+'">'+a+"</"+n+">","text/xml");t.push(a.documentElement)}return t},sre.MathspeakUtil.spaceoutIdentifier=function(e){if(!(t=e.textContent).match(/[a-zA-Z]+/))return e.setAttribute("role",sre.SemanticAttr.Role.PROTECTED),[e];e=t.split("");for(var t=[],r=new sre.SystemExternal.xmldom.DOMParser,s=0;i=e[s];s++){var n=sre.Semantic.Type.IDENTIFIER,i=r.parseFromString("<"+n+' role="'+sre.Semantic.Role.UNKNOWN+'">'+i+"</"+n+">","text/xml");t.push(i.documentElement)}return t},sre.MathspeakUtil.nestingBarriers=[sre.Semantic.Type.CASES,sre.Semantic.Type.CELL,sre.Semantic.Type.INTEGRAL,sre.Semantic.Type.LINE,sre.Semantic.Type.MATRIX,sre.Semantic.Type.MULTILINE,sre.Semantic.Type.OVERSCORE,sre.Semantic.Type.ROOT,sre.Semantic.Type.ROW,sre.Semantic.Type.SQRT,sre.Semantic.Type.SUBSCRIPT,sre.Semantic.Type.SUPERSCRIPT,sre.Semantic.Type.TABLE,sre.Semantic.Type.UNDERSCORE,sre.Semantic.Type.VECTOR],sre.MathspeakUtil.nestingDepth={},sre.MathspeakUtil.resetNestingDepth=function(e){return sre.MathspeakUtil.nestingDepth={},[e]},sre.MathspeakUtil.getNestingDepth=function(e,t,r,s,n,i){s=s||sre.MathspeakUtil.nestingBarriers,n=n||{},i=i||function(e){return!1};var a=(new sre.SystemExternal.xmldom.XMLSerializer).serializeToString(t);return sre.MathspeakUtil.nestingDepth[e]||(sre.MathspeakUtil.nestingDepth[e]={}),sre.MathspeakUtil.nestingDepth[e][a]||(i(t)||r.indexOf(t.tagName)<0?0:(t=sre.MathspeakUtil.computeNestingDepth_(t,r,sre.BaseUtil.setdifference(s,r),n,i,0),sre.MathspeakUtil.nestingDepth[e][a]=t))},sre.MathspeakUtil.containsAttr=function(e,t){if(!e.attributes)return!1;e=sre.DomUtil.toArray(e.attributes);for(var r,s=0;r=e[s];s++)if(t[r.nodeName]===r.nodeValue)return!0;return!1},sre.MathspeakUtil.computeNestingDepth_=function(e,t,r,s,n,i){return n(e)||-1<r.indexOf(e.tagName)||sre.MathspeakUtil.containsAttr(e,s)?i:(-1<t.indexOf(e.tagName)&&i++,e.childNodes&&0!==e.childNodes.length?(e=sre.DomUtil.toArray(e.childNodes),Math.max.apply(null,e.map(function(e){return sre.MathspeakUtil.computeNestingDepth_(e,t,r,s,n,i)}))):i)},sre.MathspeakUtil.fractionNestingDepth=function(e){return sre.MathspeakUtil.getNestingDepth("fraction",e,["fraction"],sre.MathspeakUtil.nestingBarriers,{},sre.Messages.MS_FUNC.FRAC_NEST_DEPTH)},sre.MathspeakUtil.openingFractionVerbose=function(e){return e=sre.MathspeakUtil.fractionNestingDepth(e),Array(e+1).join(sre.Messages.MS.START)+sre.Messages.MS.FRAC_V},sre.MathspeakUtil.closingFractionVerbose=function(e){return e=sre.MathspeakUtil.fractionNestingDepth(e),Array(e+1).join(sre.Messages.MS.END)+sre.Messages.MS.FRAC_V},sre.MathspeakUtil.overFractionVerbose=function(e){return e=sre.MathspeakUtil.fractionNestingDepth(e),Array(e+1).join(sre.Messages.MS.FRAC_OVER).trim()},sre.MathspeakUtil.openingFractionBrief=function(e){return e=sre.MathspeakUtil.fractionNestingDepth(e),Array(e+1).join(sre.Messages.MS.START)+sre.Messages.MS.FRAC_B},sre.MathspeakUtil.closingFractionBrief=function(e){return e=sre.MathspeakUtil.fractionNestingDepth(e),Array(e+1).join(sre.Messages.MS.END)+sre.Messages.MS.FRAC_B},sre.MathspeakUtil.openingFractionSbrief=function(e){return 1===(e=sre.MathspeakUtil.fractionNestingDepth(e))?sre.Messages.MS.FRAC_S:sre.Messages.MS.NEST_FRAC+sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(e-1)+sre.Messages.MS.FRAC_S},sre.MathspeakUtil.closingFractionSbrief=function(e){return 1===(e=sre.MathspeakUtil.fractionNestingDepth(e))?sre.Messages.MS.ENDFRAC:sre.Messages.MS.NEST_FRAC+sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(e-1)+sre.Messages.MS.ENDFRAC},sre.MathspeakUtil.overFractionSbrief=function(e){return 1===(e=sre.MathspeakUtil.fractionNestingDepth(e))?sre.Messages.MS.FRAC_OVER:sre.Messages.MS.NEST_FRAC+sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(e-1)+sre.Messages.MS.OVER},sre.MathspeakUtil.onesNumbers=" one two three four five six seven eight nine ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),sre.MathspeakUtil.tensNumbers="  twenty thirty forty fifty sixty seventy eighty ninety".split(" "),sre.MathspeakUtil.largeNumbers=" thousand million billion trillion quadrillion quintillion sextillion septillion octillion nonillion decillion".split(" "),sre.MathspeakUtil.hundredsToWords=function(e){e%=1e3;var t=sre.MathspeakUtil.onesNumbers[Math.floor(e/100)]?sre.MathspeakUtil.onesNumbers[Math.floor(e/100)]+"-hundred":"";return t=(e%=100)?t+(t?"-":"")+(sre.MathspeakUtil.onesNumbers[e]||sre.MathspeakUtil.tensNumbers[Math.floor(e/10)]+"-"+sre.MathspeakUtil.onesNumbers[e%10]):t},sre.MathspeakUtil.numberToWords=function(e){if(e>=Math.pow(10,36))return e.toString();for(var t=0,r="";0<e;)e%1e3&&(r=sre.MathspeakUtil.hundredsToWords(e%1e3)+(t?"-"+sre.MathspeakUtil.largeNumbers[t]+"-":"")+r),e=Math.floor(e/1e3),t++;return r},sre.MathspeakUtil.numberToOrdinal=function(e,t){return 2===e?t?"halves":"half":(e=(e=sre.MathspeakUtil.numberToWords(e)).match(/one$/)?e.slice(0,-3)+"first":e.match(/two$/)?e.slice(0,-3)+"second":e.match(/three$/)?e.slice(0,-5)+"third":e.match(/five$/)?e.slice(0,-4)+"fifth":e.match(/eight$/)?e.slice(0,-5)+"eighth":e.match(/nine$/)?e.slice(0,-4)+"ninth":e.match(/twelve$/)?e.slice(0,-6)+"twelfth":e.match(/ty$/)?e.slice(0,-2)+"tieth":e+"th",t?e+"s":e)},sre.MathspeakUtil.simpleOrdinal=function(e){var t=e%100,r=e.toString();if(10<t&&t<20)return r+"th";switch(e%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd";default:return r+"th"}},sre.MathspeakUtil.ordinalCounter=function(e,t){var r=0;return function(){return sre.MathspeakUtil.simpleOrdinal(++r)+" "+t}},sre.MathspeakUtil.convertVulgarFraction_=function(e){if(!e.childNodes||!e.childNodes[0]||!e.childNodes[0].childNodes||e.childNodes[0].childNodes.length<2||e.childNodes[0].childNodes[0].tagName!==sre.SemanticAttr.Type.NUMBER||e.childNodes[0].childNodes[0].getAttribute("role")!==sre.SemanticAttr.Role.INTEGER||e.childNodes[0].childNodes[1].tagName!==sre.SemanticAttr.Type.NUMBER||e.childNodes[0].childNodes[1].getAttribute("role")!==sre.SemanticAttr.Role.INTEGER)return{convertible:!1,content:e.textContent};var t=e.childNodes[0].childNodes[1].textContent,r=(e=e.childNodes[0].childNodes[0].textContent,Number(t)),s=Number(e);return isNaN(r)||isNaN(s)?{convertible:!1,content:e+" "+sre.Messages.MS.FRAC_OVER+" "+t}:{convertible:!0,enumerator:s,denominator:r}},sre.MathspeakUtil.vulgarFraction=function(e){return(e=sre.MathspeakUtil.convertVulgarFraction_(e)).convertible&&e.enumerator&&e.denominator?sre.MathspeakUtil.numberToWords(e.enumerator)+"-"+sre.MathspeakUtil.numberToOrdinal(e.denominator,1!==e.enumerator):e.content||""},sre.MathspeakUtil.vulgarFractionSmall=function(e){var t=sre.MathspeakUtil.convertVulgarFraction_(e);return!!t.convertible&&(e=t.enumerator,t=t.denominator,0<e&&e<10&&0<t&&t<100)},sre.MathspeakUtil.isSmallVulgarFraction=function(e){return sre.MathspeakUtil.vulgarFractionSmall(e)?[e]:[]},sre.MathspeakUtil.nestedSubSuper=function(e,t,r){for(;e.parentNode;){var s=e.parentNode,n=s.parentNode,i=e.getAttribute&&e.getAttribute("role");(n.tagName===sre.Semantic.Type.SUBSCRIPT&&e===s.childNodes[1]||n.tagName===sre.Semantic.Type.TENSOR&&i&&(i===sre.Semantic.Role.LEFTSUB||i===sre.Semantic.Role.RIGHTSUB))&&(t=r.sub+" "+t),(n.tagName===sre.Semantic.Type.SUPERSCRIPT&&e===s.childNodes[1]||n.tagName===sre.Semantic.Type.TENSOR&&i&&(i===sre.Semantic.Role.LEFTSUPER||i===sre.Semantic.Role.RIGHTSUPER))&&(t=r.sup+" "+t),e=n}return t.trim()},sre.MathspeakUtil.subscriptVerbose=function(e){return sre.MathspeakUtil.nestedSubSuper(e,sre.Messages.MS.SUBSCRIPT,{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.subscriptBrief=function(e){return sre.MathspeakUtil.nestedSubSuper(e,sre.Messages.MS.SUB,{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.superscriptVerbose=function(e){return sre.MathspeakUtil.nestedSubSuper(e,sre.Messages.MS.SUPERSCRIPT,{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.superscriptBrief=function(e){return sre.MathspeakUtil.nestedSubSuper(e,sre.Messages.MS.SUP,{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.baselineVerbose=function(e){return(e=sre.MathspeakUtil.nestedSubSuper(e,"",{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB}))?e.replace(new RegExp(sre.Messages.MS.SUB+"$"),sre.Messages.MS.SUBSCRIPT).replace(new RegExp(sre.Messages.MS.SUPER+"$"),sre.Messages.MS.SUPERSCRIPT):sre.Messages.MS.BASELINE},sre.MathspeakUtil.baselineBrief=function(e){return sre.MathspeakUtil.nestedSubSuper(e,"",{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})||sre.Messages.MS.BASE},sre.MathspeakUtil.radicalNestingDepth=function(e){return sre.MathspeakUtil.getNestingDepth("radical",e,["sqrt","root"],sre.MathspeakUtil.nestingBarriers,{})},sre.MathspeakUtil.nestedRadical=function(e,t,r){var s=sre.MathspeakUtil.radicalNestingDepth(e);return r=(e=sre.MathspeakUtil.getRootIndex(e))?sre.Messages.MS_FUNC.COMBINE_ROOT_INDEX(r,e):r,1===s?r:t+sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(s-1)+r},sre.MathspeakUtil.getRootIndex=function(e){return e="sqrt"===e.tagName?"2":sre.XpathUtil.evalXPath("children/*[1]",e)[0].textContent.trim(),sre.Messages.MS_ROOT_INDEX[e]||""},sre.MathspeakUtil.openingRadicalVerbose=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NESTED,sre.Messages.MS.STARTROOT)},sre.MathspeakUtil.closingRadicalVerbose=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NESTED,sre.Messages.MS.ENDROOT)},sre.MathspeakUtil.indexRadicalVerbose=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NESTED,sre.Messages.MS.ROOTINDEX)},sre.MathspeakUtil.openingRadicalBrief=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.STARTROOT)},sre.MathspeakUtil.closingRadicalBrief=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ENDROOT)},sre.MathspeakUtil.indexRadicalBrief=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ROOTINDEX)},sre.MathspeakUtil.openingRadicalSbrief=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ROOT)},sre.MathspeakUtil.indexRadicalSbrief=function(e){return sre.MathspeakUtil.nestedRadical(e,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.INDEX)},sre.MathspeakUtil.underscoreNestingDepth=function(e){return sre.MathspeakUtil.getNestingDepth("underscore",e,["underscore"],sre.MathspeakUtil.nestingBarriers,{},function(e){return e.tagName&&e.tagName===sre.Semantic.Type.UNDERSCORE&&e.childNodes[0].childNodes[1].getAttribute("role")===sre.Semantic.Role.UNDERACCENT})},sre.MathspeakUtil.nestedUnderscore=function(e){return e=sre.MathspeakUtil.underscoreNestingDepth(e),Array(e).join(sre.Messages.MS.UNDER)+sre.Messages.MS.UNDERSCRIPT},sre.MathspeakUtil.overscoreNestingDepth=function(e){return sre.MathspeakUtil.getNestingDepth("overscore",e,["overscore"],sre.MathspeakUtil.nestingBarriers,{},function(e){return e.tagName&&e.tagName===sre.Semantic.Type.OVERSCORE&&e.childNodes[0].childNodes[1].getAttribute("role")===sre.Semantic.Role.OVERACCENT})},sre.MathspeakUtil.nestedOverscore=function(e){return e=sre.MathspeakUtil.overscoreNestingDepth(e),Array(e).join(sre.Messages.MS.OVER)+sre.Messages.MS.OVERSCRIPT},sre.MathspeakUtil.determinantIsSimple=function(e){if(e.tagName!==sre.Semantic.Type.MATRIX||e.getAttribute("role")!==sre.Semantic.Role.DETERMINANT)return[];for(var t,r=sre.XpathUtil.evalXPath("children/row/children/cell/children/*",e),s=0;t=r[s];s++)if(t.tagName!==sre.Semantic.Type.NUMBER){if(t.tagName===sre.Semantic.Type.IDENTIFIER&&((t=t.getAttribute("role"))===sre.Semantic.Role.LATINLETTER||t===sre.Semantic.Role.GREEKLETTER||t===sre.Semantic.Role.OTHERLETTER))continue;return[]}return[e]},sre.MathspeakUtil.generateBaselineConstraint=function(){for(var t,e="not("+(s=function(e){return e.map(function(e){return"ancestor::"+e})})(["subscript","superscript","tensor"]).join(" or ")+")",r=s(["relseq","multrel"]),s=s(["fraction","punctuation","fenced","sqrt","root"]),n=[],i=0;t=s[i];i++)n=n.concat(r.map(function(e){return t+"/"+e}));return["ancestor::*/following-sibling::*",e,r="not("+n.join(" | ")+")"].join(" and ")},sre.MathspeakUtil.removeParens=function(e){return e.childNodes.length&&e.childNodes[0].childNodes.length&&e.childNodes[0].childNodes[0].childNodes.length?(e=e.childNodes[0].childNodes[0].childNodes[0].textContent).match(/^\(.+\)$/)?e.slice(1,-1):e:""},sre.Locale={},sre.Locale.nestingToString=function(e){switch(e){case 1:return"";case 2:return sre.Messages.MS.TWICE;default:return e.toString()}},sre.Locale.vulgarNestingDepth=function(e){return sre.MathspeakUtil.vulgarFractionSmall(e)},sre.Locale.combinePostfixIndex=function(e,t){return e===sre.Messages.MS.ROOTINDEX||e===sre.Messages.MS.INDEX?e:e+" "+t},sre.Locale.localFont=function(e){return sre.Messages.FONT[e]||e},sre.Grammar.getInstance().setCorrection("localFont",sre.Locale.localFont),sre.Locale.localRole=function(e){return sre.Messages.ROLE[e]||e},sre.Grammar.getInstance().setCorrection("localRole",sre.Locale.localRole),sre.Locale.localEnclose=function(e){return sre.Messages.ENCLOSE[e]||e},sre.Grammar.getInstance().setCorrection("localEnclose",sre.Locale.localEnclose),sre.Locale.en={MS:{START:"Start",FRAC_V:"Fraction",FRAC_B:"Frac",FRAC_S:"Frac",END:"End",FRAC_OVER:"Over",TWICE:"Twice",NEST_FRAC:"Nest",ENDFRAC:"EndFrac",SUPER:"Super",SUB:"Sub",SUP:"Sup",SUPERSCRIPT:"Superscript",SUBSCRIPT:"Subscript",BASELINE:"Baseline",BASE:"Base",NESTED:"Nested",NEST_ROOT:"Nest",STARTROOT:"StartRoot",ENDROOT:"EndRoot",ROOTINDEX:"RootIndex",ROOT:"Root",INDEX:"Index",UNDER:"Under",UNDERSCRIPT:"Underscript",OVER:"Over",OVERSCRIPT:"Overscript"},MS_FUNC:{FRAC_NEST_DEPTH:sre.Locale.vulgarNestingDepth,RADICAL_NEST_DEPTH:sre.Locale.nestingToString,COMBINE_ROOT_INDEX:function(e,t){return e}},MS_ROOT_INDEX:{},FONT:{},ROLE:{addition:"addition",multiplication:"multiplication",subtraction:"subtraction",division:"division",equality:"equality",inequality:"inequality",element:"element",arrow:"arrow",determinant:"determinant",rowvector:"row vector",binomial:"binomial",squarematrix:"square matrix",multiline:"multiple lines",matrix:"matrix",vector:"vector",cases:"case statement",table:"table",unknown:"unknown"},ENCLOSE:{longdiv:"long division",actuarial:"actuarial symbol",radical:"square root",box:"box",roundedbox:"rounded box",circle:"circle",left:"left vertical-line",right:"right vertical-line",top:"overbar",bottom:"underbar",updiagonalstrike:"crossout",downdiagonalstrike:"crossout",verticalstrike:"vertical strikeout",horizontalstrike:"crossout",madruwb:"Arabic factorial symbol",updiagonalarrow:"diagonal arrow",phasorangle:"phasor angle",unknown:"long division"},NAVIGATE:{COLLAPSIBLE:"collapsible",EXPANDABLE:"expandable",LEVEL:"Level"}},sre.Locale.es={MS:{START:"empezar ",FRAC_V:"fraccin",FRAC_B:"frac",FRAC_S:"frac",END:"finalizar ",FRAC_OVER:"entre ",TWICE:"",NEST_FRAC:"",ENDFRAC:"",SUPER:"super",SUB:"sub",SUP:"sup",SUPERSCRIPT:"superndice",SUBSCRIPT:"subndice",BASELINE:"lnea base",BASE:"",NESTED:"",NEST_ROOT:"",STARTROOT:"empezar raz",ENDROOT:"finalizar raz",ROOTINDEX:"ndice de raz",ROOT:"raz",INDEX:"",UNDER:"bajo",UNDERSCRIPT:"bajondice",OVER:"sobre",OVERSCRIPT:"sobrendice"},MS_FUNC:{FRAC_NEST_DEPTH:function(e){return!1},RADICAL_NEST_DEPTH:function(e){return""},COMBINE_ROOT_INDEX:sre.Locale.combinePostfixIndex},MS_ROOT_INDEX:{2:"cuadrada",3:"cbica",4:"a la cuarta",5:"a la quinta",6:"a la sexta",7:"a la sptima",8:"a la octava",9:"a la novena",10:"a la dcima"},FONT:{bold:"negrita","bold-fraktur":"negrita Fraktur","bold-italic":"negrita cursiva","bold-script":"negrita script",caligraphic:"caligrfica","caligraphic-bold":"caligrfica negrita","double-struck":"negrita de pizarra","double-struck-italic":"negrita de pizarra cursiva",fraktur:"Fraktur",italic:"cursiva",monospace:"monoespacio",normal:"normal",oldstyle:"estilo antiguo","oldstyle-bold":"estilo antiguo negrita",script:"script","sans-serif":"sans-serif","sans-serif-italic":"sans-serif cursiva","sans-serif-bold":"sans-serif negrita","sans-serif-bold-italic":"sans-serif negrita cursiva",unknown:"desconocida"},ROLE:{addition:"adicin",multiplication:"multiplicacin",subtraction:"resta",division:"divisin",equality:"igualdad",inequality:"desigualdad",element:"elemento",arrow:"flecha",determinant:"determinante",rowvector:"fila vector",binomial:"binomial",squarematrix:"matriz cuadrada",multiline:"lneas mltiples",matrix:"matriz",vector:"vector",cases:"declaracin de caso",table:"mesa",unknown:"desconocida"},ENCLOSE:{longdiv:"divisin larga",actuarial:"smbolo actuarial",radical:"raz cuadrada",box:"caja",roundedbox:"caja redondeada",circle:"crculo",left:"barra vertical izquierda",right:"barra vertical derecha",top:"barra",bottom:"subbarra",updiagonalstrike:"tachadura",downdiagonalstrike:"tachadura",verticalstrike:"ponchado vertical",horizontalstrike:"cruce",madruwb:"smbolo factorial rabe",updiagonalarrow:"flecha diagonal",phasorangle:"ngulo de fasores",unknown:"divisin larga"},NAVIGATE:{COLLAPSIBLE:"plegable",EXPANDABLE:"ampliable",LEVEL:"nivel"}},sre.L10n={},sre.L10n.setLocale=function(){var e=sre.L10n.getLocale();if(e)for(var t in e)sre.Messages[t]=e[t]},sre.L10n.getLocale=function(){return sre.Locale[sre.Engine.getInstance().locale]||sre.Locale.en},sre.AuditoryDescription=function(e){this.context=e.context||"",this.text=e.text||"",this.userValue=e.userValue||"",this.annotation=e.annotation||"",this.personality=e.personality||{}},sre.AuditoryDescription.create=function(e,t){return e.text=sre.Grammar.getInstance().apply(e.text,t||{}),new sre.AuditoryDescription(e)},sre.AuditoryDescription.prototype.isEmpty=function(){return 0==this.context.length&&0==this.text.length&&0==this.userValue.length&&0==this.annotation.length},sre.AuditoryDescription.prototype.clone=function(){if(this.personality){var e,t={};for(e in this.personality)t=this.personality[e]}return new sre.AuditoryDescription({context:this.context,text:this.text,userValue:this.userValue,annotation:this.annotation,personality:t})},sre.AuditoryDescription.prototype.toString=function(){return'AuditoryDescription(context="'+this.context+'"  text="'+this.text+'"  userValue="'+this.userValue+'"  annotation="'+this.annotation+'")'},sre.AuditoryDescription.prototype.descriptionString=function(){return this.context&&this.text?this.context+" "+this.text:this.context||this.text},sre.AuditoryDescription.prototype.equals=function(e){return this.context==e.context&&this.text==e.text&&this.userValue==e.userValue&&this.annotation==e.annotation},sre.SpeechRule=function(e,t,r,s){this.name=e,this.dynamicCstr=t,this.precondition=r,this.action=s},sre.SpeechRule.prototype.toString=function(){return this.name+" | "+this.dynamicCstr.toString()+" | "+this.precondition.toString()+" ==> "+this.action.toString()},sre.SpeechRule.Type={NODE:"NODE",MULTI:"MULTI",TEXT:"TEXT",PERSONALITY:"PERSONALITY"},sre.SpeechRule.Type.fromString=function(e){switch(e){case"[n]":return sre.SpeechRule.Type.NODE;case"[m]":return sre.SpeechRule.Type.MULTI;case"[t]":return sre.SpeechRule.Type.TEXT;case"[p]":return sre.SpeechRule.Type.PERSONALITY;default:throw"Parse error: "+e}},sre.SpeechRule.Type.toString=function(e){switch(e){case sre.SpeechRule.Type.NODE:return"[n]";case sre.SpeechRule.Type.MULTI:return"[m]";case sre.SpeechRule.Type.TEXT:return"[t]";case sre.SpeechRule.Type.PERSONALITY:return"[p]";default:throw"Unknown type error: "+e}},sre.SpeechRule.Component=function(e){this.type=e.type,this.content=e.content,this.attributes=e.attributes,this.grammar=e.grammar},sre.SpeechRule.Component.fromString=function(e){var t={};if(t.type=sre.SpeechRule.Type.fromString(e.substring(0,3)),!(e=e.slice(3).trim()))throw new sre.SpeechRule.OutputError("Missing content.");switch(t.type){case sre.SpeechRule.Type.TEXT:if('"'==e[0]){var r=sre.SpeechRule.splitString_(e,"\\(")[0].trim();if('"'!=r.slice(-1))throw new sre.SpeechRule.OutputError("Invalid string syntax.");t.content=r,-1==(e=e.slice(r.length).trim()).indexOf("(")&&(e="");break}case sre.SpeechRule.Type.NODE:case sre.SpeechRule.Type.MULTI:e=-1==(r=e.indexOf(" ("))?(t.content=e.trim(),""):(t.content=e.substring(0,r).trim(),e.slice(r).trim())}return e&&((e=sre.SpeechRule.Component.attributesFromString(e)).grammar&&(t.grammar=e.grammar,delete e.grammar),Object.keys(e).length&&(t.attributes=e)),new sre.SpeechRule.Component(t)},sre.SpeechRule.Component.prototype.toString=function(){var e=""+sre.SpeechRule.Type.toString(this.type),t=(e+=this.content?" "+this.content:"",this.attributesToString());return e+(t?" "+t:"")},sre.SpeechRule.Component.grammarFromString=function(e){return sre.Grammar.parseInput(e)},sre.SpeechRule.Component.prototype.grammarToString=function(){return this.getGrammar().join(":")},sre.SpeechRule.Component.prototype.getGrammar=function(){var e,t=[];for(e in this.grammar)!0===this.grammar[e]?t.push(e):!1===this.grammar[e]?t.push("!"+e):t.push(e+"="+this.grammar[e]);return t},sre.SpeechRule.Component.attributesFromString=function(e){if("("!=e[0]||")"!=e.slice(-1))throw new sre.SpeechRule.OutputError("Invalid attribute expression: "+e);for(var t={},r=0,s=(e=sre.SpeechRule.splitString_(e.slice(1,-1),",")).length;r<s;r++){var n,i=e[r],a=i.indexOf(":");-1==a?t[i.trim()]="true":(n=i.substring(0,a).trim(),i=i.slice(a+1).trim(),t[n]="grammar"===n?sre.SpeechRule.Component.grammarFromString(i):t[n]=i)}return t},sre.SpeechRule.Component.prototype.attributesToString=function(){var e=this.getAttributes(),t=this.grammarToString();return t&&e.push("grammar:"+t),0<e.length?"("+e.join(", ")+")":""},sre.SpeechRule.Component.prototype.getAttributes=function(){var e,t=[];for(e in this.attributes){var r=this.attributes[e];"true"===r?t.push(e):t.push(e+":"+r)}return t},sre.SpeechRule.Action=function(e){this.components=e},sre.SpeechRule.Action.fromString=function(e){for(var t=[],r=0,s=(e=sre.SpeechRule.splitString_(e,";").filter(function(e){return e.match(/\S/)}).map(function(e){return e.trim()})).length;r<s;r++){var n=sre.SpeechRule.Component.fromString(e[r]);n&&t.push(n)}return new sre.SpeechRule.Action(t)},sre.SpeechRule.Action.prototype.toString=function(){return this.components.map(function(e){return e.toString()}).join("; ")},sre.SpeechRule.Precondition=function(e,t){this.query=e,this.constraints=t||[]},sre.SpeechRule.Precondition.prototype.toString=function(){var e=this.constraints.join(", ");return this.query+", "+e},sre.SpeechRule.splitString_=function(e,t){for(var r=[],s="";""!=e;){var n=e.search(t);if(-1==n){if(0!=(e.match(/"/g)||[]).length%2)throw new sre.SpeechRule.OutputError("Invalid string in expression: "+e);r.push(s+e),e=s=""}else if(0==(e.substring(0,n).match(/"/g)||[]).length%2)r.push(s+e.substring(0,n)),s="",e=e.substring(n+1);else{var i=e.substring(n).search('"');if(-1==i)throw new sre.SpeechRule.OutputError("Invalid string in expression: "+e);s+=e.substring(0,n+i+1),e=e.substring(n+i+1)}}return s&&r.push(s),r},sre.SpeechRule.OutputError=function(e){Error.call(this),this.message=e||"",this.name="RuleError"},goog.inherits(sre.SpeechRule.OutputError,Error),sre.SpeechRuleEvaluator=function(){},sre.SpeechRuleEvaluator.prototype.evaluateDefault=goog.abstractMethod,sre.SpeechRuleFunctions=function(){},sre.SpeechRuleFunctions.Store_=function(e,t){this.prefix_=e,this.store_=t},sre.SpeechRuleFunctions.Store_.prototype.add=function(e,t){this.checkCustomFunctionSyntax_(e)&&(this.store_[e]=t)},sre.SpeechRuleFunctions.Store_.prototype.addStore=function(e){for(var t,r=Object.keys(e.store_),s=0;t=r[s];s++)this.add(t,e.store_[t])},sre.SpeechRuleFunctions.Store_.prototype.lookup=function(e){return this.store_[e]},sre.SpeechRuleFunctions.CustomQueries=function(){sre.SpeechRuleFunctions.Store_.call(this,"CQF",{})},goog.inherits(sre.SpeechRuleFunctions.CustomQueries,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.CustomStrings=function(){sre.SpeechRuleFunctions.Store_.call(this,"CSF",{})},goog.inherits(sre.SpeechRuleFunctions.CustomStrings,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.ContextFunctions=function(){sre.SpeechRuleFunctions.Store_.call(this,"CTXF",{})},goog.inherits(sre.SpeechRuleFunctions.ContextFunctions,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.Store_.prototype.checkCustomFunctionSyntax_=function(e){return!!e.match(new RegExp("^"+this.prefix_))||(console.log("FunctionError: Invalid function name. Expected prefix "+this.prefix_),!1)},sre.SpeechRuleStore=function(){},sre.SpeechRuleStore.prototype.addRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.deleteRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.findRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.findAllRules=goog.abstractMethod,sre.SpeechRuleStore.prototype.lookupRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.defineRule=goog.abstractMethod,sre.TrieNode=function(){},sre.TrieNode.prototype.getConstraint=function(){},sre.TrieNode.prototype.getKind=function(){},sre.TrieNode.prototype.applyTest=function(e){},sre.TrieNode.prototype.addChild=function(e){},sre.TrieNode.prototype.getChild=function(e){},sre.TrieNode.prototype.getChildren=function(){},sre.TrieNode.prototype.findChildren=function(e){},sre.TrieNode.Kind={ROOT:"root",DYNAMIC:"dynamic",QUERY:"query",BOOLEAN:"boolean",STATIC:"static"},sre.AbstractTrieNode=function(e,t){this.constraint=e,this.test=t,this.children_={},this.kind=sre.TrieNode.Kind.ROOT},sre.AbstractTrieNode.prototype.getConstraint=function(){return this.constraint},sre.AbstractTrieNode.prototype.getKind=function(){return this.kind},sre.AbstractTrieNode.prototype.applyTest=function(e){return this.test(e)},sre.AbstractTrieNode.prototype.addChild=function(e){var t=e.getConstraint(),r=this.children_[t];return this.children_[t]=e,r},sre.AbstractTrieNode.prototype.getChild=function(e){return this.children_[e]},sre.AbstractTrieNode.prototype.getChildren=function(){var e,t=[];for(e in this.children_)t.push(this.children_[e]);return t},sre.AbstractTrieNode.prototype.findChildren=function(e){var t,r=[];for(t in this.children_){var s=this.children_[t];s.applyTest(e)&&r.push(s)}return r},sre.AbstractTrieNode.prototype.toString=function(){return this.constraint},sre.StaticTrieNode=function(e,t){sre.AbstractTrieNode.call(this,e,t),this.kind=sre.TrieNode.Kind.STATIC,this.rule_=null},goog.inherits(sre.StaticTrieNode,sre.AbstractTrieNode),sre.StaticTrieNode.prototype.getRule=function(){return this.rule_},sre.StaticTrieNode.prototype.setRule=function(e){this.rule_&&sre.Debugger.getInstance().output("Replacing rule "+this.rule_+" with "+e),this.rule_=e},sre.StaticTrieNode.prototype.toString=function(){return this.getRule()?this.constraint+"\n==> "+this.getRule().action:this.constraint},sre.TrieNodeFactory={},sre.TrieNodeFactory.getNode=function(e,t,r){switch(e){case sre.TrieNode.Kind.ROOT:return new sre.RootTrieNode;case sre.TrieNode.Kind.DYNAMIC:return new sre.DynamicTrieNode(t);case sre.TrieNode.Kind.QUERY:return new sre.QueryTrieNode(t,r);case sre.TrieNode.Kind.BOOLEAN:return new sre.BooleanTrieNode(t,r);default:return null}},sre.RootTrieNode=function(){sre.AbstractTrieNode.call(this,"",function(){return!0}),this.kind=sre.TrieNode.Kind.ROOT},goog.inherits(sre.RootTrieNode,sre.AbstractTrieNode),sre.DynamicTrieNode=function(t){sre.AbstractTrieNode.call(this,t,function(e){return e===t}),this.kind=sre.TrieNode.Kind.DYNAMIC},goog.inherits(sre.DynamicTrieNode,sre.AbstractTrieNode),sre.TrieNodeFactory.constraintTest_=function(e){return e.match(/^self::\*$/)?function(e){return!0}:e.match(/^self::\w+$/)?(t=e.slice(6).toUpperCase(),function(e){return e.tagName&&sre.DomUtil.tagName(e)===t}):e.match(/^self::\w+:\w+$/)?(e=e.split(":"),(r=sre.XpathUtil.resolveNameSpace(e[2]))?(t=e[3].toUpperCase(),function(e){return e.localName&&e.localName.toUpperCase()===t&&e.namespaceURI===r}):null):e.match(/^@\w+$/)?(s=e.slice(1),function(e){return e.hasAttribute&&e.hasAttribute(s)}):e.match(/^@\w+="[\w\d ]+"$/)?(s=(e=e.split("="))[0].slice(1),n=e[1].slice(1,-1),function(e){return e.hasAttribute&&e.hasAttribute(s)&&e.getAttribute(s)===n}):e.match(/^@\w+!="[\w\d ]+"$/)?(e=e.split("!="),s=e[0].slice(1),n=e[1].slice(1,-1),function(e){return!e.hasAttribute||!e.hasAttribute(s)||e.getAttribute(s)!==n}):e.match(/^contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)$/)?(e=e.split('"'),n=e[1],function(e){return sre.Grammar.getInstance().getParameter(n)}):e.match(/^not\(\s*contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)\s*\)$/)?(e=e.split('"'),n=e[1],function(e){return!sre.Grammar.getInstance().getParameter(n)}):null;var t,r,s,n};sre.QueryTrieNode=function(e,t){this.store_=t,sre.StaticTrieNode.call(this,e,sre.TrieNodeFactory.constraintTest_(e)),this.kind=sre.TrieNode.Kind.QUERY},goog.inherits(sre.QueryTrieNode,sre.StaticTrieNode),sre.QueryTrieNode.prototype.applyTest=function(e){return this.test?this.test(e):this.store_.applyQuery(e,this.constraint)===e},sre.BooleanTrieNode=function(e,t){this.store_=t,sre.StaticTrieNode.call(this,e,sre.TrieNodeFactory.constraintTest_(e)),this.kind=sre.TrieNode.Kind.BOOLEAN},goog.inherits(sre.BooleanTrieNode,sre.StaticTrieNode),sre.BooleanTrieNode.prototype.applyTest=function(e){return this.test?this.test(e):this.store_.applyConstraint(e,this.constraint)},sre.Trie=function(e){this.store=e,this.root=sre.TrieNodeFactory.getNode(sre.TrieNode.Kind.ROOT,"",this.store)},sre.Trie.prototype.addRule=function(e){for(var t=this.root,r=e.dynamicCstr.getValues(),s=0,n=r.length;s<n;s++)t=this.addNode_(t,r[s],sre.TrieNode.Kind.DYNAMIC);for(t=this.addNode_(t,e.precondition.query,sre.TrieNode.Kind.QUERY),s=0,n=(r=e.precondition.constraints).length;s<n;s++)t=this.addNode_(t,r[s],sre.TrieNode.Kind.BOOLEAN);t.setRule(e)},sre.Trie.prototype.addNode_=function(e,t,r){var s=e.getChild(t);return s||(s=sre.TrieNodeFactory.getNode(r,t,this.store),e.addChild(s)),s},sre.Trie.prototype.lookupRules=function(e,t){for(var r=[this.root],s=[];t.length;){for(var n=t.shift(),i=[];r.length;){var a=r.shift();(a=a.getChildren()).forEach(function(e){e.getKind()===sre.TrieNode.Kind.DYNAMIC&&-1===n.indexOf(e.getConstraint())||i.push(e)})}r=i.slice()}for(;r.length;)(a=r.shift()).getRule&&(t=a.getRule())&&s.push(t),a=a.findChildren(e),r=r.concat(a);return s},sre.Trie.prototype.hasSubtrie=function(e){for(var t=this.root,r=0,s=e.length;r<s;r++)if(!(t=t.getChild(e[r])))return!1;return!0},sre.Trie.prototype.toString=function(){return sre.Trie.printWithDepth_(this.root,0,"")},sre.Trie.prototype.collectRules=function(){return sre.Trie.collectRules_(this.root)},sre.Trie.prototype.order=function(){return sre.Trie.order_(this.root)},sre.Trie.printWithDepth_=function(e,t,r){var s,n=Array(t+2).join(t)+": ";for(r+=n+e.toString()+"\n",e=e.getChildren(),n=0;s=e[n];n++)r=sre.Trie.printWithDepth_(s,t+1,r);return r},sre.Trie.order_=function(e){if(!(e=e.getChildren()).length)return 0;var t=Math.max.apply(null,e.map(sre.Trie.order_));return Math.max(e.length,t)},sre.Trie.collectRules_=function(e){var t=[];for(e=[e];e.length;){var r,s=e.shift();s.getKind()!==sre.TrieNode.Kind.QUERY&&s.getKind()!==sre.TrieNode.Kind.BOOLEAN||(r=s.getRule())&&t.unshift(r),e=e.concat(s.getChildren())}return t},sre.BaseRuleStore=function(){this.customQueries=new sre.SpeechRuleFunctions.CustomQueries,this.customStrings=new sre.SpeechRuleFunctions.CustomStrings,this.contextFunctions=new sre.SpeechRuleFunctions.ContextFunctions,this.speechRules_=[],this.trie=new sre.Trie(this),this.parseOrder=sre.DynamicCstr.DEFAULT_ORDER,this.parser=new sre.DynamicCstr.Parser(this.parseOrder),this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],this.initialized=!1},sre.BaseRuleStore.prototype.lookupRule=function(e,t){return e&&(e.nodeType==sre.DomUtil.NodeType.ELEMENT_NODE||e.nodeType==sre.DomUtil.NodeType.TEXT_NODE)&&0<(e=this.trie.lookupRules(e,t.allProperties())).length?this.pickMostConstraint_(t,e):null},sre.BaseRuleStore.prototype.defineRule=function(e,t,r,s,c){try{var n=sre.SpeechRule.Action.fromString(r),i=Array.prototype.slice.call(arguments,4),a=new sre.SpeechRule.Precondition(s,i),o=this.parseCstr(t),l=new sre.SpeechRule(e,o,a,n)}catch(e){if("RuleError"==e.name)return console.log("Rule Error ",s,"("+t+"):",e.message),null;throw e}return this.addRule(l),l},sre.BaseRuleStore.prototype.addRule=function(e){this.trie.addRule(e),this.speechRules_.unshift(e)},sre.BaseRuleStore.prototype.deleteRule=function(e){-1!=(e=this.speechRules_.indexOf(e))&&this.speechRules_.splice(e,1)},sre.BaseRuleStore.prototype.findRule=function(e){for(var t,r=0;t=this.speechRules_[r];r++)if(e(t))return t;return null},sre.BaseRuleStore.prototype.findAllRules=function(e){return this.speechRules_.filter(e)},sre.BaseRuleStore.prototype.evaluateDefault=function(e){return[sre.AuditoryDescription.create({text:e.textContent})]},sre.BaseRuleStore.prototype.debugSpeechRule=function(e,t){e=e.precondition;var r=this.applyQuery(t,e.query);sre.Debugger.getInstance().output(e.query,r&&r.toString()),e.constraints.forEach(goog.bind(function(e){sre.Debugger.getInstance().output(e,this.applyConstraint(t,e))},this))},sre.BaseRuleStore.prototype.initialize=goog.abstractMethod,sre.BaseRuleStore.prototype.removeDuplicates=function(e){for(var t,r=this.speechRules_.length-1;t=this.speechRules_[r];r--)t!=e&&e.dynamicCstr.equal(t.dynamicCstr)&&sre.BaseRuleStore.comparePreconditions_(t,e)&&this.speechRules_.splice(r,1)},sre.BaseRuleStore.prototype.applyCustomQuery=function(e,t){return(t=this.customQueries.lookup(t))?t(e):null},sre.BaseRuleStore.prototype.applySelector=function(e,t){return this.applyCustomQuery(e,t)||sre.XpathUtil.evalXPath(t,e)},sre.BaseRuleStore.prototype.applyQuery=function(e,t){return 0<(e=this.applySelector(e,t)).length?e[0]:null},sre.BaseRuleStore.prototype.applyConstraint=function(e,t){return!!this.applyQuery(e,t)||sre.XpathUtil.evaluateBoolean(t,e)},sre.BaseRuleStore.prototype.pickMostConstraint_=function(e,t){var r=sre.Engine.getInstance().comparator;return t.sort(function(e,t){return r.compare(e.dynamicCstr,t.dynamicCstr)||t.precondition.constraints.length-e.precondition.constraints.length}),sre.Debugger.getInstance().generateOutput(goog.bind(function(){return t.map(function(e){return e.name+"("+e.dynamicCstr.toString()+")"})},this)),t[0]},sre.BaseRuleStore.compareStaticConstraints_=function(e,t){if(e.length!=t.length)return!1;for(var r,s=0;r=e[s];s++)if(-1==t.indexOf(r))return!1;return!0},sre.BaseRuleStore.comparePreconditions_=function(e,t){return e=e.precondition,t=t.precondition,e.query==t.query&&sre.BaseRuleStore.compareStaticConstraints_(e.constraints,t.constraints)},sre.BaseRuleStore.prototype.getSpeechRules=function(){return this.speechRules_},sre.BaseRuleStore.prototype.setSpeechRules=function(e){this.speechRules_=e},sre.BaseRuleStore.prototype.parseCstr=function(e){return this.parser.parse(this.locale+"."+e)},sre.MathStore=function(){sre.BaseRuleStore.call(this),this.initializer=[]},goog.inherits(sre.MathStore,sre.BaseRuleStore),sre.MathStore.prototype.initialize=function(){if(!this.initialized){for(var e,t=0;e=this.initializer[t];t++)e();this.setSpeechRules(this.trie.collectRules()),this.initialized=!0}},sre.MathStore.prototype.defineUniqueRuleAlias=function(t,e,r,s){var n=this.parseCstr(e),i=this.findRule(goog.bind(function(e){return e.name==t&&n.equal(e.dynamicCstr)},this));if(!i)throw new sre.SpeechRule.OutputError("Rule named "+t+" with style "+e+" does not exist.");this.addAlias_(i,r,Array.prototype.slice.call(arguments,3))},sre.MathStore.prototype.defineRuleAlias=function(t,e,r){var s=this.findRule(function(e){return e.name==t});if(!s)throw new sre.SpeechRule.OutputError("Rule with named "+t+" does not exist.");this.addAlias_(s,e,Array.prototype.slice.call(arguments,2))},sre.MathStore.prototype.defineRulesAlias=function(t,r,e){var s=this.findAllRules(function(e){return e.name==t});if(0==s.length)throw new sre.SpeechRule.OutputError("Rule with name "+t+" does not exist.");var n=Array.prototype.slice.call(arguments,2);s.forEach(goog.bind(function(e){this.addAlias_(e,r,n)},this))},sre.MathStore.prototype.addAlias_=function(e,t,r){t=new sre.SpeechRule.Precondition(t,r),(t=new sre.SpeechRule(e.name,e.dynamicCstr,t,e.action)).name=e.name,this.addRule(t)},sre.MathStore.prototype.defineSpecialisedRule=function(t,e,r,s){var n=this.parseCstr(e),i=this.findRule(goog.bind(function(e){return e.name==t&&n.equal(e.dynamicCstr)},this));if(!i)throw new sre.SpeechRule.OutputError("Rule named "+t+" with style "+e+" does not exist.");e=this.parseCstr(r),s=s?sre.SpeechRule.Action.fromString(s):i.action,i=new sre.SpeechRule(i.name,e,i.precondition,s),this.addRule(i)},sre.MathStore.prototype.evaluateDefault=function(e){return this.evaluateString_(e.textContent)},sre.MathStore.prototype.evaluateString_=function(e){var t=[];if(e.match(/^\s+$/))return t;e=sre.BaseUtil.removeEmpty(e.replace(/\s/g," ").split(" "));for(var r=0;i=e[r];r++)if(1==i.length)t.push(this.evaluate_(i));else if(i.match(/^[a-zA-Z]+$/))t.push(this.evaluate_(i));else for(;i;)var s=i.match(/^((\d{1,3})(?=,)(,\d{3})*(\.\d+)?)|^\d*\.\d+|^\d+/),n=i.match(/^[a-zA-Z]+/),i=s?(t.push(this.evaluate_(s[0])),i.substring(s[0].length)):n?(t.push(this.evaluate_(n[0])),i.substring(n[0].length)):55296<=(s=i[0].charCodeAt(0))&&s<=56319&&1<i.length&&!isNaN(i.charCodeAt(1))?(t.push(this.evaluate_(i.slice(0,2))),i.substring(2)):(t.push(this.evaluate_(i[0])),i.substring(1));return t},sre.MathStore.prototype.evaluate_=function(e){return sre.AuditoryDescription.create({text:e},{adjust:!0,translate:!0})},sre.WalkerUtil={},sre.WalkerUtil.splitAttribute=function(e){return e?e.split(/,/):[]},sre.WalkerUtil.getAttribute=function(e,t){return sre.DomUtil.getDataAttribute(e,t)},sre.WalkerUtil.getSemanticRoot=function(e){if(e.hasAttribute(sre.EnrichMathml.Attribute.TYPE)&&!e.hasAttribute(sre.EnrichMathml.Attribute.PARENT))return e;for(var t,r=sre.DomUtil.querySelectorAllByAttr(e,sre.EnrichMathml.Attribute.TYPE),s=0;t=r[s];s++)if(!t.hasAttribute(sre.EnrichMathml.Attribute.PARENT))return t;return e},sre.WalkerUtil.getBySemanticId=function(e,t){return e.getAttribute(sre.EnrichMathml.Attribute.ID)===t?e:sre.DomUtil.querySelectorAllByAttrValue(e,sre.EnrichMathml.Attribute.ID,t)[0]},sre.RebuildStree=function(e){this.nodeDict={},this.mathml=e,this.mmlRoot=sre.WalkerUtil.getSemanticRoot(e),this.streeRoot=this.assembleTree(this.mmlRoot),this.stree=sre.SemanticTree.fromNode(this.streeRoot,this.mathml),this.xml=this.stree.xml()},sre.RebuildStree.prototype.getTree=function(){return this.stree},sre.RebuildStree.prototype.assembleTree=function(t){var e,r=this.makeNode(t),s=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(t,sre.EnrichMathml.Attribute.CHILDREN)),n=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(t,sre.EnrichMathml.Attribute.CONTENT));return 0===n.length&&0===s.length?(r.textContent=t.textContent,r):(0<n.length&&(!(e=sre.WalkerUtil.getBySemanticId(t,n[0]))||1<(e=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.OPERATOR))).length&&(r.textContent=e[1])),r.contentNodes=n.map(goog.bind(e=function(e){return e=sre.WalkerUtil.getBySemanticId(t,e),(e=this.assembleTree(e)).parent=r,e},this)),r.childNodes=s.map(goog.bind(e,this)),(s=sre.WalkerUtil.getAttribute(t,sre.EnrichMathml.Attribute.COLLAPSED))?this.postProcess(r,s):r)},sre.RebuildStree.prototype.makeNode=function(e){var t=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.TYPE),r=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.ROLE),s=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.FONT),n=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.ID),i=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.EMBELLISHED);return e=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.FENCEPOINTER),(n=this.createNode(parseInt(n,10))).type=t,n.role=r,n.font=s||sre.SemanticAttr.Font.UNKNOWN,e&&(n.fencePointer=e),i&&(n.embellished=i),n},sre.RebuildStree.isPunctuated=function(e){return!sre.SemanticSkeleton.simpleCollapseStructure(e)&&e[1]&&sre.SemanticSkeleton.contentCollapseStructure(e[1])},sre.RebuildStree.prototype.makePunctuation=function(e){return(e=this.createNode(e)).updateContent(sre.SemanticAttr.invisibleComma()),e.role=sre.SemanticAttr.Role.DUMMY,e},sre.RebuildStree.prototype.makePunctuated=function(e,t,r){var s=this.createNode(t[0]);s.type=sre.SemanticAttr.Type.PUNCTUATED,s.embellished=e.embellished,s.fencePointer=e.fencePointer,s.role=r,e=t.splice(1,1)[0].slice(1),s.contentNodes=e.map(goog.bind(this.makePunctuation,this)),this.collapsedChildren_(t)},sre.RebuildStree.prototype.makeEmpty=function(e,t,r){(t=this.createNode(t)).type=sre.SemanticAttr.Type.EMPTY,t.embellished=e.embellished,t.fencePointer=e.fencePointer,t.role=r},sre.RebuildStree.prototype.makeIndex=function(e,t,r){sre.RebuildStree.isPunctuated(t)?this.makePunctuated(e,t,r):sre.SemanticSkeleton.simpleCollapseStructure(t)&&!this.nodeDict[t.toString()]&&this.makeEmpty(e,t,r)},sre.RebuildStree.prototype.postProcess=function(e,t){var r;return t=sre.SemanticSkeleton.fromString(t).array,e.type===sre.SemanticAttr.Role.SUBSUP?((r=this.createNode(t[1][0])).type=sre.SemanticAttr.Type.SUBSCRIPT,r.role=sre.SemanticAttr.Role.SUBSUP,e.type=sre.SemanticAttr.Type.SUPERSCRIPT,r.embellished=e.embellished,r.fencePointer=e.fencePointer,this.makeIndex(e,t[1][2],sre.SemanticAttr.Role.RIGHTSUB),this.makeIndex(e,t[2],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(t)):e.type===sre.SemanticAttr.Type.SUBSCRIPT?(this.makeIndex(e,t[2],sre.SemanticAttr.Role.RIGHTSUB),this.collapsedChildren_(t)):e.type===sre.SemanticAttr.Type.SUPERSCRIPT?(this.makeIndex(e,t[2],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(t)):e.type===sre.SemanticAttr.Type.TENSOR?(this.makeIndex(e,t[2],sre.SemanticAttr.Role.LEFTSUB),this.makeIndex(e,t[3],sre.SemanticAttr.Role.LEFTSUPER),this.makeIndex(e,t[4],sre.SemanticAttr.Role.RIGHTSUB),this.makeIndex(e,t[5],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(t)):e.type===sre.SemanticAttr.Type.PUNCTUATED?sre.RebuildStree.isPunctuated(t)&&(t=t.splice(1,1)[0].slice(1),e.contentNodes=t.map(goog.bind(this.makePunctuation,this))):e.type===sre.SemanticAttr.Role.UNDEROVER&&(r=this.createNode(t[1][0]),e.childNodes[1].role===sre.SemanticAttr.Role.OVERACCENT?(r.type=sre.SemanticAttr.Type.OVERSCORE,e.type=sre.SemanticAttr.Type.UNDERSCORE):(r.type=sre.SemanticAttr.Type.UNDERSCORE,e.type=sre.SemanticAttr.Type.OVERSCORE),r.role=sre.SemanticAttr.Role.UNDEROVER,r.embellished=e.embellished,r.fencePointer=e.fencePointer,this.collapsedChildren_(t)),e},sre.RebuildStree.prototype.createNode=function(e){var t=new sre.SemanticNode(e);return this.nodeDict[e.toString()]=t},sre.RebuildStree.prototype.collapsedChildren_=function(e){var i=goog.bind(function(e){var t=this.nodeDict[e[0]];t.childNodes=[];for(var r=1,s=e.length;r<s;r++){var n=e[r];t.childNodes.push(sre.SemanticSkeleton.simpleCollapseStructure(n)?this.nodeDict[n]:i(n))}return t},this);i(e)},sre.SpeechGenerator=function(){},sre.SpeechGenerator.prototype.getSpeech=function(e,t){},sre.SpeechGenerator.prototype.getRebuilt=function(){},sre.SpeechGenerator.prototype.setRebuilt=function(e){},sre.SpeechGenerator.prototype.start=function(){},sre.SpeechGenerator.prototype.end=function(){},sre.MathSimpleStore=function(){sre.MathStore.call(this)},goog.inherits(sre.MathSimpleStore,sre.MathStore),sre.MathSimpleStore.prototype.defineRulesFromMappings=function(e,t,r){for(var s in r)for(var n in r[s])this.defineRule(e,s+"."+n,'[t] "'+r[s][n]+'"',"self::text()",'"'===t?"self::text() = '"+t+"'":'self::text() = "'+t+'"')},sre.MathSimpleStore.prototype.lookupRule=function(e,t){return(e=this.getSpeechRules().filter(function(e){return sre.MathSimpleStore.testDynamicConstraints_(t,e)})).length?e.sort(function(e,t){return sre.Engine.getInstance().comparator.compare(e.dynamicCstr,t.dynamicCstr)})[0]:null},sre.MathSimpleStore.testDynamicConstraints_=function(e,t){return sre.Engine.getInstance().strict?t.dynamicCstr.equal(e):sre.Engine.getInstance().comparator.match(t.dynamicCstr)},sre.MathCompoundStore=function(){this.subStores_={},this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]},goog.addSingletonGetter(sre.MathCompoundStore),sre.MathCompoundStore.prototype.defineRules=function(e,t,r){var s=this.subStores_[t];s?sre.Debugger.getInstance().output("Store exists! "+t):(s=new sre.MathSimpleStore,this.subStores_[t]=s),s.locale=this.locale,s.defineRulesFromMappings(e,t,r)},sre.MathCompoundStore.prototype.changeLocale_=function(e){return!!e.locale&&(this.locale=e.locale,!0)},sre.MathCompoundStore.prototype.addSymbolRules=function(e){var t;this.changeLocale_(e)||(t=sre.MathSimpleStore.parseUnicode_(e.key),this.defineRules(e.key,t,e.mappings))},sre.MathCompoundStore.prototype.addFunctionRules=function(e){if(!this.changeLocale_(e)){var t=e.names;e=e.mappings;for(var r,s=0;r=t[s];s++)this.defineRules(r,r,e)}},sre.MathCompoundStore.prototype.addUnitRules=function(e){var t;this.changeLocale_(e)||((t=e.names)&&(e.names=t.map(function(e){return e+":unit"})),this.addFunctionRules(e))},sre.MathCompoundStore.prototype.lookupRule=function(e,t){return(e=this.subStores_[e])?e.lookupRule(null,t):null},sre.MathCompoundStore.prototype.lookupString=function(e,t){return(e=this.lookupRule(e,t))?e.action.components.map(function(e){return e.content.slice(1,-1)}).join(" "):""},sre.MathSimpleStore.parseUnicode_=function(e){return(e=parseInt(e,16))<65536?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))},sre.MathMap=function(){this.store=sre.MathCompoundStore.getInstance(),this.retrieveMaps()},goog.addSingletonGetter(sre.MathMap),sre.MathMap.toFetch_=0,sre.Engine.registerTest(function(){return sre.MathMap.getInstance()&&!sre.MathMap.toFetch_}),sre.MathMap.prototype.stringify=function(){return JSON.stringify(this)},sre.MathMap.SYMBOLS_PATH_="symbols",sre.MathMap.FUNCTIONS_PATH_="functions",sre.MathMap.UNITS_PATH_="units",sre.MathMap.SYMBOLS_FILES_="greek-capital.js greek-small.js greek-scripts.js greek-symbols.js greek-mathfonts-bold.js greek-mathfonts-italic.js greek-mathfonts-sans-serif-bold.js hebrew_letters.js latin-lower-double-accent.js latin-lower-normal.js latin-lower-phonetic.js latin-lower-single-accent.js latin-rest.js latin-upper-double-accent.js latin-upper-normal.js latin-upper-single-accent.js latin-mathfonts-bold-fraktur.js latin-mathfonts-bold.js latin-mathfonts-bold-script.js latin-mathfonts-double-struck.js latin-mathfonts-fraktur.js latin-mathfonts-italic.js latin-mathfonts-monospace.js latin-mathfonts-sans-serif-bold.js latin-mathfonts-sans-serif-italic.js latin-mathfonts-sans-serif.js latin-mathfonts-script.js math_angles.js math_arrows.js math_characters.js math_delimiters.js math_digits.js math_geometry.js math_harpoons.js math_non_characters.js math_symbols.js math_whitespace.js other_stars.js".split(" "),sre.MathMap.FUNCTIONS_FILES_=["algebra.js","elementary.js","hyperbolic.js","trigonometry.js"],sre.MathMap.UNITS_FILES_="energy.js length.js memory.js other.js speed.js temperature.js time.js volume.js weight.js".split(" "),sre.MathMap.retrieveFiles=function(e,t,r){switch(t=sre.BaseUtil.makePath(sre.SystemExternal.jsonPath+t),sre.Engine.getInstance().mode){case sre.Engine.Mode.ASYNC:sre.MathMap.toFetch_+=e.length;for(var s,n=0;s=e[n];n++)sre.MathMap.fromFile_(t+s,function(e,t){sre.MathMap.toFetch_--,e||JSON.parse(t).forEach(function(e){r(e)})});break;case sre.Engine.Mode.HTTP:var i=sre.Engine.getInstance().isIE;for(sre.MathMap.toFetch_+=e.length,n=0;s=e[n];n++)i?sre.MathMap.getJsonIE_(s,r):sre.MathMap.getJsonAjax_(t+s,r);break;default:sre.MathMap.parseFiles(e.map(function(e){return t+e})).forEach(function(e){r(e)})}},sre.MathMap.prototype.retrieveMaps=function(){for(var e=0;e<sre.Variables.LOCALES.length;e++){var t=sre.Variables.LOCALES[e];sre.MathMap.retrieveFiles(sre.MathMap.FUNCTIONS_FILES_,t+"/"+sre.MathMap.FUNCTIONS_PATH_,goog.bind(this.store.addFunctionRules,this.store)),sre.MathMap.retrieveFiles(sre.MathMap.SYMBOLS_FILES_,t+"/"+sre.MathMap.SYMBOLS_PATH_,goog.bind(this.store.addSymbolRules,this.store)),sre.MathMap.retrieveFiles(sre.MathMap.UNITS_FILES_,t+"/"+sre.MathMap.UNITS_PATH_,goog.bind(this.store.addUnitRules,this.store))}},sre.MathMap.getJsonIE_=function(e,t,r){var s=r||1;if(sre.BrowserUtil.mapsForIE){for(r=0;r<sre.Variables.LOCALES.length;r++){var n=sre.BrowserUtil.mapsForIE[sre.Variables.LOCALES[r]+"/"+e];n&&n.forEach(function(e){t(e)})}sre.MathMap.toFetch_--}else s<=5?setTimeout(function(){sre.MathMap.getJsonIE_(e,t,s++)},300):sre.MathMap.toFetch_--},sre.MathMap.fromFile_=function(e,t){return sre.SystemExternal.fs.readFile(e,"utf8",t)},sre.MathMap.loadFile=function(t){try{return sre.MathMap.readJSON_(t)}catch(e){console.log("Unable to load file: "+t+", error: "+e)}},sre.MathMap.loadFiles=function(e){return e.map(sre.MathMap.loadFile)},sre.MathMap.parseFiles=function(e){return e=sre.MathMap.loadFiles(e),[].concat.apply([],e.map(function(e){return JSON.parse(e)}))},sre.MathMap.readJSON_=function(e){return sre.SystemExternal.fs.readFileSync(e)},sre.MathMap.getJsonAjax_=function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(sre.MathMap.toFetch_--,200===r.status&&JSON.parse(r.responseText).forEach(function(e){t(e)}))},r.open("GET",e,!0),r.send()},sre.AbstractionRules=function(){sre.MathStore.call(this)},goog.inherits(sre.AbstractionRules,sre.MathStore),goog.addSingletonGetter(sre.AbstractionRules),sre.AbstractionRules.mathStore=sre.AbstractionRules.getInstance(),sre.AbstractionRules.defineRule_=goog.bind(sre.AbstractionRules.mathStore.defineRule,sre.AbstractionRules.mathStore),sre.AbstractionRules.defineRuleAlias_=goog.bind(sre.AbstractionRules.mathStore.defineRulesAlias,sre.AbstractionRules.mathStore),sre.AbstractionRules.defineSpecialisedRule_=goog.bind(sre.AbstractionRules.mathStore.defineSpecialisedRule,sre.AbstractionRules.mathStore),sre.AbstractionRules.defineUniqueRuleAlias_=goog.bind(sre.AbstractionRules.mathStore.defineUniqueRuleAlias,sre.AbstractionRules.mathStore),sre.AbstractionRules.initAbstractionRules_=function(){(0,sre.AbstractionRules.defineRule_)("abstr-collapsed","mathspeak.default",'[t] "collapsed"; [n] . (grammar:collapsed)',"self::*","@alternative",'not(@alternative="summary")','not(contains(@grammar, "collapsed"))'),(0,sre.AbstractionRules.defineRule_)("abstr-identifier","mathspeak.default",'[t] "long identifier"',"self::identifier","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-identifier","mathspeak.default",'[t] "identifier"',"self::identifier",'@alternative="summary"',"@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-identifier","mathspeak.brief",'[t] "identifier"',"self::identifier","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-identifier","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-number","mathspeak.default",'[t] "long number"',"self::number","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-number","mathspeak.default",'[t] "number"',"self::number","@alternative",'@alternative="summary"'),(0,sre.AbstractionRules.defineRule_)("abstr-number","mathspeak.brief",'[t] "number"',"self::number","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-number","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-mixed-number","mathspeak.default",'[t] "long mixed number"',"self::number","@alternative",'@role="mixed"'),(0,sre.AbstractionRules.defineRule_)("abstr-mixed-number","mathspeak.brief",'[t] "mixed number"',"self::number","@alternative",'@role="mixed"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-mixed-number","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-text","mathspeak.default",'[t] "text"',"self::text","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-function","mathspeak.default",'[t] "functional expression"',"self::function","@alternative","self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-function","mathspeak.brief",'[t] "function"',"self::function","@alternative","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-function","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-lim","mathspeak.default",'[t] "limit function"',"self::function","@alternative",'@role="limit function"'),(0,sre.AbstractionRules.defineRule_)("abstr-lim","mathspeak.brief",'[t] "lim"',"self::function","@alternative",'@role="limit function"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-lim","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-fraction","mathspeak.default",'[t] "fraction"',"self::fraction","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-fraction","mathspeak.brief",'[t] "frac"',"self::fraction","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-fraction","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-continued-fraction","mathspeak.default",'[t] "continued fraction"',"self::fraction","@alternative",'children/*[2]/descendant-or-self::*[@role="ellipsis"]',"self::*","self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-continued-fraction","mathspeak.brief",'[t] "continued frac"',"self::fraction","@alternative",'children/*[2]/descendant-or-self::*[@role="ellipsis"]',"self::*","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-continued-fraction","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-sqrt","mathspeak.default",'[t] "square root"',"self::sqrt","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-sqrt","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-sqrt","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-sqrt-nested","mathspeak.default",'[t] "nested square root"',"self::sqrt","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-sqrt-nested","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-sqrt-nested","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-root","mathspeak.default",'[t] "root of index"; [n] children/*[1]; [t] "endindex"',"self::root","@alternative","following-sibling::* or ancestor::*/following-sibling::*"),(0,sre.AbstractionRules.defineRule_)("abstr-root","mathspeak.brief",'[t] "root"',"self::root","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-root","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-root-nested","mathspeak.default",'[t] "nested root of index"; [n] children/*[1]',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionRules.defineRule_)("abstr-root-nested","mathspeak.default",'[t] "nested root of index"; [n] children/*[1]; [t] "endindex"',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root","following-sibling::* or ancestor::*/following-sibling::*"),(0,sre.AbstractionRules.defineRule_)("abstr-root-nested","mathspeak.brief",'[t] "nested root"',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-root-nested","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-superscript","mathspeak.default",'[t] "power"',"self::superscript","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-superscript","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-superscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-subscript","mathspeak.default",'[t] "subscript"',"self::subscript","@alternative","self::*","self::*","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-subscript","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-subsup","mathspeak.default",'[t] "power with subscript"',"self::superscript","@alternative",'name(children/*[1])="subscript"',"self::*","self::*","self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-subsup","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-subsup","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-infixop","mathspeak.default",'[t] @role (grammar:localRole); [t] "with"; [t] count(./children/*); [t] "elements"',"self::infixop","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-infixop","mathspeak.default",'[t] @role (grammar:localRole); [t] "with variable number of elements"',"self::infixop","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-infixop","mathspeak.brief","[t] @role (grammar:localRole)","self::infixop","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-infixop","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-addition","mathspeak.default",'[t] "sum with"; [t] count(./children/*); [t] "summands"',"self::infixop","@alternative",'@role="addition"'),(0,sre.AbstractionRules.defineRule_)("abstr-addition","mathspeak.brief",'[t] "sum"',"self::infixop","@alternative",'@role="addition"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-addition","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-addition","mathspeak.default",'[t] "sum with variable number of summands"',"self::infixop","@alternative",'@role="addition"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-multiplication","mathspeak.default",'[t] "product with"; [t] count(./children/*); [t] "factors"',"self::infixop","@alternative",'@role="multiplication"'),(0,sre.AbstractionRules.defineRule_)("abstr-multiplication","mathspeak.brief",'[t] "product"',"self::infixop","@alternative",'@role="multiplication"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-multiplication","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRuleAlias_)("abstr-multiplication","self::infixop","@alternative",'@role="implicit"'),(0,sre.AbstractionRules.defineRule_)("abstr-var-multiplication","mathspeak.default",'[t] "product with variable number of factors"',"self::infixop","@alternative",'@role="multiplication"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRuleAlias_)("abstr-var-multiplication","self::infixop","@alternative",'@role="implicit"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-vector","mathspeak.default",'[t] count(./children/*) ; [t] "dimensional vector"',"self::vector","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-vector","mathspeak.brief",'[t] "vector"',"self::vector","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-vector","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-vector","mathspeak.default",'[t] "n dimensional vector"',"self::vector","@alternative",'./children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-binomial","mathspeak.default",'[t] "binomial"',"self::vector","@alternative",'@role="binomial"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-binomial","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-binomial","mathspeak.default","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-determinant","mathspeak.default",'[t] count(./children/*); [t] "dimensional determinant"',"self::matrix","@alternative",'@role="determinant"',"self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-determinant","mathspeak.brief",'[t] "determinant"',"self::matrix","@alternative",'@role="determinant"',"self::*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-determinant","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-determinant","mathspeak.default",'[t] "n dimensional determinant"',"self::matrix","@alternative",'@role="determinant"','./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-squarematrix","mathspeak.default",'[t] count(./children/*); [t] "dimensional square matrix"',"self::matrix","@alternative",'@role="squarematrix"'),(0,sre.AbstractionRules.defineRule_)("abstr-squarematrix","mathspeak.brief",'[t] "square matrix"',"self::matrix","@alternative",'@role="squarematrix"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-squarematrix","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-rowvector","mathspeak.default",'[t] count(./children/row/children/*); [t] "dimensional row vector"',"self::matrix","@alternative",'@role="rowvector"'),(0,sre.AbstractionRules.defineRule_)("abstr-rowvector","mathspeak.brief",'[t] "row vector"',"self::matrix","@alternative",'@role="rowvector"'),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-rowvector","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-matrix","mathspeak.default",'[t] "n dimensional row vector"',"self::matrix","@alternative",'@role="rowvector"','./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-matrix","mathspeak.default",'[t] count(children/*);  [t] "by";[t] count(children/*[1]/children/*); [t] "matrix"',"self::matrix","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-matrix","mathspeak.brief",'[t] "matrix"',"self::matrix","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-matrix","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-matrix","mathspeak.default",'[t] "n by m dimensional matrix"',"self::matrix","@alternative",'./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-cases","mathspeak.default",'[t] "case statement";[t] "with"; [t] count(children/*); [t] "cases"',"self::cases","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-cases","mathspeak.brief",'[t] "case statement"',"self::cases","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-cases","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-cases","mathspeak.default",'[t] "case statement with variable number of cases"',"self::cases","@alternative",'./children/row/children/cell/children/punctuation[@role="ellipsis"]or ./children/line/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-punctuated","mathspeak.default",'[n] content/*[1]; [t] "separated list";[t] "of length"; [t] count(children/*) - count(content/*)',"self::punctuated","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-punctuated","mathspeak.brief",'[n] content/*[1]; [t] "separated list"',"self::punctuated","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-punctuated","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-punctuated","mathspeak.default",'[n] content/*[1]; [t] "separated list";[t] "of variable length"',"self::punctuated","@alternative",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-bigop","mathspeak.default","[n] content/*[1]","self::bigop","@alternative","self::*"),(0,sre.AbstractionRules.defineRule_)("abstr-integral","mathspeak.default",'[t] "integral"',"self::*","@alternative",'@role="integral"'),(0,sre.AbstractionRules.defineRule_)("abstr-relation","mathspeak.default","[t] @role (grammar:localRole);","self::relseq","@alternative","count(./children/*)=2"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-relation","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-relation","mathspeak.default",'[t] @role (grammar:localRole); [t] "sequence"; [t] "with"; [t] count(./children/*); [t] "elements"',"self::relseq","@alternative","count(./children/*)>2"),(0,sre.AbstractionRules.defineRule_)("abstr-relation","mathspeak.brief",'[t] @role (grammar:localRole); [t] "sequence"',"self::relseq","@alternative","count(./children/*)>2"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-relation","mathspeak.default",'[t] @role (grammar:localRole); [t] "sequence"; [t] "with variable number of elements"',"self::relseq","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineUniqueRuleAlias_)("abstr-relation","mathspeak.default","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2"),(0,sre.AbstractionRules.defineUniqueRuleAlias_)("abstr-relation","mathspeak.brief","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRuleAlias_)("abstr-var-relation","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-multirel","mathspeak.default",'[t] "relation sequence"; [t] "with"; [t] count(./children/*); [t] "elements"',"self::multirel","@alternative","count(./children/*)>2"),(0,sre.AbstractionRules.defineRule_)("abstr-multirel","mathspeak.brief",'[t] "relation sequence"',"self::multirel","@alternative","count(./children/*)>2"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-multirel","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-var-multirel","mathspeak.default",'[t] "relation sequence with variable number of elements"',"self::multirel","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionRules.defineRule_)("abstr-table","mathspeak.default",'[t] "table with"; [t] count(children/*); [t] "rows and";[t] count(children/*[1]/children/*); [t] "columns"',"self::table","@alternative"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-table","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-table","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-line","mathspeak.default",'[t] "in"; [t] @role (grammar:localRole);',"self::line","@alternative"),(0,sre.AbstractionRules.defineRule_)("abstr-row","mathspeak.default",'[t] "in"; [t] @role (grammar:localRole);[t] count(preceding-sibling::..); [t] "with";[t] count(children/*); [t] "columns"',"self::row","@alternative","*"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-row","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionRules.defineSpecialisedRule_)("abstr-row","mathspeak.default","mathspeak.sbrief"),(0,sre.AbstractionRules.defineRule_)("abstr-cell","mathspeak.default",'[t] "in"; [t] @role (grammar:localRole);',"self::cell","@alternative")},sre.AbstractionRules.getInstance().initializer=[sre.AbstractionRules.initAbstractionRules_],sre.AbstractionSpanish=function(){sre.MathStore.call(this),this.locale="es"},goog.inherits(sre.AbstractionSpanish,sre.MathStore),goog.addSingletonGetter(sre.AbstractionSpanish),sre.AbstractionSpanish.mathStore=sre.AbstractionSpanish.getInstance(),sre.AbstractionSpanish.defineRule_=goog.bind(sre.AbstractionSpanish.mathStore.defineRule,sre.AbstractionSpanish.mathStore),sre.AbstractionSpanish.defineRuleAlias_=goog.bind(sre.AbstractionSpanish.mathStore.defineRulesAlias,sre.AbstractionSpanish.mathStore),sre.AbstractionSpanish.defineSpecialisedRule_=goog.bind(sre.AbstractionSpanish.mathStore.defineSpecialisedRule,sre.AbstractionSpanish.mathStore),sre.AbstractionSpanish.defineUniqueRuleAlias_=goog.bind(sre.AbstractionSpanish.mathStore.defineUniqueRuleAlias,sre.AbstractionSpanish.mathStore),sre.AbstractionSpanish.initAbstractionSpanish_=function(){(0,sre.AbstractionSpanish.defineRule_)("abstr-collapsed","mathspeak.default",'[n] . (grammar:collapsed); [t] "plegado"',"self::*","@alternative",'not(@alternative="summary")','not(contains(@grammar, "collapsed"))'),(0,sre.AbstractionSpanish.defineRule_)("abstr-identifier","mathspeak.default",'[t] "identificador largo"',"self::identifier","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-identifier","mathspeak.default",'[t] "identificador"',"self::identifier",'@alternative="summary"',"@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-identifier","mathspeak.brief",'[t] "identificador"',"self::identifier","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-identifier","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-number","mathspeak.default",'[t] "nmero largo"',"self::number","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-number","mathspeak.default",'[t] "nmero"',"self::number","@alternative",'@alternative="summary"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-number","mathspeak.brief",'[t] "nmero"',"self::number","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-number","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-mixed-number","mathspeak.default",'[t] "nmero largo mixto"',"self::number","@alternative",'@role="mixed"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-mixed-number","mathspeak.brief",'[t] "numero mixto"',"self::number","@alternative",'@role="mixed"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-mixed-number","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-text","mathspeak.default",'[t] "texto"',"self::text","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-function","mathspeak.default",'[t] "expresin funcional"',"self::function","@alternative","self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-function","mathspeak.brief",'[t] "funcin"',"self::function","@alternative","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-function","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-lim","mathspeak.default",'[t] "funcin de lmite"',"self::function","@alternative",'@role="limit function"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-lim","mathspeak.brief",'[t] "lmite"',"self::function","@alternative",'@role="limit function"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-lim","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-fraction","mathspeak.default",'[t] "fraccin"',"self::fraction","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-fraction","mathspeak.brief",'[t] "frac"',"self::fraction","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-fraction","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-continued-fraction","mathspeak.default",'[t] "fraccin continua"',"self::fraction","@alternative",'children/*[2]/descendant-or-self::*[@role="ellipsis"]',"self::*","self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-continued-fraction","mathspeak.brief",'[t] "frac continua"',"self::fraction","@alternative",'children/*[2]/descendant-or-self::*[@role="ellipsis"]',"self::*","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-continued-fraction","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-sqrt","mathspeak.default",'[t] "raz cuadrada"',"self::sqrt","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-sqrt","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-sqrt","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-sqrt-nested","mathspeak.default",'[t] "raz cuadrada anidada"',"self::sqrt","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-sqrt-nested","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-sqrt-nested","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-root","mathspeak.default",'[t] "raz del ndice"; [n] children/*[1]; [t] "finalizar de ndice"',"self::root","@alternative","following-sibling::* or ancestor::*/following-sibling::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-root","mathspeak.brief",'[t] "raz"',"self::root","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-root","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-root-nested","mathspeak.default",'[t] "raz anidada del ndice"; [n] children/*[1]',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionSpanish.defineRule_)("abstr-root-nested","mathspeak.default",'[t] "raz anidada del ndice"; [n] children/*[1]; [t] "finalizar de ndice"',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root","following-sibling::* or ancestor::*/following-sibling::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-root-nested","mathspeak.brief",'[t] "raz anidada"',"self::root","@alternative","children/*/descendant-or-self::sqrt or children/*/descendant-or-self::root"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-root-nested","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-superscript","mathspeak.default",'[t] "potencia"',"self::superscript","@alternative","self::*","self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-superscript","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-superscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-subscript","mathspeak.default",'[t] "subndice"',"self::subscript","@alternative","self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-subscript","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-subsup","mathspeak.default",'[t] "potencia con subndice"',"self::superscript","@alternative",'name(children/*[1])="subscript"',"self::*","self::*","self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-subsup","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-subsup","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-infixop","mathspeak.default",'[t] @role (grammar:localRole); [t] "con"; [t] count(./children/*); [t] "elementos"',"self::infixop","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-infixop","mathspeak.default",'[t] @role (grammar:localRole); [t] "con una cantidad variable de elementos"',"self::infixop","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-infixop","mathspeak.brief","[t] @role (grammar:localRole)","self::infixop","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-infixop","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-addition","mathspeak.default",'[t] "suma con"; [t] count(./children/*); [t] "sumandos"',"self::infixop","@alternative",'@role="addition"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-addition","mathspeak.brief",'[t] "suma"',"self::infixop","@alternative",'@role="addition"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-addition","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-addition","mathspeak.default",'[t] "suma con nmero variable de sumandos"',"self::infixop","@alternative",'@role="addition"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-multiplication","mathspeak.default",'[t] "producto con"; [t] count(./children/*); [t] "factores"',"self::infixop","@alternative",'@role="multiplication"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-multiplication","mathspeak.brief",'[t] "producto"',"self::infixop","@alternative",'@role="multiplication"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-multiplication","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRuleAlias_)("abstr-multiplication","self::infixop","@alternative",'@role="implicit"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-multiplication","mathspeak.default",'[t] "producto con una cantidad variable de factores"',"self::infixop","@alternative",'@role="multiplication"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRuleAlias_)("abstr-var-multiplication","self::infixop","@alternative",'@role="implicit"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-vector","mathspeak.default",'[t] "vector de dimensin"; [t] count(./children/*)',"self::vector","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-vector","mathspeak.brief",'[t] "vector"',"self::vector","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-vector","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-vector","mathspeak.default",'[t] "vector de dimensin n"',"self::vector","@alternative",'./children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-binomial","mathspeak.default",'[t] "binomio"',"self::vector","@alternative",'@role="binomial"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-binomial","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-binomial","mathspeak.default","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-determinant","mathspeak.default",'[t] "determinante de dimensin"; [t] count(./children/*)',"self::matrix","@alternative",'@role="determinant"',"self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-determinant","mathspeak.brief",'[t] "determinante"',"self::matrix","@alternative",'@role="determinant"',"self::*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-determinant","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-determinant","mathspeak.default",'[t] "determinante de dimensin n"',"self::matrix","@alternative",'@role="determinant"','./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-squarematrix","mathspeak.default",'[t] "matriz cuadrada de dimensin"; [t] count(./children/*)',"self::matrix","@alternative",'@role="squarematrix"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-squarematrix","mathspeak.brief",'[t] "matriz cuadrada"',"self::matrix","@alternative",'@role="squarematrix"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-squarematrix","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-rowvector","mathspeak.default",'[t] "vector fila de dimensin"; [t] count(./children/row/children/*) ',"self::matrix","@alternative",'@role="rowvector"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-rowvector","mathspeak.brief",'[t] "vector fila"',"self::matrix","@alternative",'@role="rowvector"'),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-rowvector","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-matrix","mathspeak.default",'[t] "vector fila de dimensin n"',"self::matrix","@alternative",'@role="rowvector"','./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-matrix","mathspeak.default",'[t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [t] "matriz"',"self::matrix","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-matrix","mathspeak.brief",'[t] "matriz"',"self::matrix","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-matrix","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-matrix","mathspeak.default",'[t] "matriz de dimensin n por m"',"self::matrix","@alternative",'./children/*/children/*/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-cases","mathspeak.default",'[t] "declaracin de caso";[t] "con"; [t] count(children/*); [t] "casos"',"self::cases","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-cases","mathspeak.brief",'[t] "declaracin de caso"',"self::cases","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-cases","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-cases","mathspeak.default",'[t] "declaracin de caso con nmero variable de casos"',"self::cases","@alternative",'./children/row/children/cell/children/punctuation[@role="ellipsis"]or ./children/line/children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-punctuated","mathspeak.default",'[t] "lista separada por"; [n] content/*[1]; [t] "de longitud"; [t] count(children/*) - count(content/*)',"self::punctuated","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-punctuated","mathspeak.brief",'[t] "lista separada por"; [n] content/*[1]',"self::punctuated","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-punctuated","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-punctuated","mathspeak.default",'[t] "lista separada por"; [n] content/*[1]','[t] "de longitud variable"',"self::punctuated","@alternative",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-bigop","mathspeak.default","[n] content/*[1]","self::bigop","@alternative","self::*"),(0,sre.AbstractionSpanish.defineRule_)("abstr-integral","mathspeak.default",'[t] "integral"',"self::*","@alternative",'@role="integral"'),(0,sre.AbstractionSpanish.defineRule_)("abstr-relation","mathspeak.default","[t] @role (grammar:localRole);","self::relseq","@alternative","count(./children/*)=2"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-relation","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-relation","mathspeak.default",'[t] "secuencia de"; [t] @role (grammar:localRole); [t] "con"; [t] count(./children/*); [t] "elementos"',"self::relseq","@alternative","count(./children/*)>2"),(0,sre.AbstractionSpanish.defineRule_)("abstr-relation","mathspeak.brief",'[t] "secuencia de"; [t] @role (grammar:localRole)',"self::relseq","@alternative","count(./children/*)>2"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-relation","mathspeak.default",'[t] "secuencia de"; [t] @role (grammar:localRole); [t] "con una cantidad variable de elementos"',"self::relseq","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineUniqueRuleAlias_)("abstr-relation","mathspeak.default","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2"),(0,sre.AbstractionSpanish.defineUniqueRuleAlias_)("abstr-relation","mathspeak.brief","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-relation","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRuleAlias_)("abstr-var-relation","self::multirel","@alternative",'@role!="unknown"',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-multirel","mathspeak.default",'[t] "secuencia de relacin"; [t] "con"; [t] count(./children/*); [t] "elementos"',"self::multirel","@alternative","count(./children/*)>2"),(0,sre.AbstractionSpanish.defineRule_)("abstr-multirel","mathspeak.brief",'[t] "secuencia de relacin"',"self::multirel","@alternative","count(./children/*)>2"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-multirel","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-var-multirel","mathspeak.default",'[t] "secuencia de relacin con nmero variable de elementos"',"self::multirel","@alternative","count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.AbstractionSpanish.defineRule_)("abstr-table","mathspeak.default",'[t] "mesa con"; [t] count(children/*); [t] "filas y";[t] count(children/*[1]/children/*); [t] "columnas"',"self::table","@alternative"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-table","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-table","mathspeak.brief","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-line","mathspeak.default",'[t] "en"; [t] @role (grammar:localRole);',"self::line","@alternative"),(0,sre.AbstractionSpanish.defineRule_)("abstr-row","mathspeak.default",'[t] "en"; [t] @role (grammar:localRole);[t] count(preceding-sibling::..); [t] "con";[t] count(children/*); [t] "columnas"',"self::row","@alternative","*"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-row","mathspeak.default","mathspeak.brief"),(0,sre.AbstractionSpanish.defineSpecialisedRule_)("abstr-row","mathspeak.default","mathspeak.sbrief"),(0,sre.AbstractionSpanish.defineRule_)("abstr-cell","mathspeak.default",'[t] "en"; [t] @role (grammar:localRole);',"self::cell","@alternative")},sre.AbstractionSpanish.getInstance().initializer=[sre.AbstractionSpanish.initAbstractionSpanish_],sre.ClearspeakRules=function(){sre.MathStore.call(this)},goog.inherits(sre.ClearspeakRules,sre.MathStore),goog.addSingletonGetter(sre.ClearspeakRules),sre.ClearspeakRules.mathStore=sre.ClearspeakRules.getInstance(),sre.ClearspeakRules.defineRule_=goog.bind(sre.ClearspeakRules.mathStore.defineRule,sre.ClearspeakRules.mathStore),sre.ClearspeakRules.initClearspeakRules_=function(){(0,sre.ClearspeakRules.defineRule_)("fraction","mathspeak.clearspeak",'[t] "the fraction with numerator"; [n] children/*[1]; [p] (pause:300); [t] "and denominator"; [n] children/*[2]; [p] (pause:500)',"self::fraction"),(0,sre.ClearspeakRules.defineRule_)("sqrt","mathspeak.clearspeak",'[t] "the square root of"; [n] children/*[1]; [p] (pause:500)',"self::sqrt")},sre.ClearspeakRules.getInstance().initializer=[sre.ClearspeakRules.initClearspeakRules_],sre.MathmlStoreUtil={},sre.MathmlStoreUtil.matchMathjaxToMathml=function(e){return sre.Engine.getInstance().alternativeHost.querySelector("#"+e.id)},sre.MathmlStoreUtil.retrieveMathjaxExtender=function(e){return(e=sre.MathmlStoreUtil.matchMathjaxToMathml(e))?[e]:[]},sre.MathmlStoreUtil.retrieveMathjaxLeaf=function(e){return(e=sre.MathmlStoreUtil.matchMathjaxToMathml(e))?[e]:[]},sre.MathmlStoreUtil.checkMathjaxTag=function(e,t){return(e=sre.MathmlStoreUtil.matchMathjaxToMathml(e))&&e.tagName.toUpperCase()==t?[e]:[]},sre.MathmlStoreUtil.checkMathjaxMunder=function(e){return sre.MathmlStoreUtil.checkMathjaxTag(e,"MUNDER")},sre.MathmlStoreUtil.checkMathjaxMover=function(e){return sre.MathmlStoreUtil.checkMathjaxTag(e,"MOVER")},sre.MathmlStoreUtil.checkMathjaxMsub=function(e){return sre.MathmlStoreUtil.checkMathjaxTag(e,"MSUB")},sre.MathmlStoreUtil.checkMathjaxMsup=function(e){return sre.MathmlStoreUtil.checkMathjaxTag(e,"MSUP")},sre.MathmlStoreUtil.mfencedSeparators=function(e,t){var r=sre.MathUtil.nextSeparatorFunction(t);return function(){return r?[sre.AuditoryDescription.create({text:r()},{translate:!0})]:[]}},sre.MathmlStoreUtil.contentIterator=function(e,r){var s=0<e.length?sre.XpathUtil.evalXPath("../../content/*",e[0]):[];return function(){var e=s.shift(),t=r?[sre.AuditoryDescription.create({text:r},{translate:!0})]:[];return e?(e=sre.SpeechRuleEngine.getInstance().evaluateNode(e),t.concat(e)):t}},sre.StoreUtil={},sre.StoreUtil.nodeCounter=function(e,t){var r=e.length,s=0,n=t?t:"";return function(){return s<r&&(s+=1),n+" "+s}},sre.EmacspeakRules=function(){sre.MathStore.call(this)},goog.inherits(sre.EmacspeakRules,sre.MathStore),goog.addSingletonGetter(sre.EmacspeakRules),sre.EmacspeakRules.mathStore=sre.EmacspeakRules.getInstance(),sre.EmacspeakRules.defineRule_=goog.bind(sre.EmacspeakRules.mathStore.defineRule,sre.EmacspeakRules.mathStore),sre.EmacspeakRules.defineRuleAlias_=goog.bind(sre.EmacspeakRules.mathStore.defineRuleAlias,sre.EmacspeakRules.mathStore),sre.EmacspeakRules.addContextFunction_=goog.bind(sre.EmacspeakRules.mathStore.contextFunctions.add,sre.EmacspeakRules.mathStore.contextFunctions),sre.EmacspeakRules.addCustomQuery_=goog.bind(sre.EmacspeakRules.mathStore.customQueries.add,sre.EmacspeakRules.mathStore.customQueries),sre.EmacspeakRules.addCustomString_=goog.bind(sre.EmacspeakRules.mathStore.customStrings.add,sre.EmacspeakRules.mathStore.customStrings),sre.EmacspeakRules.initCustomFunctions_=function(){(0,sre.EmacspeakRules.addContextFunction_)("CTXFnodeCounter",sre.StoreUtil.nodeCounter),(0,sre.EmacspeakRules.addContextFunction_)("CTXFcontentIterator",sre.MathmlStoreUtil.contentIterator),(0,sre.EmacspeakRules.addCustomQuery_)("CQFvulgarFractionSmall",sre.MathspeakUtil.isSmallVulgarFraction),(0,sre.EmacspeakRules.addCustomString_)("CSFvulgarFraction",sre.MathspeakUtil.vulgarFraction)},sre.EmacspeakRules.initSemanticRules_=function(){(0,sre.EmacspeakRules.defineRule_)("stree","emacspeak.default","[n] ./*[1]","self::stree"),(0,sre.EmacspeakRules.defineRule_)("multrel","emacspeak.default",'[t] "multirelation"; [m] children/* (sepFunc:CTXFcontentIterator)',"self::multirel"),(0,sre.EmacspeakRules.defineRule_)("variable-equality","emacspeak.default",'[t] "equation sequence"; [m] children/* (context:"part",ctxtFunc:CTXFnodeCounter,sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.EmacspeakRules.defineRule_)("multi-equality","emacspeak.default",'[t] "equation sequence"; [m] children/* (context:"part",ctxtFunc:CTXFnodeCounter,sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2"),(0,sre.EmacspeakRules.defineRule_)("multi-equality","emacspeak.short",'[t] "equation sequence"; [m] children/* (sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2"),(0,sre.EmacspeakRules.defineRule_)("equality","emacspeak.default",'[t] "equation"; [t] "left hand side"; [n] children/*[1];[p] (pause:200); [n] content/*[1] (pause:200);[t] "right hand side"; [n] children/*[2]','self::relseq[@role="equality"]',"count(./children/*)=2"),(0,sre.EmacspeakRules.defineRule_)("simple-equality","emacspeak.default","[n] children/*[1]; [p] (pause:200); [n] content/*[1] (pause:200);[n] children/*[2]",'self::relseq[@role="equality"]',"count(./children/*)=2","./children/identifier or ./children/number"),(0,sre.EmacspeakRules.defineRule_)("simple-equality2","emacspeak.default","[n] children/*[1]; [p] (pause:200); [n] content/*[1] (pause:200);[n] children/*[2]",'self::relseq[@role="equality"]',"count(./children/*)=2","./children/function or ./children/appl"),(0,sre.EmacspeakRules.defineRule_)("relseq","emacspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq"),(0,sre.EmacspeakRules.defineRule_)("implicit","emacspeak.default","[m] children/*","self::infixop",'@role="implicit"','children/*[1][@role="latinletter"] or children/*[1][@role="greekletter"] or children/*[1][@role="otherletter"] or name(children/*[1])="number"','children/*[2][@role="latinletter"] or children/*[2][@role="greekletter"] or children/*[2][@role="otherletter"] or name(children/*[2])="number"'),(0,sre.EmacspeakRules.defineRule_)("binary-operation","emacspeak.default","[p] (pause:100); [m] children/* (sepFunc:CTXFcontentIterator); [p] (pause:100);","self::infixop"),(0,sre.EmacspeakRules.defineRule_)("variable-addition","emacspeak.default",'[t] "sum with variable number of summands";[p] (pause:400); [m] children/* (sepFunc:CTXFcontentIterator)','self::infixop[@role="addition"]',"count(children/*)>2",'children/punctuation[@role="ellipsis"]'),(0,sre.EmacspeakRules.defineRule_)("prefix","emacspeak.default",'[t] "prefix"; [n] text(); [t] "of" (pause 150);[n] children/*[1]',"self::prefixop"),(0,sre.EmacspeakRules.defineRule_)("negative","emacspeak.default",'[t] "negative"; [n] children/*[1]',"self::prefixop",'self::prefixop[@role="negative"]'),(0,sre.EmacspeakRules.defineRule_)("postfix","emacspeak.default",'[n] children/*[1]; [t] "postfix"; [n] text() (pause 300)',"self::postfixop"),(0,sre.EmacspeakRules.defineRule_)("identifier","emacspeak.default","[n] text()","self::identifier"),(0,sre.EmacspeakRules.defineRule_)("number","emacspeak.default","[n] text()","self::number"),(0,sre.EmacspeakRules.defineRule_)("font","mathspeak.default","[t] @font; [n] . (grammar:ignoreFont=@font)","self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"'),(0,sre.EmacspeakRules.defineRule_)("font-identifier-short","emacspeak.default","[t] @font; [n] CQFhideFont; [t] CSFshowFont","self::identifier","string-length(text())=1","@font",'@font="normal"','""=translate(text(), "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ", "")','@role!="unit"'),(0,sre.EmacspeakRules.defineRule_)("font-identifier","mathspeak.default","[t] @font; [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'@font="normal"','not(contains(@grammar, "ignoreFont"))','@role!="unit"'),(0,sre.EmacspeakRules.defineRule_)("omit-font","mathspeak.default","[n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="italic"'),(0,sre.EmacspeakRules.defineRule_)("simple-fraction","emacspeak.default",'[p] (pause:100); [n] children/*[1] (rate:0.35); [t] "over";  [n] children/*[2] (rate:-0.35); [p] (pause:100)',"self::fraction",'name(children/*[1])="number" or name(children/*[1])="identifier"','name(children/*[2])="number" or name(children/*[2])="identifier"'),(0,sre.EmacspeakRules.defineRule_)("vulgar-fraction","emacspeak.default","[t] CSFvulgarFraction","self::fraction",'@role="vulgar"',"CQFvulgarFractionSmall"),(0,sre.EmacspeakRules.defineRule_)("fraction","emacspeak.default",'[p] (pause:250); [n] children/*[1] (rate:0.35); [p] (pause:250); [t] "divided by"; [p] (pause:250);  [n] children/*[2] (rate:-0.35); [p] (pause:250)',"self::fraction"),(0,sre.EmacspeakRules.defineRule_)("superscript","emacspeak.default",'[n] children/*[1]; [t] "super"; [n] children/*[2] (pitch:0.35);[p] (pause:300)',"self::superscript"),(0,sre.EmacspeakRules.defineRule_)("subscript","emacspeak.default",'[n] children/*[1]; [t] "sub"; [n] children/*[2] (pitch:-0.35);[p] (pause:300)',"self::subscript"),(0,sre.EmacspeakRules.defineRule_)("ellipsis","emacspeak.default",'[p] (pause:200); [t] "ellipsis"; [p] (pause:300)',"self::punctuation",'self::punctuation[@role="ellipsis"]'),(0,sre.EmacspeakRules.defineRule_)("fence-single","emacspeak.default","[n] text()","self::punctuation",'self::punctuation[@role="openfence"]'),(0,sre.EmacspeakRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="closefence"]'),(0,sre.EmacspeakRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="vbar"]'),(0,sre.EmacspeakRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="application"]'),(0,sre.EmacspeakRules.defineRule_)("omit-empty","emacspeak.default","[p] (pause:100)","self::empty"),(0,sre.EmacspeakRules.defineRule_)("fences-open-close","emacspeak.default","[p] (pause:200); [n] children/*[1] (rate:0.35); [p] (pause:200)","self::fenced",'@role="leftright"'),(0,sre.EmacspeakRules.defineRule_)("fences-open-close-in-appl","emacspeak.default","[p] (pause:200); [n] children/*[1]; [p] (pause:200);",'self::fenced[@role="leftright"]',"./parent::children/parent::appl"),(0,sre.EmacspeakRules.defineRule_)("fences-neutral","emacspeak.default",'[p] (pause:100); [t] "absolute value of"; [n] children/*[1];[p] (pause:350);',"self::fenced",'self::fenced[@role="neutral"]'),(0,sre.EmacspeakRules.defineRule_)("omit-fences","emacspeak.default","[p] (pause:500); [n] children/*[1]; [p] (pause:200);","self::fenced"),(0,sre.EmacspeakRules.defineRule_)("matrix","emacspeak.default",'[t] "matrix"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:100)',"self::matrix"),(0,sre.EmacspeakRules.defineRule_)("matrix-row","emacspeak.default",'[m] children/* (ctxtFunc:CTXFnodeCounter,context:"column",pause:100)','self::row[@role="matrix"]'),(0,sre.EmacspeakRules.defineRule_)("matrix-cell","emacspeak.default","[n] children/*[1]",'self::cell[@role="matrix"]'),(0,sre.EmacspeakRules.defineRule_)("vector","emacspeak.default",'[t] "vector"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"element",pause:100)',"self::vector"),(0,sre.EmacspeakRules.defineRule_)("cases","emacspeak.default",'[t] "case statement"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"case",pause:100)',"self::cases"),(0,sre.EmacspeakRules.defineRule_)("cases-row","emacspeak.default","[m] children/*",'self::row[@role="cases"]'),(0,sre.EmacspeakRules.defineRule_)("cases-cell","emacspeak.default","[n] children/*[1]",'self::cell[@role="cases"]'),(0,sre.EmacspeakRules.defineRule_)("row","emacspeak.default",'[m] ./* (ctxtFunc:CTXFnodeCounter,context:"column",pause:100)',"self::row"),(0,sre.EmacspeakRules.defineRule_)("cases-end","emacspeak.default",'[t] "case statement"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"case",pause:100);[t] "end cases"',"self::cases","following-sibling::*"),(0,sre.EmacspeakRules.defineRule_)("multiline","emacspeak.default",'[t] "multiline equation";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"line",pause:100)',"self::multiline"),(0,sre.EmacspeakRules.defineRule_)("line","emacspeak.default","[m] children/*","self::line"),(0,sre.EmacspeakRules.defineRule_)("table","emacspeak.default",'[t] "multiline equation";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:200)',"self::table"),(0,sre.EmacspeakRules.defineRule_)("table-row","emacspeak.default","[m] children/* (pause:100)",'self::row[@role="table"]'),(0,sre.EmacspeakRules.defineRuleAlias_)("cases-cell",'self::cell[@role="table"]'),(0,sre.EmacspeakRules.defineRule_)("end-punct","emacspeak.default","[m] children/*; [p] (pause:300)","self::punctuated",'@role="endpunct"'),(0,sre.EmacspeakRules.defineRule_)("start-punct","emacspeak.default","[n] content/*[1]; [p] (pause:200); [m] children/*[position()>1]","self::punctuated",'@role="startpunct"'),(0,sre.EmacspeakRules.defineRule_)("integral-punct","emacspeak.default","[n] children/*[1] (rate:0.2); [n] children/*[3] (rate:0.2)","self::punctuated",'@role="integral"'),(0,sre.EmacspeakRules.defineRule_)("punctuated","emacspeak.default","[m] children/* (pause:100)","self::punctuated"),(0,sre.EmacspeakRules.defineRule_)("function","emacspeak.default","[n] text()","self::function"),(0,sre.EmacspeakRules.defineRule_)("appl","emacspeak.default","[n] children/*[1]; [n] content/*[1]; [n] children/*[2]","self::appl"),(0,sre.EmacspeakRules.defineRule_)("sum-only","emacspeak.default",'[n] children/*[1]; [t] "from"; [n] children/*[2]; [t] "to";[n] children/*[3]',"self::limboth",'@role="sum" or @role="integral"'),(0,sre.EmacspeakRules.defineRule_)("limboth","emacspeak.default",'[n] children/*[1]; [p] (pause 100); [t] "over"; [n] children/*[2];[t] "under"; [n] children/*[3]; [p] (pause 250);',"self::limboth"),(0,sre.EmacspeakRules.defineRule_)("limlower","emacspeak.default",'[n] children/*[1]; [t] "over"; [n] children/*[2];',"self::limlower"),(0,sre.EmacspeakRules.defineRule_)("limupper","emacspeak.default",'[n] children/*[1]; [t] "under"; [n] children/*[2];',"self::limupper"),(0,sre.EmacspeakRules.defineRule_)("largeop","emacspeak.default","[n] text()","self::largeop"),(0,sre.EmacspeakRules.defineRule_)("bigop","emacspeak.default",'[n] children/*[1]; [p] (pause 100); [t] "over"; [n] children/*[2];[p] (pause 250);',"self::bigop"),(0,sre.EmacspeakRules.defineRule_)("integral","emacspeak.default","[n] children/*[1]; [p] (pause 100); [n] children/*[2];[p] (pause 200); [n] children/*[3] (rate:0.35);","self::integral"),(0,sre.EmacspeakRules.defineRule_)("sqrt","emacspeak.default",'[t] "Square root of"; [n] children/*[1] (rate:0.35); [p] (pause:400)',"self::sqrt"),(0,sre.EmacspeakRules.defineRule_)("square","emacspeak.default",'[n] children/*[1]; [t] "squared" (pitch:0.35); [p] (pause:200)',"self::superscript","children/*[2][text()=2]",'name(./children/*[1])!="text"'),(0,sre.EmacspeakRules.defineRule_)("cube","emacspeak.default",'[n] children/*[1]; [t] "cubed" (pitch:0.35); [p] (pause:200)',"self::superscript","children/*[2][text()=3]",'name(./children/*[1])!="text"'),(0,sre.EmacspeakRules.defineRule_)("root","emacspeak.default",'[t] "root of order"; [n] children/*[1];[t] "over"; [n] children/*[1] (rate:0.35); [p] (pause:400)',"self::root"),(0,sre.EmacspeakRules.defineRule_)("text-no-mult","emacspeak.default","[n] children/*[1]; [p] (pause:200); [n] children/*[2]","self::infixop","children/text"),(0,sre.EmacspeakRules.defineRule_)("text","emacspeak.default","[n] text(); [p] (pause:200)","self::text"),(0,sre.EmacspeakRules.defineRule_)("unit","emacspeak.default","[t] text() (annotation:unit, preprocess)","self::identifier",'@role="unit"'),(0,sre.EmacspeakRules.defineRule_)("unit-square","emacspeak.default",'[t] "square"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=2]",'name(children/*[1])="identifier"'),(0,sre.EmacspeakRules.defineRule_)("unit-cubic","emacspeak.default",'[t] "cubic"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=3]",'name(children/*[1])="identifier"'),(0,sre.EmacspeakRules.defineRule_)("reciprocal","emacspeak.default",'[t] "reciprocal"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'count(preceding-sibling::*)=0 or preceding-sibling::*[@role!="unit"]'),(0,sre.EmacspeakRules.defineRule_)("reciprocal","emacspeak.default",'[t] "per"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'preceding-sibling::*[@role="unit"]'),(0,sre.EmacspeakRules.defineRule_)("unit-combine","emacspeak.default","[m] children/*","self::infixop",'@role="unit"'),(0,sre.EmacspeakRules.defineRule_)("unit-divide","emacspeak.default",'[n] children/*[1] (pitch:0.3); [t] "per"; [n] children/*[2] (pitch:-0.3)',"self::fraction",'@role="unit"')},sre.EmacspeakRules.getInstance().initializer=[sre.EmacspeakRules.initCustomFunctions_,sre.EmacspeakRules.initSemanticRules_],sre.MathmlStore=function(){sre.MathStore.call(this)},goog.inherits(sre.MathmlStore,sre.MathStore),goog.addSingletonGetter(sre.MathmlStore),sre.MathmlStore.prototype.defineMathmlRule=function(e,t,r){this.defineRule(e,t,r,"self::mathml:"+e)},sre.MathmlStore.prototype.defineDefaultMathmlRule=function(e,t){this.defineRule(e,"default.default",t,"self::mathml:"+e)},sre.MathmlStoreRules=function(){sre.MathmlStore.call(this)},goog.inherits(sre.MathmlStoreRules,sre.MathmlStore),goog.addSingletonGetter(sre.MathmlStoreRules),sre.MathmlStoreRules.mathStore=sre.MathmlStoreRules.getInstance(),sre.MathmlStoreRules.defineDefaultMathmlRule_=goog.bind(sre.MathmlStoreRules.mathStore.defineDefaultMathmlRule,sre.MathmlStoreRules.mathStore),sre.MathmlStoreRules.defineRule_=goog.bind(sre.MathmlStoreRules.mathStore.defineRule,sre.MathmlStoreRules.mathStore),sre.MathmlStoreRules.defineRuleAlias_=goog.bind(sre.MathmlStoreRules.mathStore.defineRuleAlias,sre.MathmlStoreRules.mathStore),sre.MathmlStoreRules.addContextFunction_=goog.bind(sre.MathmlStoreRules.mathStore.contextFunctions.add,sre.MathmlStoreRules.mathStore.contextFunctions),sre.MathmlStoreRules.addCustomQuery_=goog.bind(sre.MathmlStoreRules.mathStore.customQueries.add,sre.MathmlStoreRules.mathStore.customQueries),sre.MathmlStoreRules.initCustomFunctions_=function(){(0,sre.MathmlStoreRules.addContextFunction_)("CTXFnodeCounter",sre.StoreUtil.nodeCounter),(0,sre.MathmlStoreRules.addContextFunction_)("CTXFmfSeparators",sre.MathmlStoreUtil.mfencedSeparators),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFextender",sre.MathmlStoreUtil.retrieveMathjaxExtender),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFmathmlmunder",sre.MathmlStoreUtil.checkMathjaxMunder),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFmathmlmover",sre.MathmlStoreUtil.checkMathjaxMover),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFmathmlmsub",sre.MathmlStoreUtil.checkMathjaxMsub),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFmathmlmsup",sre.MathmlStoreUtil.checkMathjaxMsup),(0,sre.MathmlStoreRules.addCustomQuery_)("CQFlookupleaf",sre.MathmlStoreUtil.retrieveMathjaxLeaf)},sre.MathmlStoreRules.initDefaultRules_=function(){(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("math","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("semantics","[n] ./*[1]"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mspace","[p] (pause:250)"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mstyle","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mpadded","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("merror","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mphantom","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mtext","[t] text(); [p] (pause:200)"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mi","[n] text()"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mo","[n] text() (rate:-0.1)"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mn","[n] text()"),(0,sre.MathmlStoreRules.defineRule_)("mtext-variant","default.default",'[t] "begin"; [t] @mathvariant (pause:150);[t] text() (pause:150); [t] "end"; [t] @mathvariant (pause:200)',"self::mathml:mtext","@mathvariant",'@mathvariant!="normal"'),(0,sre.MathmlStoreRules.defineRule_)("mi-variant","default.default","[t] @mathvariant; [n] text()","self::mathml:mi","@mathvariant",'@mathvariant!="normal"'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mi-variant","self::mathml:mn","@mathvariant",'@mathvariant!="normal"'),(0,sre.MathmlStoreRules.defineRule_)("mo-variant","default.default","[t] @mathvariant; [n] text() (rate:-0.1)","self::mathml:mo","@mathvariant",'@mathvariant!="normal"'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("ms",'[t] "string" (pitch:0.5, rate:0.5); [t] text()'),(0,sre.MathmlStoreRules.defineRule_)("unit","default.default",'[t] text() (grammar:annotation="unit":translate)',"self::mathml:mi",'@class="MathML-Unit"'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("msup",'[n] ./*[1]; [t] "super";[n] ./*[2] (pitch:0.35); [p] (pause:300)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("msubsup",'[n] ./*[1]; [t] "sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:200);[t] "super"; [n] ./*[3] (pitch:0.35); [p] (pause:300)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("msub",'[n] ./*[1]; [t] "sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:300)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mover",'[n] ./*[2] (pitch:0.35); [p] (pause:200); [t] "over"; [n] ./*[1]; [p] (pause:400)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("munder",'[n] ./*[2] (pitch:-0.35); [t] "under"; [n] ./*[1]; [p] (pause:400)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("munderover",'[n] ./*[2] (pitch:-0.35); [t] "under and"; [n] ./*[3] (pitch:0.35); [t] "over"; [n] ./*[1]; [p] (pause:400)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mrow","[m] ./*"),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("msqrt",'[t] "Square root of"; [m] ./* (rate:0.2); [p] (pause:400)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mroot",'[t] "root of order"; [n] ./*[2]; [t] "of";[n] ./*[1] (rate:0.2); [p] (pause:400)'),(0,sre.MathmlStoreRules.defineDefaultMathmlRule_)("mfrac",' [p] (pause:400); [n] ./*[1] (pitch:0.3); [t] "divided by"; [n] ./*[2] (pitch:-0.3); [p] (pause:400)'),(0,sre.MathmlStoreRules.defineRule_)("mfrac","default.short",'[p] (pause:200); [t] "start frac";[n] ./*[1] (pitch:0.3); [t] "over"; [n] ./*[2] (pitch:-0.3); [p] (pause:400); [t] "end frac"',"self::mathml:mfrac"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-single","default.default","[n] @open; [m] ./* (separator:@separators); [n] @close","self::mathml:mfenced","@open","@close","string-length(string(@separators))=1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-single","default.default",'[t] "(" (grammar:translate); [m] ./* (separator:@separators); [n] @close',"self::mathml:mfenced","not(@open)","@close","string-length(string(@separators))=1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-single","default.default",'[t] "(" (grammar:translate); [m] ./* (separator:@separators); [t] ")" (grammar:translate)',"self::mathml:mfenced","not(@open)","not(@close)","string-length(string(@separators))=1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-single","default.default",'[n] @open; [m] ./* (separator:@separators); [t] ")" (grammar:translate)',"self::mathml:mfenced","@open","not(@close)","string-length(string(@separators))=1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-omit","default.default","[n] @open; [m] ./*; [n] @close","self::mathml:mfenced","@separators","@open","@close",'string(@separators)="" or string(@separators)=" "'),(0,sre.MathmlStoreRules.defineRule_)("mfenced-omit","default.default",'[t] "(" (grammar:translate); [m] ./*; [n] @close',"self::mathml:mfenced","@separators","not(@open)","@close",'string(@separators)="" or string(@separators)=" "'),(0,sre.MathmlStoreRules.defineRule_)("mfenced-omit","default.default",'[n] @open; [m] ./*; [t] ")" (grammar:translate)',"self::mathml:mfenced","@separators","@open","not(@close)",'string(@separators)="" or string(@separators)=" "'),(0,sre.MathmlStoreRules.defineRule_)("mfenced-omit","default.default",'[t] "(" (grammar:translate); [m] ./*; [t] ")" (grammar:translate)',"self::mathml:mfenced","@separators","not(@open)","not(@close)",'string(@separators)="" or string(@separators)=" "'),(0,sre.MathmlStoreRules.defineRule_)("mfenced-comma","default.default",'[n] @open; [m] ./* (separator:"comma"); [n] @close',"self::mathml:mfenced","@open","@close","not(@separators)"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-comma","default.default",'[t] "(" (grammar:translate); [m] ./* (separator:"comma"); [n] @close',"self::mathml:mfenced","not(@open)","@close","not(@separators)"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-comma","default.default",'[n] @open; [m] ./* (separator:"comma"); [t] ")" (grammar:translate)',"self::mathml:mfenced","@open","not(@close)","not(@separators)"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-comma","default.default",'[t] "(" (grammar:translate); [m] ./* (separator:"comma"); [t] ")" (grammar:translate)',"self::mathml:mfenced","not(@open)","not(@close)","not(@separators)"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-multi","default.default","[n] @open; [m] ./* (sepFunc:CTXFmfSeparators, separator:@separators); [n] @close","self::mathml:mfenced","@open","@close","string-length(string(@separators))>1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-multi","default.default",'[t] "(" (grammar:translate); [m] ./* (sepFunc:CTXFmfSeparators, separator:@separators); [n] @close',"self::mathml:mfenced","not(@open)","@close","string-length(string(@separators))>1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-multi","default.default",'[n] @open; [m] ./* (sepFunc:CTXFmfSeparators, separator:@separators); [t] ")" (grammar:translate)',"self::mathml:mfenced","@open","not(@close)","string-length(string(@separators))>1"),(0,sre.MathmlStoreRules.defineRule_)("mfenced-multi","default.default",'[t] "(" (grammar:translate); [m] ./* (sepFunc:CTXFmfSeparators, separator:@separators); [t] ")" (grammar:translate)',"self::mathml:mfenced","not(@open)","not(@close)","string-length(string(@separators))>1"),(0,sre.MathmlStoreRules.defineRule_)("mtable","default.default",'[t] "matrix"; [m] ./* (ctxtFunc:CTXFnodeCounter,context:"row",pause:100)',"self::mathml:mtable"),(0,sre.MathmlStoreRules.defineRule_)("mtr","default.default",'[m] ./* (ctxtFunc:CTXFnodeCounter,context:"column",pause:100)',"self::mathml:mtr"),(0,sre.MathmlStoreRules.defineRule_)("mtd","default.default","[m] ./*","self::mathml:mtd"),(0,sre.MathmlStoreRules.defineRule_)("mtable","default.superbrief",'[t] count(child::mathml:mtr);  [t] "by";[t] count(child::mathml:mtr[1]/mathml:mtd); [t] "matrix";',"self::mathml:mtable"),(0,sre.MathmlStoreRules.defineRule_)("mtable","default.short",'[t] "matrix"; [m] ./*',"self::mathml:mtable"),(0,sre.MathmlStoreRules.defineRule_)("mtr","default.short","[m] ./*","self::mathml:mtr"),(0,sre.MathmlStoreRules.defineRule_)("mtd","default.short",'[t] "Element"; [t] count(./preceding-sibling::mathml:mtd)+1;[t] count(./parent::mathml:mtr/preceding-sibling::mathml:mtr)+1;[p] (pause:500); [m] ./*',"self::mathml:mtd"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-4","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:200);[t] "right sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:200);[t] "right super"; [n] ./*[3] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-3-1","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:200);[t] "right super"; [n] ./*[3] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts","./mathml:none=./*[2]","./mathml:mprescripts=./*[4]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-3-2","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:200);[t] "right sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:200);',"self::mathml:mmultiscripts","./mathml:none=./*[3]","./mathml:mprescripts=./*[4]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-3-3","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:200);[t] "right sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:200);[t] "right super"; [n] ./*[3] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts","./mathml:none=./*[5]","./mathml:mprescripts=./*[4]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-3-4","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);[t] "right sub"; [n] ./*[2] (pitch:-0.35); [p] (pause:200);[t] "right super"; [n] ./*[3] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts","./mathml:none=./*[6]","./mathml:mprescripts=./*[4]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-2-1","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts","./mathml:none=./*[2]","./mathml:none=./*[3]","./mathml:mprescripts=./*[4]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-1-1","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left super"; [n] ./*[6] (pitch:0.35); [p] (pause:300);',"self::mathml:mmultiscripts","./mathml:none=./*[2]","./mathml:none=./*[3]","./mathml:mprescripts=./*[4]","./mathml:none=./*[5]"),(0,sre.MathmlStoreRules.defineRule_)("mmultiscripts-1-2","default.default",'[n] ./*[1]; [p] (pause:200);[t] "left sub"; [n] ./*[5] (pitch:-0.35); [p] (pause:200);',"self::mathml:mmultiscripts","./mathml:none=./*[2]","./mathml:none=./*[3]","./mathml:mprescripts=./*[4]","./mathml:none=./*[6]")},sre.MathmlStoreRules.initMathjaxRules_=function(){(0,sre.MathmlStoreRules.defineRule_)("mj-math","default.default","[n] ./*[1]/*[1]/*[1]",'self::span[@class="math"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-leaf","default.default","[n] CQFlookupleaf",'self::span[@class="mi"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-leaf",'self::span[@class="mo"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-leaf",'self::span[@class="mn"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-leaf",'self::span[@class="mtext"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-mo-ext","default.default","[n] CQFextender",'self::span[@class="mo"]',"./*[1]/*[1]/text()","./*[1]/*[2]/text()"),(0,sre.MathmlStoreRules.defineRule_)("mj-texatom","default.default","[n] ./*[1]",'self::span[@class="texatom"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-msubsup","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "sub"; [n] ./*[1]/*[3]/*[1] (pitch:-0.35);[p] (pause:200); [t] "super"; [n] ./*[1]/*[2]/*[1] (pitch:0.35);[p] (pause:300)','self::span[@class="msubsup"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-msub","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "sub";[n] ./*[1]/*[2]/*[1] (pitch:-0.35); [p] (pause:300)','self::span[@class="msub"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-msup","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "super";[n] ./*[1]/*[2]/*[1] (pitch:0.35); [p] (pause:300)','self::span[@class="msup"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-munderover","default.default",'[n] ./*[1]/*[2]/*[1] (pitch:0.35); [t] "under and";[n] ./*[1]/*[3]/*[1] (pitch:-0.35); [t] "over";[n] ./*[1]/*[1]/*[1]; [p] (pause:400)','self::span[@class="munderover"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-munder","default.default",'[n] ./*[1]/*[2]/*[1] (pitch:0.35); [t] "under";[n] ./*[1]/*[1]/*[1]; [p] (pause:400)','self::span[@class="munder"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-mover","default.default",'[n] ./*[1]/*[2]/*[1] (pitch:0.35); [t] "over";[n] ./*[1]/*[1]/*[1]; [p] (pause:400)','self::span[@class="mover"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-mfrac","default.default",'[p] (pause:250); [n] ./*[1]/*[1]/*[1] (pitch:0.3); [p] (pause:250); [t] "divided by"; [n] ./*[1]/*[2]/*[1] (pitch:-0.3);[p] (pause:400)','self::span[@class="mfrac"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-msqrt","default.default",'[t] "Square root of";[n] ./*[1]/*[1]/*[1] (rate:0.2); [p] (pause:400)','self::span[@class="msqrt"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-mroot","default.default",'[t] "root of order"; [n] ./*[1]/*[4]/*[1]; [t] "of";[n] ./*[1]/*[1]/*[1] (rate:0.2); [p] (pause:400)','self::span[@class="mroot"]'),(0,sre.MathmlStoreRules.defineRule_)("mj-mfenced","default.default",'[t] "opening"; [n] ./*[1]; [m] ./*[position()>1 and position()<last()]; [t] "closing"; [n] ./*[last()]','self::span[@class="mfenced"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-leaf",'self::span[@class="mtable"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-leaf",'self::span[@class="mmultiscripts"]')},sre.MathmlStoreRules.initAliases_=function(){(0,sre.MathmlStoreRules.defineRuleAlias_)("mspace",'self::span[@class="mspace"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mstyle",'self::span[@class="mstyle"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mpadded",'self::span[@class="mpadded"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("merror",'self::span[@class="merror"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mphantom",'self::span[@class="mphantom"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("ms",'self::span[@class="ms"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mrow",'self::span[@class="mrow"]'),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-msub",'self::span[@class="msubsup"]',"CQFmathmlmsub"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-msup",'self::span[@class="msubsup"]',"CQFmathmlmsup"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-munder",'self::span[@class="munderover"]',"CQFmathmlmunder"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-mover",'self::span[@class="munderover"]',"CQFmathmlmover")},sre.MathmlStoreRules.initSpecializationRules_=function(){(0,sre.MathmlStoreRules.defineRule_)("square","default.default",'[n] ./*[1]; [t] "square" (pitch:0.35); [p] (pause:300)',"self::mathml:msup","./*[2][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("square","self::mathml:msup","./mathml:mrow=./*[2]","count(./*[2]/*)=1","./*[2]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRule_)("cube","default.default",'[n] ./*[1]; [t] "cube" (pitch:0.35); [p] (pause:300)',"self::mathml:msup","./*[2][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("cube","self::mathml:msup","./mathml:mrow=./*[2]","count(./*[2]/*)=1","./*[2]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRule_)("square-sub","default.default",'[n] ./*[1]; [t] "sub"; [n] ./*[2] (pitch:-0.35);[p] (pause:300); [t] "square" (pitch:0.35); [p] (pause:400)',"self::mathml:msubsup","./*[3][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("square-sub","self::mathml:msubsup","./mathml:mrow=./*[3]","count(./*[3]/*)=1","./*[3]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRule_)("cube-sub","default.default",'[n] ./*[1]; [t] "sub"; [n] ./*[2] (pitch:-0.35);[p] (pause:300); [t] "cube" (pitch:0.35); [p] (pause:400)',"self::mathml:msubsup","./*[3][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("cube-sub","self::mathml:msubsup","./mathml:mrow=./*[3]","count(./*[3]/*)=1","./*[3]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRule_)("mj-square","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "square" (pitch:0.35); [p] (pause:300)','self::span[@class="msup"]',"./*[1]/*[2]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-square",'self::span[@class="msup"]','./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-square",'self::span[@class="msubsup"]',"CQFmathmlmsup","./*[1]/*[2]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-square",'self::span[@class="msubsup"]',"CQFmathmlmsup",'./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRule_)("mj-cube","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "cube" (pitch:0.35); [p] (pause:300)','self::span[@class="msup"]',"./*[1]/*[2]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-cube",'self::span[@class="msup"]','./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-cube",'self::span[@class="msubsup"]',"CQFmathmlmsup","./*[1]/*[2]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-cube",'self::span[@class="msubsup"]',"CQFmathmlmsup",'./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRule_)("mj-square-sub","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "sub"; [n] ./*[1]/*[3]/*[1] (pitch:-0.35); [p] (pause:300); [t] "square" (pitch:0.35); [p] (pause:400)','self::span[@class="msubsup"]',"./*[1]/*[2]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-square-sub",'self::span[@class="msubsup"]','./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=2]"),(0,sre.MathmlStoreRules.defineRule_)("mj-cube-sub","default.default",'[n] ./*[1]/*[1]/*[1]; [t] "sub"; [n] ./*[1]/*[3]/*[1] (pitch:-0.35); [p] (pause:300); [t] "cube" (pitch:0.35); [p] (pause:400)','self::span[@class="msubsup"]',"./*[1]/*[2]/*[1][text()=3]"),(0,sre.MathmlStoreRules.defineRuleAlias_)("mj-cube-sub",'self::span[@class="msubsup"]','./*[1]/*[2]/*[1]=./*[1]/*[2]/span[@class="mrow"]',"count(./*[1]/*[2]/*[1]/*)=1","./*[1]/*[2]/*[1]/*[1][text()=3]")},sre.MathmlStoreRules.getInstance().initializer=[sre.MathmlStoreRules.initCustomFunctions_,sre.MathmlStoreRules.initDefaultRules_,sre.MathmlStoreRules.initMathjaxRules_,sre.MathmlStoreRules.initAliases_,sre.MathmlStoreRules.initSpecializationRules_],sre.MathspeakRules=function(){sre.MathStore.call(this)},goog.inherits(sre.MathspeakRules,sre.MathStore),goog.addSingletonGetter(sre.MathspeakRules),sre.MathspeakRules.mathStore=sre.MathspeakRules.getInstance(),sre.MathspeakRules.defineRule_=goog.bind(sre.MathspeakRules.mathStore.defineRule,sre.MathspeakRules.mathStore),sre.MathspeakRules.defineRuleAlias_=goog.bind(sre.MathspeakRules.mathStore.defineRulesAlias,sre.MathspeakRules.mathStore),sre.MathspeakRules.defineSpecialisedRule_=goog.bind(sre.MathspeakRules.mathStore.defineSpecialisedRule,sre.MathspeakRules.mathStore),sre.MathspeakRules.addContextFunction_=goog.bind(sre.MathspeakRules.mathStore.contextFunctions.add,sre.MathspeakRules.mathStore.contextFunctions),sre.MathspeakRules.addCustomQuery_=goog.bind(sre.MathspeakRules.mathStore.customQueries.add,sre.MathspeakRules.mathStore.customQueries),sre.MathspeakRules.addCustomString_=goog.bind(sre.MathspeakRules.mathStore.customStrings.add,sre.MathspeakRules.mathStore.customStrings),sre.MathspeakRules.initCustomFunctions_=function(){(0,sre.MathspeakRules.addCustomQuery_)("CQFspaceoutNumber",sre.MathspeakUtil.spaceoutNumber),(0,sre.MathspeakRules.addCustomQuery_)("CQFspaceoutIdentifier",sre.MathspeakUtil.spaceoutIdentifier),(0,sre.MathspeakRules.addCustomString_)("CSFspaceoutText",sre.MathspeakUtil.spaceoutText),(0,sre.MathspeakRules.addCustomString_)("CSFopenFracVerbose",sre.MathspeakUtil.openingFractionVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFcloseFracVerbose",sre.MathspeakUtil.closingFractionVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFoverFracVerbose",sre.MathspeakUtil.overFractionVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFopenFracBrief",sre.MathspeakUtil.openingFractionBrief),(0,sre.MathspeakRules.addCustomString_)("CSFcloseFracBrief",sre.MathspeakUtil.closingFractionBrief),(0,sre.MathspeakRules.addCustomString_)("CSFopenFracSbrief",sre.MathspeakUtil.openingFractionSbrief),(0,sre.MathspeakRules.addCustomString_)("CSFcloseFracSbrief",sre.MathspeakUtil.closingFractionSbrief),(0,sre.MathspeakRules.addCustomString_)("CSFoverFracSbrief",sre.MathspeakUtil.overFractionSbrief),(0,sre.MathspeakRules.addCustomString_)("CSFvulgarFraction",sre.MathspeakUtil.vulgarFraction),(0,sre.MathspeakRules.addCustomQuery_)("CQFvulgarFractionSmall",sre.MathspeakUtil.isSmallVulgarFraction),(0,sre.MathspeakRules.addCustomString_)("CSFopenRadicalVerbose",sre.MathspeakUtil.openingRadicalVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFcloseRadicalVerbose",sre.MathspeakUtil.closingRadicalVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFindexRadicalVerbose",sre.MathspeakUtil.indexRadicalVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFopenRadicalBrief",sre.MathspeakUtil.openingRadicalBrief),(0,sre.MathspeakRules.addCustomString_)("CSFcloseRadicalBrief",sre.MathspeakUtil.closingRadicalBrief),(0,sre.MathspeakRules.addCustomString_)("CSFindexRadicalBrief",sre.MathspeakUtil.indexRadicalBrief),(0,sre.MathspeakRules.addCustomString_)("CSFopenRadicalSbrief",sre.MathspeakUtil.openingRadicalSbrief),(0,sre.MathspeakRules.addCustomString_)("CSFindexRadicalSbrief",sre.MathspeakUtil.indexRadicalSbrief),(0,sre.MathspeakRules.addCustomString_)("CSFsuperscriptVerbose",sre.MathspeakUtil.superscriptVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFsuperscriptBrief",sre.MathspeakUtil.superscriptBrief),(0,sre.MathspeakRules.addCustomString_)("CSFsubscriptVerbose",sre.MathspeakUtil.subscriptVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFsubscriptBrief",sre.MathspeakUtil.subscriptBrief),(0,sre.MathspeakRules.addCustomString_)("CSFbaselineVerbose",sre.MathspeakUtil.baselineVerbose),(0,sre.MathspeakRules.addCustomString_)("CSFbaselineBrief",sre.MathspeakUtil.baselineBrief),(0,sre.MathspeakRules.addCustomString_)("CSFunderscript",sre.MathspeakUtil.nestedUnderscore),(0,sre.MathspeakRules.addCustomString_)("CSFoverscript",sre.MathspeakUtil.nestedOverscore),(0,sre.MathspeakRules.addContextFunction_)("CTXFordinalCounter",sre.MathspeakUtil.ordinalCounter),(0,sre.MathspeakRules.addContextFunction_)("CTXFcontentIterator",sre.MathmlStoreUtil.contentIterator),(0,sre.MathspeakRules.addCustomQuery_)("CQFdetIsSimple",sre.MathspeakUtil.determinantIsSimple),(0,sre.MathspeakRules.addCustomString_)("CSFRemoveParens",sre.MathspeakUtil.removeParens),(0,sre.MathspeakRules.addCustomQuery_)("CQFresetNesting",sre.MathspeakUtil.resetNestingDepth)},sre.MathspeakRules.initMathspeakRules_=function(){(0,sre.MathspeakRules.defineRule_)("stree","mathspeak.default","[n] ./*[1]","self::stree","CQFresetNesting"),(0,sre.MathspeakRules.defineRule_)("unknown","mathspeak.default","[n] text()","self::unknown"),(0,sre.MathspeakRules.defineRule_)("protected","mathspeak.default","[t] text()","self::*",'@role="protected"'),(0,sre.MathspeakRules.defineRule_)("omit-empty","mathspeak.default","[p] (pause:100)","self::empty"),(0,sre.MathspeakRules.defineRule_)("blank-empty","mathspeak.default",'[t] "Blank"',"self::empty","count(../*)=1",'name(../..)="cell" or name(../..)="line"'),(0,sre.MathspeakRules.defineRule_)("font","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"'),(0,sre.MathspeakRules.defineRule_)("font-identifier-short","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="normal"','""=translate(text(), "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ", "")','@role!="unit"'),(0,sre.MathspeakRules.defineRule_)("font-identifier","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'@font="normal"','not(contains(@grammar, "ignoreFont"))','@role!="unit"'),(0,sre.MathspeakRules.defineRule_)("omit-font","mathspeak.default","[n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="italic"'),(0,sre.MathspeakRules.defineRule_)("german-font","mathspeak.default",'[t] "German"; [n] . (grammar:ignoreFont=@font)',"self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font="fraktur"'),(0,sre.MathspeakRules.defineRule_)("german-font","mathspeak.default",'[t] "bold German"; [n] . (grammar:ignoreFont=@font)',"self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font="bold-fraktur"'),(0,sre.MathspeakRules.defineRule_)("number","mathspeak.default","[n] text()","self::number"),(0,sre.MathspeakRules.defineRule_)("mixed-number","mathspeak.default",'[n] children/*[1]; [t] "and"; [n] children/*[2]; ',"self::number",'@role="mixed"'),(0,sre.MathspeakRules.defineRule_)("number-with-chars","mathspeak.default",'[t] "Number"; [m] CQFspaceoutNumber',"self::number",'"" != translate(text(), "0123456789.,", "")','text() != translate(text(), "0123456789.,", "")'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-with-chars","mathspeak.default","mathspeak.brief",'[t] "Num"; [m] CQFspaceoutNumber'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-with-chars","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("number-as-upper-word","mathspeak.default",'[t] "UpperWord"; [t] CSFspaceoutText',"self::number","string-length(text())>1",'text()=translate(text(), "abcdefghijklmnopqrstuvwxyz", "ABCDEFGHIJKLMNOPQRSTUVWXYZ")','""=translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ","")'),(0,sre.MathspeakRules.defineRule_)("number-baseline","mathspeak.default",'[t] "Baseline"; [n] text()',"self::number",'not(contains(@grammar, "ignoreFont"))',"preceding-sibling::identifier",'preceding-sibling::*[1][@role="latinletter" or @role="greekletter" or @role="otherletter"]','parent::*/parent::infixop[@role="implicit"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-baseline","mathspeak.default","mathspeak.brief",'[t] "Base"; [n] text()'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("number-baseline-font","mathspeak.default",'[t] "Baseline"; [t] @font; [n] . (grammar:ignoreFont=@font)',"self::number","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"',"preceding-sibling::identifier",'preceding-sibling::*[@role="latinletter" or @role="greekletter" or @role="otherletter"]','parent::*/parent::infixop[@role="implicit"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-baseline-font","mathspeak.default","mathspeak.brief",'[t] "Base"; [n] text()'),(0,sre.MathspeakRules.defineSpecialisedRule_)("number-baseline-font","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("identifier","mathspeak.default","[m] CQFspaceoutIdentifier","self::identifier","string-length(text())>1",'@role!="unit"','@role!="protected"','not(@font) or @font="normal" or contains(@grammar, "ignoreFont")'),(0,sre.MathspeakRules.defineRule_)("identifier","mathspeak.default","[n] text()","self::identifier",'@role="protected"'),(0,sre.MathspeakRules.defineRule_)("negative","mathspeak.default",'[t] "negative"; [n] children/*[1]',"self::prefixop",'@role="negative"',"children/identifier"),(0,sre.MathspeakRules.defineRuleAlias_)("negative","self::prefixop",'@role="negative"',"children/number"),(0,sre.MathspeakRules.defineRuleAlias_)("negative","self::prefixop",'@role="negative"','children/fraction[@role="vulgar"]'),(0,sre.MathspeakRules.defineRule_)("negative","mathspeak.default",'[t] "minus"; [n] children/*[1]',"self::prefixop",'@role="negative"'),(0,sre.MathspeakRules.defineRule_)("prefix","mathspeak.default","[n] text(); [n] children/*[1]","self::prefixop"),(0,sre.MathspeakRules.defineRule_)("postfix","mathspeak.default","[n] children/*[1]; [n] text()","self::postfixop"),(0,sre.MathspeakRules.defineRule_)("binary-operation","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator);","self::infixop"),(0,sre.MathspeakRules.defineRule_)("implicit","mathspeak.default","[m] children/*","self::infixop",'@role="implicit"'),(0,sre.MathspeakRules.defineRuleAlias_)("implicit","self::infixop",'@role="leftsuper" or @role="leftsub" or @role="rightsuper" or @role="rightsub"'),(0,sre.MathspeakRules.defineRule_)("subtraction","mathspeak.default",'[m] children/* (separator:"minus");',"self::infixop",'@role="subtraction"'),(0,sre.MathspeakRules.defineRule_)("function-unknown","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::appl"),(0,sre.MathspeakRules.defineRule_)("function-prefix","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::appl",'children/*[1][@role="prefix function"]'),(0,sre.MathspeakRules.defineRule_)("fences-open-close","mathspeak.default","[n] content/*[1]; [n] children/*[1]; [n] content/*[2]","self::fenced",'@role="leftright"'),(0,sre.MathspeakRules.defineRule_)("fences-neutral","mathspeak.default",'[t] "StartAbsoluteValue"; [n] children/*[1]; [t] "EndAbsoluteValue"',"self::fenced",'@role="neutral"','content/*[1][text()]="|" or content/*[1][text()]="" or content/*[1][text()]=""'),(0,sre.MathspeakRules.defineSpecialisedRule_)("fences-neutral","mathspeak.default","mathspeak.sbrief",'[t] "AbsoluteValue"; [n] children/*[1]; [t] "EndAbsoluteValue"'),(0,sre.MathspeakRules.defineRule_)("fences-neutral","mathspeak.default","[n] content/*[1]; [n] children/*[1]; [n] content/*[2]","self::fenced",'@role="neutral"'),(0,sre.MathspeakRules.defineRule_)("fences-set","mathspeak.default",'[t] "StartSet"; [n] children/*[1]; [t] "EndSet"',"self::fenced",'@role="leftright"','content/*[1][text()]="{"','content/*[2][text()]="}"',"count(children/*)=1",'not(name(../..)="appl")'),(0,sre.MathspeakRules.defineSpecialisedRule_)("fences-set","mathspeak.default","mathspeak.sbrief",'[t] "Set"; [n] children/*[1]; [t] "EndSet"'),(0,sre.MathspeakRules.defineRule_)("text","mathspeak.default","[n] text()","self::text"),(0,sre.MathspeakRules.defineRule_)("factorial","mathspeak.default",'[t] "factorial"',"self::punctuation",'text()="!"','name(preceding-sibling::*[1])!="text"'),(0,sre.MathspeakRules.defineRule_)("minus","mathspeak.default",'[t] "minus"',"self::operator",'text()="-"'),(0,sre.MathspeakRules.defineRule_)("single-prime","mathspeak.default",'[t] "prime"',"self::punctuated",'@role="prime"',"count(children/*)=1"),(0,sre.MathspeakRules.defineRule_)("double-prime","mathspeak.default",'[t] "double-prime"',"self::punctuated",'@role="prime"',"count(children/*)=2"),(0,sre.MathspeakRules.defineRule_)("triple-prime","mathspeak.default",'[t] "triple-prime"',"self::punctuated",'@role="prime"',"count(children/*)=3"),(0,sre.MathspeakRules.defineRule_)("quadruple-prime","mathspeak.default",'[t] "quadruple-prime"',"self::punctuated",'@role="prime"',"count(children/*)=4"),(0,sre.MathspeakRules.defineRule_)("counted-prime","mathspeak.default",'[t] count(children/*); [t] "prime"',"self::punctuated",'@role="prime"'),(0,sre.MathspeakRules.defineRule_)("fraction","mathspeak.default","[t] CSFopenFracVerbose; [n] children/*[1]; [t] CSFoverFracVerbose; [n] children/*[2]; [t] CSFcloseFracVerbose","self::fraction"),(0,sre.MathspeakRules.defineRule_)("fraction","mathspeak.brief","[t] CSFopenFracBrief; [n] children/*[1]; [t] CSFoverFracVerbose; [n] children/*[2]; [t] CSFcloseFracBrief","self::fraction"),(0,sre.MathspeakRules.defineRule_)("fraction","mathspeak.sbrief","[t] CSFopenFracSbrief; [n] children/*[1]; [t] CSFoverFracSbrief; [n] children/*[2]; [t] CSFcloseFracSbrief","self::fraction"),(0,sre.MathspeakRules.defineRule_)("vulgar-fraction","mathspeak.default","[t] CSFvulgarFraction","self::fraction",'@role="vulgar"',"CQFvulgarFractionSmall"),(0,sre.MathspeakRules.defineSpecialisedRule_)("vulgar-fraction","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("vulgar-fraction","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("continued-fraction-outer","mathspeak.default",'[t] "ContinuedFraction"; [n] children/*[1];[t] "Over"; [n] children/*[2]',"self::fraction","not(ancestor::fraction)",'children/*[2]/descendant-or-self::*[@role="ellipsis" and not(following-sibling::*)]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("continued-fraction-outer","mathspeak.default","mathspeak.brief",'[t] "ContinuedFrac"; [n] children/*[1];[t] "Over"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("continued-fraction-outer","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("continued-fraction-inner","mathspeak.default",'[t] "StartFraction"; [n] children/*[1];[t] "Over"; [n] children/*[2]',"self::fraction","ancestor::fraction",'children/*[2]/descendant-or-self::*[@role="ellipsis" and not(following-sibling::*)]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("continued-fraction-inner","mathspeak.default","mathspeak.brief",'[t] "StartFrac"; [n] children/*[1];[t] "Over"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("continued-fraction-inner","mathspeak.brief","mathspeak.sbrief",'[t] "Frac"; [n] children/*[1];[t] "Over"; [n] children/*[2]'),(0,sre.MathspeakRules.defineRule_)("sqrt","mathspeak.default","[t] CSFopenRadicalVerbose; [n] children/*[1]; [t] CSFcloseRadicalVerbose","self::sqrt"),(0,sre.MathspeakRules.defineRule_)("sqrt","mathspeak.brief","[t] CSFopenRadicalBrief; [n] children/*[1]; [t] CSFcloseRadicalBrief","self::sqrt"),(0,sre.MathspeakRules.defineRule_)("sqrt","mathspeak.sbrief","[t] CSFopenRadicalSbrief; [n] children/*[1]; [t] CSFcloseRadicalBrief","self::sqrt"),(0,sre.MathspeakRules.defineRule_)("root","mathspeak.default","[t] CSFindexRadicalVerbose; [n] children/*[1];[t] CSFopenRadicalVerbose; [n] children/*[2]; [t] CSFcloseRadicalVerbose","self::root"),(0,sre.MathspeakRules.defineRule_)("root","mathspeak.brief","[t] CSFindexRadicalBrief; [n] children/*[1];[t] CSFopenRadicalBrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root"),(0,sre.MathspeakRules.defineRule_)("root","mathspeak.sbrief","[t] CSFindexRadicalSbrief; [n] children/*[1];[t] CSFopenRadicalSbrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root"),(0,sre.MathspeakRules.defineRule_)("limboth","mathspeak.default","[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];[t] CSFoverscript; [n] children/*[3]","self::limboth",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRule_)("limlower","mathspeak.default","[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];","self::limlower",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRule_)("limupper","mathspeak.default","[n] children/*[1]; [t] CSFoverscript; [n] children/*[2];","self::limupper",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRuleAlias_)("limlower","self::underscore",'@role="limit function"','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRuleAlias_)("limlower","self::underscore",'children/*[2][@role!="underaccent"]','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRuleAlias_)("limupper","self::overscore",'children/*[2][@role!="overaccent"]','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakRules.defineRule_)("limboth-end","mathspeak.default",'[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];[t] CSFoverscript; [n] children/*[3]; [t] "Endscripts"',"self::limboth"),(0,sre.MathspeakRules.defineRule_)("limlower-end","mathspeak.default",'[n] children/*[1]; [t] CSFunderscript; [n] children/*[2]; [t] "Endscripts"',"self::limlower"),(0,sre.MathspeakRules.defineRule_)("limupper-end","mathspeak.default",'[n] children/*[1]; [t] CSFoverscript; [n] children/*[2]; [t] "Endscripts"',"self::limupper"),(0,sre.MathspeakRules.defineRuleAlias_)("limlower-end","self::underscore",'@role="limit function"'),(0,sre.MathspeakRules.defineRuleAlias_)("limlower-end","self::underscore"),(0,sre.MathspeakRules.defineRuleAlias_)("limupper-end","self::overscore"),(0,sre.MathspeakRules.defineRule_)("integral","mathspeak.default","[n] children/*[1]; [n] children/*[2]; [n] children/*[3];","self::integral"),(0,sre.MathspeakRules.defineRule_)("integral","mathspeak.default",'[n] children/*[1]; [t] "Subscript"; [n] children/*[2];[t] "Superscript"; [n] children/*[3]; [t] "Baseline";',"self::limboth",'@role="integral"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("integral","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "Sub"; [n] children/*[2];[t] "Sup"; [n] children/*[3]; [t] "Base";'),(0,sre.MathspeakRules.defineSpecialisedRule_)("integral","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("bigop","mathspeak.default","[n] children/*[1]; [n] children/*[2];","self::bigop"),(0,sre.MathspeakRules.defineRule_)("relseq","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq"),(0,sre.MathspeakRules.defineRule_)("equality","mathspeak.default","[n] children/*[1]; [n] content/*[1]; [n] children/*[2]","self::relseq",'@role="equality"',"count(./children/*)=2"),(0,sre.MathspeakRules.defineRule_)("multi-equality","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq",'@role="equality"',"count(./children/*)>2"),(0,sre.MathspeakRules.defineRule_)("multrel","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::multirel"),(0,sre.MathspeakRules.defineRule_)("subscript","mathspeak.default","[n] children/*[1]; [t] CSFsubscriptVerbose; [n] children/*[2]","self::subscript"),(0,sre.MathspeakRules.defineRule_)("subscript","mathspeak.brief","[n] children/*[1]; [t] CSFsubscriptBrief; [n] children/*[2]","self::subscript"),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("subscript-simple","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::subscript",'name(./children/*[1])="identifier"','name(./children/*[2])="number"','./children/*[2][@role!="mixed"]','./children/*[2][@role!="othernumber"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-simple","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-simple","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("subscript-baseline","mathspeak.default","[n] children/*[1]; [t] CSFsubscriptVerbose; [n] children/*[2]; [t] CSFbaselineVerbose","self::subscript","following-sibling::*",'not(name(following-sibling::subscript/children/*[1])="empty" or (name(following-sibling::infixop[@role="implicit"]/children/*[1])="subscript" and name(following-sibling::*/children/*[1]/children/*[1])="empty")) and @role!="subsup"','not(following-sibling::*[@role="rightsuper" or @role="rightsub" or @role="leftsub" or @role="leftsub"])'),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsubscriptBrief; [n] children/*[2]; [t] CSFbaselineBrief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","ancestor::fenced|ancestor::root|ancestor::sqrt|ancestor::punctuated|ancestor::fraction",'not(ancestor::punctuated[@role="leftsuper" or @role="rightsub" or @role="rightsuper" or @role="rightsub"])'),(0,sre.MathspeakRules.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","ancestor::relseq|ancestor::multirel",sre.MathspeakUtil.generateBaselineConstraint()),(0,sre.MathspeakRules.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","@embellished"),(0,sre.MathspeakRules.defineRule_)("subscript-empty-sup","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::subscript",'name(children/*[2])="infixop"','name(children/*[2][@role="implicit"]/children/*[1])="superscript"','name(children/*[2]/children/*[1]/children/*[1])="empty"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-empty-sup","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("subscript-empty-sup","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("subscript-empty-sup","self::subscript",'name(children/*[2])="superscript"','name(children/*[2]/children/*[1])="empty"'),(0,sre.MathspeakRules.defineRule_)("superscript","mathspeak.default","[n] children/*[1]; [t] CSFsuperscriptVerbose; [n] children/*[2]","self::superscript"),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsuperscriptBrief; [n] children/*[2]"),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("superscript-baseline","mathspeak.default","[n] children/*[1]; [t] CSFsuperscriptVerbose; [n] children/*[2];[t] CSFbaselineVerbose","self::superscript","following-sibling::*",'not(name(following-sibling::superscript/children/*[1])="empty" or (name(following-sibling::infixop[@role="implicit"]/children/*[1])="superscript" and name(following-sibling::*/children/*[1]/children/*[1])="empty")) and not(following-sibling::*[@role="rightsuper" or @role="rightsub" or @role="leftsub" or @role="leftsub"])'),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsuperscriptBrief; [n] children/*[2];[t] CSFbaselineBrief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::punctuated",'ancestor::*/following-sibling::* and not(ancestor::punctuated[@role="leftsuper" or @role="rightsub" or @role="rightsuper" or @role="rightsub"])'),(0,sre.MathspeakRules.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::fraction|ancestor::fenced|ancestor::root|ancestor::sqrt"),(0,sre.MathspeakRules.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::relseq|ancestor::multirel","not(@embellished)",sre.MathspeakUtil.generateBaselineConstraint()),(0,sre.MathspeakRules.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","@embellished",'not(children/*[2][@role="prime"])'),(0,sre.MathspeakRules.defineRule_)("superscript-empty-sub","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::superscript",'name(children/*[2])="infixop"','name(children/*[2][@role="implicit"]/children/*[1])="subscript"','name(children/*[2]/children/*[1]/children/*[1])="empty"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript-empty-sub","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("superscript-empty-sub","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("superscript-empty-sub","self::superscript",'name(children/*[2])="subscript"','name(children/*[2]/children/*[1])="empty"'),(0,sre.MathspeakRules.defineRule_)("square","mathspeak.default",'[n] children/*[1]; [t] "squared"',"self::superscript","children/*[2]","children/*[2][text()=2]",'name(children/*[1])!="text" or not(name(children/*[1])="text" and (name(../../../punctuated[@role="text"]/..)="stree" or name(..)="stree"))','name(children/*[1])!="subscript" or (name(children/*[1])="subscript" and name(children/*[1]/children/*[1])="identifier" and name(children/*[1]/children/*[2])="number" and children/*[1]/children/*[2][@role!="mixed"] and children/*[1]/children/*[2][@role!="othernumber"])',"not(@embellished)"),(0,sre.MathspeakRules.defineSpecialisedRule_)("square","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("square","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("cube","mathspeak.default",'[n] children/*[1]; [t] "cubed"',"self::superscript","children/*[2]","children/*[2][text()=3]",'name(children/*[1])!="text" or not(name(children/*[1])="text" and (name(../../../punctuated[@role="text"]/..)="stree" or name(..)="stree"))','name(children/*[1])!="subscript" or (name(children/*[1])="subscript" and name(children/*[1]/children/*[1])="identifier" and name(children/*[1]/children/*[2])="number" and children/*[1]/children/*[2][@role!="mixed"] and children/*[1]/children/*[2][@role!="othernumber"])',"not(@embellished)"),(0,sre.MathspeakRules.defineSpecialisedRule_)("cube","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("cube","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("prime","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::superscript","children/*[2]",'children/*[2][@role="prime"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("prime-subscript","mathspeak.default","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptVerbose; [n] children/*[1]/children/*[2]","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"not(following-sibling::*)"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript","mathspeak.default","mathspeak.brief","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptBrief; [n] children/*[1]/children/*[2]"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("prime-subscript-baseline","mathspeak.default","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptVerbose; [n] children/*[1]/children/*[2]; [t] CSFbaselineVerbose","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"following-sibling::*"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptBrief; [n] children/*[1]/children/*[2]; [t] CSFbaselineBrief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("prime-subscript-baseline","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"not(following-sibling::*)","@embellished"),(0,sre.MathspeakRules.defineRule_)("prime-subscript-simple","mathspeak.default","[n] children/*[1]/children/*[1]; [n] children/*[2];[n] children/*[1]/children/*[2]","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"','name(children/*[1]/children/*[1])="identifier"','name(children/*[1]/children/*[2])="number"','children/*[1]/children/*[2][@role!="mixed"]','children/*[1]/children/*[2][@role!="othernumber"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript-simple","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("prime-subscript-simple","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("overscore","mathspeak.default",'[t] "ModifyingAbove"; [n] children/*[1]; [t] "With"; [n] children/*[2]',"self::overscore",'children/*[2][@role="overaccent"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overscore","mathspeak.default","mathspeak.brief",'[t] "ModAbove"; [n] children/*[1]; [t] "With"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("double-overscore","mathspeak.default",'[t] "ModifyingAbove Above"; [n] children/*[1]; [t] "With"; [n] children/*[2]',"self::overscore",'children/*[2][@role="overaccent"]','name(children/*[1])="overscore"','children/*[1]/children/*[2][@role="overaccent"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("double-overscore","mathspeak.default","mathspeak.brief",'[t] "ModAbove Above"; [n] children/*[1]; [t] "With"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("double-overscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("underscore","mathspeak.default",'[t] "ModifyingBelow"; [n] children/*[1]; [t] "With"; [n] children/*[2]',"self::underscore",'children/*[2][@role="underaccent"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("underscore","mathspeak.default","mathspeak.brief",'[t] "ModBelow"; [n] children/*[1]; [t] "With"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("underscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("double-underscore","mathspeak.default",'[t] "ModifyingBelow Below"; [n] children/*[1]; [t] "With"; [n] children/*[2]',"self::underscore",'children/*[2][@role="underaccent"]','name(children/*[1])="underscore"','children/*[1]/children/*[2][@role="underaccent"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("double-underscore","mathspeak.default","mathspeak.brief",'[t] "ModBelow Below"; [n] children/*[1]; [t] "With"; [n] children/*[2]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("double-underscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("overbar","mathspeak.default",'[n] children/*[1]; [t] "overbar"',"self::overscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="overaccent"]','children/*[2][text()="" or text()="" or text()="" or text()="_" or text()=""]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overbar","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "overBar"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overbar","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("underbar","mathspeak.default",'[n] children/*[1]; [t] "underbar"',"self::underscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="underaccent"]','children/*[2][text()="" or text()="" or text()="" or text()="_" or text()=""]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("underbar","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "underBar"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("underbar","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("overtilde","mathspeak.default",'[n] children/*[1]; [t] "overTilde"',"self::overscore",'children/*[2][@role="overaccent"]','@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][text()="~" or text()="" or text()="" or text()=""]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overtilde","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "overtilde"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("overtilde","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("undertilde","mathspeak.default",'[n] children/*[1]; [t] "underTilde"',"self::underscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="underaccent"]','children/*[2][text()="~" or text()="" or text()="" or text()=""]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("undertilde","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "undertilde"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("undertilde","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("matrix-fence","mathspeak.default","[n] children/*[1];","self::fenced","count(children/*)=1",'name(children/*[1])="matrix"'),(0,sre.MathspeakRules.defineRule_)("matrix","mathspeak.default",'[t] "Start"; [t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Matrix"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndMatrix"',"self::matrix"),(0,sre.MathspeakRules.defineRule_)("matrix","mathspeak.sbrief",'[t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Matrix"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndMatrix"',"self::matrix"),(0,sre.MathspeakRules.defineRuleAlias_)("matrix","self::vector"),(0,sre.MathspeakRules.defineRule_)("matrix-row","mathspeak.default",'[m] children/* (ctxtFunc:CTXFordinalCounter,context:"Column");[p] (pause: 200)',"self::row"),(0,sre.MathspeakRules.defineRule_)("row-with-label","mathspeak.default",'[t] "with Label"; [n] content/*[1]; [t] "EndLabel"(pause: 200); [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Column")',"self::row","content"),(0,sre.MathspeakRules.defineRule_)("row-with-label","mathspeak.brief",'[t] "Label"; [n] content/*[1]; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Column")',"self::row","content"),(0,sre.MathspeakRules.defineSpecialisedRule_)("row-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("row-with-text-label","mathspeak.sbrief",'[t] "Label"; [t] CSFRemoveParens;[m] children/* (ctxtFunc:CTXFordinalCounter,context:"Column")',"self::row","content",'name(content/cell/children/*[1])="text"'),(0,sre.MathspeakRules.defineRule_)("empty-row","mathspeak.default",'[t] "Blank"',"self::row","count(children/*)=0"),(0,sre.MathspeakRules.defineRule_)("matrix-cell","mathspeak.default","[n] children/*[1]; [p] (pause: 300)","self::cell"),(0,sre.MathspeakRules.defineRule_)("empty-cell","mathspeak.default",'[t] "Blank"; [p] (pause: 300)',"self::cell","count(children/*)=0"),(0,sre.MathspeakRules.defineRule_)("determinant","mathspeak.default",'[t] "Start"; [t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Determinant"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndDeterminant"',"self::matrix",'@role="determinant"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("determinant","mathspeak.default","mathspeak.sbrief",'[t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Determinant"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndDeterminant"'),(0,sre.MathspeakRules.defineRule_)("determinant-simple","mathspeak.default",'[t] "Start"; [t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Determinant"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row",grammar:simpleDet); [t] "EndDeterminant"',"self::matrix",'@role="determinant"',"CQFdetIsSimple"),(0,sre.MathspeakRules.defineSpecialisedRule_)("determinant-simple","mathspeak.default","mathspeak.sbrief",'[t] count(children/*);  [t] "By";[t] count(children/*[1]/children/*); [t] "Determinant"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row",grammar:simpleDet); [t] "EndDeterminant"'),(0,sre.MathspeakRules.defineRule_)("row-simple","mathspeak.default","[m] children/*;","self::row",'@role="determinant"','contains(@grammar, "simpleDet")'),(0,sre.MathspeakRules.defineRule_)("layout","mathspeak.default",'[t] "StartLayout"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndLayout"',"self::table"),(0,sre.MathspeakRules.defineRule_)("layout","mathspeak.sbrief",'[t] "Layout"; [m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndLayout"',"self::table"),(0,sre.MathspeakRules.defineRule_)("binomial","mathspeak.default",'[t] "StartBinomialOrMatrix"; [n] children/*[1]/children/*[1]; [t] "Choose"; [n] children/*[2]/children/*[1];  [t] "EndBinomialOrMatrix"',"self::vector",'@role="binomial"'),(0,sre.MathspeakRules.defineRule_)("binomial","mathspeak.sbrief",'[t] "BinomialOrMatrix"; [n] children/*[1]/children/*[1]; [t] "Choose"; [n] children/*[2]/children/*[1];  [t] "EndBinomialOrMatrix"',"self::vector",'@role="binomial"'),(0,sre.MathspeakRules.defineRule_)("cases","mathspeak.default",'[t] "StartLayout"; [t] "Enlarged"; [n] content/*[1];[m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndLayout"',"self::cases"),(0,sre.MathspeakRules.defineRule_)("cases","mathspeak.sbrief",'[t] "Layout"; [t] "Enlarged"; [n] content/*[1];[m] children/* (ctxtFunc:CTXFordinalCounter,context:"Row "); [t] "EndLayout"',"self::cases"),(0,sre.MathspeakRules.defineRuleAlias_)("layout","self::multiline"),(0,sre.MathspeakRules.defineRule_)("line","mathspeak.default","[m] children/*","self::line"),(0,sre.MathspeakRules.defineRule_)("line-with-label","mathspeak.default",'[t] "with Label"; [n] content/*[1]; [t] "EndLabel" (pause: 200); [m] children/*',"self::line","content"),(0,sre.MathspeakRules.defineSpecialisedRule_)("line-with-label","mathspeak.default","mathspeak.brief",'[t] "Label"; [n] content/*[1] (pause: 200); [m] children/*'),(0,sre.MathspeakRules.defineSpecialisedRule_)("line-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("line-with-text-label","mathspeak.sbrief",'[t] "Label"; [t] CSFRemoveParens; [m] children/*',"self::line","content",'name(content/cell/children/*[1])="text"'),(0,sre.MathspeakRules.defineRule_)("empty-line","mathspeak.default",'[t] "Blank"',"self::line","count(children/*)=0","not(content)"),(0,sre.MathspeakRules.defineSpecialisedRule_)("empty-line","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("empty-line","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("empty-line-with-label","mathspeak.default",'[t] "with Label"; [n] content/*[1]; [t] "EndLabel"(pause: 200); [t] "Blank"',"self::line","count(children/*)=0","content"),(0,sre.MathspeakRules.defineSpecialisedRule_)("empty-line-with-label","mathspeak.default","mathspeak.brief",'[t] "Label"; [n] content/*[1] (pause: 200); [t] "Blank"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("empty-line-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRule_)("enclose","mathspeak.default",'[t] "StartEnclose"; [t] @role (grammar:localEnclose); [n] children/*[1]; [t] "EndEnclose"',"self::enclose"),(0,sre.MathspeakRules.defineRuleAlias_)("overbar","self::enclose",'@role="top"'),(0,sre.MathspeakRules.defineRuleAlias_)("underbar","self::enclose",'@role="bottom"'),(0,sre.MathspeakRules.defineRule_)("leftbar","mathspeak.default",'[t] "vertical-bar"; [n] children/*[1]',"self::enclose",'@role="left"'),(0,sre.MathspeakRules.defineRule_)("rightbar","mathspeak.default",'[n] children/*[1]; [t] "vertical-bar"',"self::enclose",'@role="right"'),(0,sre.MathspeakRules.defineRule_)("crossout","mathspeak.default",'[t] "CrossOut"; [n] children/*[1]; [t] "EndCrossOut"',"self::enclose",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakRules.defineRule_)("cancel","mathspeak.default",'[t] "CrossOut"; [n] children/*[1]/children/*[1]; [t] "With"; [n] children/*[2]; [t] "EndCrossOut"',"self::overscore",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakRules.defineSpecialisedRule_)("cancel","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("cancel","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("cancel","self::underscore",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakRules.defineRule_)("cancel-reverse","mathspeak.default",'[t] "CrossOut"; [n] children/*[2]/children/*[1]; [t] "With"; [n] children/*[1]; [t] "EndCrossOut"',"self::overscore",'name(children/*[2])="enclose"','children/*[2][@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"]'),(0,sre.MathspeakRules.defineSpecialisedRule_)("cancel-reverse","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakRules.defineSpecialisedRule_)("cancel-reverse","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakRules.defineRuleAlias_)("cancel-reverse","self::underscore",'name(children/*[2])="enclose"','children/*[2][@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"]'),(0,sre.MathspeakRules.defineRule_)("end-punct","mathspeak.default","[m] children/*","self::punctuated",'@role="endpunct"'),(0,sre.MathspeakRules.defineRule_)("start-punct","mathspeak.default","[n] content/*[1]; [m] children/*[position()>1]","self::punctuated",'@role="startpunct"'),(0,sre.MathspeakRules.defineRule_)("integral-punct","mathspeak.default","[n] children/*[1]; [n] children/*[3]","self::punctuated",'@role="integral"'),(0,sre.MathspeakRules.defineRule_)("punctuated","mathspeak.default","[m] children/*","self::punctuated"),(0,sre.MathspeakRules.defineRule_)("unit","mathspeak.default",'[t] text() (grammar:annotation="unit":translate)',"self::identifier",'@role="unit"'),(0,sre.MathspeakRules.defineRule_)("unit-square","mathspeak.default",'[t] "square"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=2]",'name(children/*[1])="identifier"'),(0,sre.MathspeakRules.defineRule_)("unit-cubic","mathspeak.default",'[t] "cubic"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=3]",'name(children/*[1])="identifier"'),(0,sre.MathspeakRules.defineRule_)("reciprocal","mathspeak.default",'[t] "reciprocal"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'count(preceding-sibling::*)=0 or preceding-sibling::*[@role!="unit"]'),(0,sre.MathspeakRules.defineRule_)("reciprocal","mathspeak.default",'[t] "per"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'preceding-sibling::*[@role="unit"]'),(0,sre.MathspeakRules.defineRule_)("unit-combine","mathspeak.default","[m] children/*","self::infixop",'@role="unit"'),(0,sre.MathspeakRules.defineRule_)("unit-divide","mathspeak.default",'[n] children/*[1]; [t] "per"; [n] children/*[2]',"self::fraction",'@role="unit"')},sre.MathspeakRules.componentString_={2:"CSFbaseline",1:"CSFsubscript",0:"CSFsuperscript"},sre.MathspeakRules.childNumber_={4:2,3:3,2:1,1:4,0:5},sre.MathspeakRules.generateTensorRuleStrings_=function(e){var t=[],r="",s="";e=parseInt(e,2);for(var n=0;n<5;n++){var i,a="children/*["+sre.MathspeakRules.childNumber_[n]+"]";1&e?(r="[t] "+(i=sre.MathspeakRules.componentString_[n%3])+"Verbose; [n] "+a+";"+r,s="[t] "+i+"Brief; [n] "+a+";"+s):t.unshift("name("+a+')="empty"'),e>>=1}return t.push(r),t.push(s),t},sre.MathspeakRules.generateMathspeakTensorRules_=function(){for(var e="11111 11110 11101 11100 10111 10110 10101 10100 01111 01110 01101 01100".split(" "),t=0;r=e[t];t++){var r,s="tensor"+r,n=(r=sre.MathspeakRules.generateTensorRuleStrings_(r)).pop(),i=r.pop(),a=[s,"mathspeak.default",i,"self::tensor"].concat(r),o=[s,"mathspeak.brief",n,"self::tensor"].concat(r);sre.MathspeakRules.defineRule_.apply(null,a),sre.MathspeakRules.defineRule_.apply(null,o),(0,sre.MathspeakRules.defineSpecialisedRule_)(s,"mathspeak.brief","mathspeak.sbrief"),n+="; [t]"+(a=sre.MathspeakRules.componentString_[2])+"Brief",a=[s+="-baseline","mathspeak.default",i+="; [t]"+a+"Verbose","self::tensor","following-sibling::*"].concat(r),o=[s,"mathspeak.brief",n,"self::tensor","following-sibling::*"].concat(r),sre.MathspeakRules.defineRule_.apply(null,a),sre.MathspeakRules.defineRule_.apply(null,o),(0,sre.MathspeakRules.defineSpecialisedRule_)(s,"mathspeak.brief","mathspeak.sbrief"),s=[s,"self::tensor","not(following-sibling::*)","ancestor::fraction|ancestor::punctuated|ancestor::fenced|ancestor::root|ancestor::sqrt|ancestor::relseq|ancestor::multirel|@embellished"].concat(r),sre.MathspeakRules.defineRuleAlias_.apply(null,s)}},sre.MathspeakRules.getInstance().initializer=[sre.MathspeakRules.initCustomFunctions_,sre.MathspeakRules.initMathspeakRules_,sre.MathspeakRules.generateMathspeakTensorRules_],sre.MathspeakSpanishUtil={},sre.MathspeakSpanishUtil.europeanNumber=function(e){return e.replace(/,/g,"").replace(/\./g,",")},sre.Grammar.getInstance().setCorrection("euroNum",sre.MathspeakSpanishUtil.europeanNumber),sre.MathspeakSpanishUtil.onesOrdinals="primera segunda tercera cuarta quinta sexta sptima octava novena dcima undcima duodcima".split(" "),sre.MathspeakSpanishUtil.tensOrdinals="dcima vigsima trigsima cuadragsima quincuagsima sexagsima septuagsima octogsima nonagsima".split(" "),sre.MathspeakSpanishUtil.hundredsOrdinals="centsima ducentsima tricentsima cuadringentsima quingentsima sexcentsima septingentsima octingentsima noningentsima".split(" "),sre.MathspeakSpanishUtil.numberToOrdinal=function(e){if(1999<e)return e.toString()+"a";if(e<=12)return sre.MathspeakSpanishUtil.onesOrdinals[e-1];var t=[],r=(1e3<e&&(e-=1e3,t.push("milsima")),Math.floor(e/100));return 0<r&&(t.push(sre.MathspeakSpanishUtil.hundredsOrdinals[r-1]),e%=100),e<=12?t.push(sre.MathspeakSpanishUtil.onesOrdinals[e-1]):(0<(r=Math.floor(e/10))&&(t.push(sre.MathspeakSpanishUtil.tensOrdinals[r-1]),e%=10),0<e&&t.push(sre.MathspeakSpanishUtil.onesOrdinals[e-1])),t.join(" ")},sre.MathspeakSpanishUtil.ordinalCounter=function(e,t){var r=0;return function(){return sre.MathspeakSpanishUtil.numberToOrdinal(++r)+" "+t}},sre.MathspeakSpanishUtil.smallRoot=function(e){if(!e.childNodes||0===e.childNodes.length||!e.childNodes[0].childNodes)return[];var t=e.childNodes[0].childNodes[0].textContent;return/^\d+$/.test(t)&&1<(t=parseInt(t,10))&&t<=10?[e]:[]},sre.MathspeakSpanishUtil.unitMultipliers=function(t,e){var r=0;return function(){var e=sre.AuditoryDescription.create({text:sre.MathspeakSpanishUtil.rightMostUnit(t[r])&&sre.MathspeakSpanishUtil.leftMostUnit(t[r+1])?"por":""},{});return r++,[e]}},sre.MathspeakSpanishUtil.SCRIPT_ELEMENTS=[sre.SemanticAttr.Type.SUPERSCRIPT,sre.SemanticAttr.Type.SUBSCRIPT,sre.SemanticAttr.Type.OVERSCORE,sre.SemanticAttr.Type.UNDERSCORE],sre.MathspeakSpanishUtil.rightMostUnit=function(e){for(;e;){if("unit"===e.getAttribute("role"))return!0;var t=e.tagName;e=sre.XpathUtil.evalXPath("children/*",e),e=-1!==sre.MathspeakSpanishUtil.SCRIPT_ELEMENTS.indexOf(t)?e[0]:e[e.length-1]}return!1},sre.MathspeakSpanishUtil.leftMostUnit=function(e){for(;e;){if("unit"===e.getAttribute("role"))return!0;e=sre.XpathUtil.evalXPath("children/*",e)[0]}return!1},sre.MathspeakSpanishUtil.makePlural=function(e){return/.*s$/.test(e)?e:e+"s"},sre.Grammar.getInstance().setCorrection("plural",sre.MathspeakSpanishUtil.makePlural),sre.MathspeakSpanishUtil.oneLeft=function(e){for(;e;){if("number"===e.tagName&&"1"===e.textContent)return[e];if("infixop"!==e.tagName||"multiplication"!==e.getAttribute("role")&&"implicit"!==e.getAttribute("role"))break;e=sre.XpathUtil.evalXPath("children/*",e)[0]}return[]},sre.MathspeakSpanish=function(){sre.MathStore.call(this),this.locale="es"},goog.inherits(sre.MathspeakSpanish,sre.MathStore),goog.addSingletonGetter(sre.MathspeakSpanish),sre.MathspeakSpanish.prototype.evaluateDefault=function(e){return[sre.AuditoryDescription.create({text:e.textContent})]},sre.MathspeakSpanish.SPANISH_REGEXP="a-zA-Z",sre.MathspeakSpanish.evaluateDefault=function(e){e=e.textContent;for(var t=[],r=new sre.SystemExternal.xmldom.DOMParser,s=new RegExp("^["+sre.MathspeakSpanish.SPANISH_REGEXP+"]+"),n=new RegExp("^[^"+sre.MathspeakSpanish.SPANISH_REGEXP+"]+");e;){var i=s.exec(e),a=i?(o=sre.Semantic.Type.TEXT,sre.Semantic.Role.PROTECTED):(i=n.exec(e),o=sre.Semantic.Type.UNKNOWN,sre.Semantic.Role.TEXT),o=r.parseFromString("<"+o+' role="'+a+'">'+i[0]+"</"+o+">","text/xml");t.push(o.documentElement),e=e.slice(i[0].length).trimLeft()}return t},sre.MathspeakSpanish.mathStore=sre.MathspeakSpanish.getInstance(),sre.MathspeakSpanish.defineRule_=goog.bind(sre.MathspeakSpanish.mathStore.defineRule,sre.MathspeakSpanish.mathStore),sre.MathspeakSpanish.defineRuleAlias_=goog.bind(sre.MathspeakSpanish.mathStore.defineRulesAlias,sre.MathspeakSpanish.mathStore),sre.MathspeakSpanish.defineSpecialisedRule_=goog.bind(sre.MathspeakSpanish.mathStore.defineSpecialisedRule,sre.MathspeakSpanish.mathStore),sre.MathspeakSpanish.addContextFunction_=goog.bind(sre.MathspeakSpanish.mathStore.contextFunctions.add,sre.MathspeakSpanish.mathStore.contextFunctions),sre.MathspeakSpanish.addCustomQuery_=goog.bind(sre.MathspeakSpanish.mathStore.customQueries.add,sre.MathspeakSpanish.mathStore.customQueries),sre.MathspeakSpanish.addCustomString_=goog.bind(sre.MathspeakSpanish.mathStore.customStrings.add,sre.MathspeakSpanish.mathStore.customStrings),sre.MathspeakSpanish.initCustomFunctions_=function(){(0,sre.MathspeakSpanish.addCustomQuery_)("CQFspaceoutNumber",sre.MathspeakUtil.spaceoutNumber),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFspaceoutIdentifier",sre.MathspeakUtil.spaceoutIdentifier),(0,sre.MathspeakSpanish.addCustomString_)("CSFspaceoutText",sre.MathspeakUtil.spaceoutText),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenFracVerbose",sre.MathspeakUtil.openingFractionVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFcloseFracVerbose",sre.MathspeakUtil.closingFractionVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFoverFracVerbose",sre.MathspeakUtil.overFractionVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenFracBrief",sre.MathspeakUtil.openingFractionBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFcloseFracBrief",sre.MathspeakUtil.closingFractionBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenFracSbrief",sre.MathspeakUtil.openingFractionSbrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFcloseFracSbrief",sre.MathspeakUtil.closingFractionSbrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFoverFracSbrief",sre.MathspeakUtil.overFractionSbrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenRadicalVerbose",sre.MathspeakUtil.openingRadicalVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFcloseRadicalVerbose",sre.MathspeakUtil.closingRadicalVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFindexRadicalVerbose",sre.MathspeakUtil.indexRadicalVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenRadicalBrief",sre.MathspeakUtil.openingRadicalBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFcloseRadicalBrief",sre.MathspeakUtil.closingRadicalBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFindexRadicalBrief",sre.MathspeakUtil.indexRadicalBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFopenRadicalSbrief",sre.MathspeakUtil.openingRadicalSbrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFindexRadicalSbrief",sre.MathspeakUtil.indexRadicalSbrief),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFisSmallRoot",sre.MathspeakSpanishUtil.smallRoot),(0,sre.MathspeakSpanish.addCustomString_)("CSFsuperscriptVerbose",sre.MathspeakUtil.superscriptVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFsuperscriptBrief",sre.MathspeakUtil.superscriptBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFsubscriptVerbose",sre.MathspeakUtil.subscriptVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFsubscriptBrief",sre.MathspeakUtil.subscriptBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFbaselineVerbose",sre.MathspeakUtil.baselineVerbose),(0,sre.MathspeakSpanish.addCustomString_)("CSFbaselineBrief",sre.MathspeakUtil.baselineBrief),(0,sre.MathspeakSpanish.addCustomString_)("CSFunderscript",sre.MathspeakUtil.nestedUnderscore),(0,sre.MathspeakSpanish.addCustomString_)("CSFoverscript",sre.MathspeakUtil.nestedOverscore),(0,sre.MathspeakSpanish.addContextFunction_)("CTXFordinalCounterEs",sre.MathspeakSpanishUtil.ordinalCounter),(0,sre.MathspeakSpanish.addContextFunction_)("CTXFcontentIterator",sre.MathmlStoreUtil.contentIterator),(0,sre.MathspeakSpanish.addContextFunction_)("CTXFunitMultipliers",sre.MathspeakSpanishUtil.unitMultipliers),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFdetIsSimple",sre.MathspeakUtil.determinantIsSimple),(0,sre.MathspeakSpanish.addCustomString_)("CSFRemoveParens",sre.MathspeakUtil.removeParens),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFoneLeft",sre.MathspeakSpanishUtil.oneLeft),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFresetNesting",sre.MathspeakUtil.resetNestingDepth),(0,sre.MathspeakSpanish.addCustomQuery_)("CQFtextEvaluator",sre.MathspeakSpanish.evaluateDefault)},sre.MathspeakSpanish.initMathspeakSpanish_=function(){(0,sre.MathspeakSpanish.defineRule_)("stree","mathspeak.default","[n] ./*[1]","self::stree","CQFresetNesting"),(0,sre.MathspeakSpanish.defineRule_)("unknown","mathspeak.default","[n] text()","self::unknown"),(0,sre.MathspeakSpanish.defineRule_)("protected","mathspeak.default","[t] text()","self::*",'@role="protected"'),(0,sre.MathspeakSpanish.defineRule_)("omit-empty","mathspeak.default","[p] (pause:100)","self::empty"),(0,sre.MathspeakSpanish.defineRule_)("blank-empty","mathspeak.default",'[t] "espacio"',"self::empty","count(../*)=1",'name(../..)="cell" or name(../..)="line"'),(0,sre.MathspeakSpanish.defineRule_)("font","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"'),(0,sre.MathspeakSpanish.defineRule_)("font-identifier-short","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="normal"','""=translate(text(), "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ", "")','@role!="unit"'),(0,sre.MathspeakSpanish.defineRule_)("font-identifier","mathspeak.default","[t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'@font="normal"','not(contains(@grammar, "ignoreFont"))','@role!="unit"'),(0,sre.MathspeakSpanish.defineRule_)("omit-font","mathspeak.default","[n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="italic"'),(0,sre.MathspeakSpanish.defineRule_)("number","mathspeak.default","[n] text() (grammar:euroNum)","self::number"),(0,sre.MathspeakSpanish.defineRule_)("mixed-number","mathspeak.default",'[n] children/*[1]; [t] "ms"; [n] children/*[2]; ',"self::number",'@role="mixed"'),(0,sre.MathspeakSpanish.defineRule_)("number-with-chars","mathspeak.default",'[t] "nmero"; [m] CQFspaceoutNumber',"self::number",'"" != translate(text(), "0123456789.,", "")','text() != translate(text(), "0123456789.,", "")'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-with-chars","mathspeak.default","mathspeak.brief",'[t] "nm"; [m] CQFspaceoutNumber'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-with-chars","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("number-as-upper-word","mathspeak.default",'[t] "mayscula"; [t] CSFspaceoutText',"self::number","string-length(text())>1",'text()=translate(text(), "abcdefghijklmnopqrstuvwxyz", "ABCDEFGHIJKLMNOPQRSTUVWXYZ")','""=translate(text(), "ABCDEFGHIJKLMNOPQRSTUVWXYZ","")'),(0,sre.MathspeakSpanish.defineRule_)("number-baseline","mathspeak.default",'[t] "lnea base"; [n] text()',"self::number",'not(contains(@grammar, "ignoreFont"))',"preceding-sibling::identifier",'preceding-sibling::*[1][@role="latinletter" or @role="greekletter" or @role="otherletter"]','parent::*/parent::infixop[@role="implicit"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-baseline","mathspeak.default","mathspeak.brief",'[t] "base"; [n] text()'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("number-baseline-font","mathspeak.default",'[t] "lnea base"; [t] @font (grammar:localFont); [n] . (grammar:ignoreFont=@font)',"self::number","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"',"preceding-sibling::identifier",'preceding-sibling::*[@role="latinletter" or @role="greekletter" or @role="otherletter"]','parent::*/parent::infixop[@role="implicit"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-baseline-font","mathspeak.default","mathspeak.brief",'[t] "base"; [n] text()'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("number-baseline-font","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("identifier","mathspeak.default","[m] CQFspaceoutIdentifier","self::identifier","string-length(text())>1",'@role!="unit"','@role!="protected"','not(@font) or @font="normal" or contains(@grammar, "ignoreFont")'),(0,sre.MathspeakSpanish.defineRule_)("identifier","mathspeak.default","[n] text()","self::identifier",'@role="protected"'),(0,sre.MathspeakSpanish.defineRule_)("negative","mathspeak.default",'[t] "menos"; [n] children/*[1]',"self::prefixop",'@role="negative"',"children/identifier"),(0,sre.MathspeakSpanish.defineRuleAlias_)("negative","self::prefixop",'@role="negative"',"children/number"),(0,sre.MathspeakSpanish.defineRuleAlias_)("negative","self::prefixop",'@role="negative"','children/fraction[@role="vulgar"]'),(0,sre.MathspeakSpanish.defineRule_)("negative","mathspeak.default",'[t] "menos"; [n] children/*[1]',"self::prefixop",'@role="negative"'),(0,sre.MathspeakSpanish.defineRule_)("prefix","mathspeak.default","[n] text(); [n] children/*[1]","self::prefixop"),(0,sre.MathspeakSpanish.defineRule_)("postfix","mathspeak.default","[n] children/*[1]; [n] text()","self::postfixop"),(0,sre.MathspeakSpanish.defineRule_)("binary-operation","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator);","self::infixop"),(0,sre.MathspeakSpanish.defineRule_)("implicit","mathspeak.default","[m] children/*","self::infixop",'@role="implicit"'),(0,sre.MathspeakSpanish.defineRuleAlias_)("implicit","self::infixop",'@role="leftsuper" or @role="leftsub" or @role="rightsuper" or @role="rightsub"'),(0,sre.MathspeakSpanish.defineRule_)("subtraction","mathspeak.default",'[m] children/* (separator:"menos");',"self::infixop",'@role="subtraction"'),(0,sre.MathspeakSpanish.defineRule_)("function-unknown","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::appl"),(0,sre.MathspeakSpanish.defineRule_)("function-prefix","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::appl",'children/*[1][@role="prefix function"]'),(0,sre.MathspeakSpanish.defineRule_)("fences-open-close","mathspeak.default","[n] content/*[1]; [n] children/*[1]; [n] content/*[2]","self::fenced",'@role="leftright"'),(0,sre.MathspeakSpanish.defineRule_)("fences-neutral","mathspeak.default",'[t] "empezar valor absoluto"; [n] children/*[1]; [t] "finalizar valor absoluto"',"self::fenced",'@role="neutral"','content/*[1][text()]="|" or content/*[1][text()]="" or content/*[1][text()]=""'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("fences-neutral","mathspeak.default","mathspeak.sbrief",'[t] "valor absoluto"; [n] children/*[1]; [t] "finalizar valor absoluto"'),(0,sre.MathspeakSpanish.defineRule_)("fences-neutral","mathspeak.default","[n] content/*[1]; [n] children/*[1]; [n] content/*[2]","self::fenced",'@role="neutral"'),(0,sre.MathspeakSpanish.defineRule_)("fences-set","mathspeak.default",'[t] "empezar llave"; [n] children/*[1]; [t] "finalizar llave"',"self::fenced",'@role="leftright"','content/*[1][text()]="{"','content/*[2][text()]="}"',"count(children/*)=1",'not(name(../..)="appl")'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("fences-set","mathspeak.default","mathspeak.sbrief",'[t] "llave"; [n] children/*[1]; [t] "finalizar llave"'),(0,sre.MathspeakSpanish.defineRule_)("text","mathspeak.default","[m] CQFtextEvaluator","self::text"),(0,sre.MathspeakSpanish.defineRule_)("factorial","mathspeak.default",'[t] "factorial"',"self::punctuation",'text()="!"','name(preceding-sibling::*[1])!="text"'),(0,sre.MathspeakSpanish.defineRule_)("minus","mathspeak.default",'[t] "menos"',"self::operator",'text()="-"'),(0,sre.MathspeakSpanish.defineRule_)("single-prime","mathspeak.default",'[t] "prima"',"self::punctuated",'@role="prime"',"count(children/*)=1"),(0,sre.MathspeakSpanish.defineRule_)("double-prime","mathspeak.default",'[t] "doble prima"',"self::punctuated",'@role="prime"',"count(children/*)=2"),(0,sre.MathspeakSpanish.defineRule_)("triple-prime","mathspeak.default",'[t] "triple prima"',"self::punctuated",'@role="prime"',"count(children/*)=3"),(0,sre.MathspeakSpanish.defineRule_)("quadruple-prime","mathspeak.default",'[t] "cuadruplicar prima"',"self::punctuated",'@role="prime"',"count(children/*)=4"),(0,sre.MathspeakSpanish.defineRule_)("counted-prime","mathspeak.default",'[t] count(children/*); [t] "prime"',"self::punctuated",'@role="prime"'),(0,sre.MathspeakSpanish.defineRule_)("fraction","mathspeak.default","[t] CSFopenFracVerbose; [n] children/*[1]; [t] CSFoverFracVerbose; [n] children/*[2]; [t] CSFcloseFracVerbose","self::fraction"),(0,sre.MathspeakSpanish.defineRule_)("fraction","mathspeak.brief","[t] CSFopenFracBrief; [n] children/*[1]; [t] CSFoverFracVerbose; [n] children/*[2]; [t] CSFcloseFracBrief","self::fraction"),(0,sre.MathspeakSpanish.defineRule_)("fraction","mathspeak.sbrief","[t] CSFopenFracSbrief; [n] children/*[1]; [t] CSFoverFracSbrief; [n] children/*[2]; [t] CSFcloseFracSbrief","self::fraction"),(0,sre.MathspeakSpanish.defineRule_)("continued-fraction-outer","mathspeak.default",'[t] "fraccin continua"; [n] children/*[1];[t] "entre"; [n] children/*[2]',"self::fraction","not(ancestor::fraction)",'children/*[2]/descendant-or-self::*[@role="ellipsis" and not(following-sibling::*)]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("continued-fraction-outer","mathspeak.default","mathspeak.brief",'[t] "frac continua"; [n] children/*[1];[t] "entre"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("continued-fraction-outer","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("continued-fraction-inner","mathspeak.default",'[t] "empezar fraccin"; [n] children/*[1];[t] "entre"; [n] children/*[2]',"self::fraction","ancestor::fraction",'children/*[2]/descendant-or-self::*[@role="ellipsis" and not(following-sibling::*)]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("continued-fraction-inner","mathspeak.default","mathspeak.brief",'[t] "empezar frac"; [n] children/*[1];[t] "entre"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("continued-fraction-inner","mathspeak.brief","mathspeak.sbrief",'[t] "frac"; [n] children/*[1];[t] "entre"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineRule_)("sqrt","mathspeak.default","[t] CSFopenRadicalVerbose; [n] children/*[1]; [t] CSFcloseRadicalVerbose","self::sqrt"),(0,sre.MathspeakSpanish.defineRule_)("sqrt","mathspeak.brief","[t] CSFopenRadicalBrief; [n] children/*[1]; [t] CSFcloseRadicalBrief","self::sqrt"),(0,sre.MathspeakSpanish.defineRule_)("sqrt","mathspeak.sbrief","[t] CSFopenRadicalSbrief; [n] children/*[1]; [t] CSFcloseRadicalBrief","self::sqrt"),(0,sre.MathspeakSpanish.defineRule_)("root-small","mathspeak.default","[t] CSFopenRadicalVerbose; [n] children/*[2]; [t] CSFcloseRadicalVerbose","self::root","CQFisSmallRoot"),(0,sre.MathspeakSpanish.defineRule_)("root-small","mathspeak.brief","[t] CSFopenRadicalBrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root","CQFisSmallRoot"),(0,sre.MathspeakSpanish.defineRule_)("root-small","mathspeak.sbrief","[t] CSFopenRadicalSbrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root","CQFisSmallRoot"),(0,sre.MathspeakSpanish.defineRule_)("root","mathspeak.default","[t] CSFindexRadicalVerbose; [n] children/*[1];[t] CSFopenRadicalVerbose; [n] children/*[2]; [t] CSFcloseRadicalVerbose","self::root"),(0,sre.MathspeakSpanish.defineRule_)("root","mathspeak.brief","[t] CSFindexRadicalBrief; [n] children/*[1];[t] CSFopenRadicalBrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root"),(0,sre.MathspeakSpanish.defineRule_)("root","mathspeak.sbrief","[t] CSFindexRadicalSbrief; [n] children/*[1];[t] CSFopenRadicalSbrief; [n] children/*[2]; [t] CSFcloseRadicalBrief","self::root"),(0,sre.MathspeakSpanish.defineRule_)("limboth","mathspeak.default","[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];[t] CSFoverscript; [n] children/*[3]","self::limboth",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRule_)("limlower","mathspeak.default","[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];","self::limlower",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRule_)("limupper","mathspeak.default","[n] children/*[1]; [t] CSFoverscript; [n] children/*[2];","self::limupper",'name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRuleAlias_)("limlower","self::underscore",'@role="limit function"','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRuleAlias_)("limlower","self::underscore",'children/*[2][@role!="underaccent"]','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRuleAlias_)("limupper","self::overscore",'children/*[2][@role!="overaccent"]','name(../..)="underscore" or name(../..)="overscore"','following-sibling::*[@role!="underaccent" and @role!="overaccent"]'),(0,sre.MathspeakSpanish.defineRule_)("limboth-end","mathspeak.default",'[n] children/*[1]; [t] CSFunderscript; [n] children/*[2];[t] CSFoverscript; [n] children/*[3]; [t] "finalizar ndices"',"self::limboth"),(0,sre.MathspeakSpanish.defineRule_)("limlower-end","mathspeak.default",'[n] children/*[1]; [t] CSFunderscript; [n] children/*[2]; [t] "finalizar ndices"',"self::limlower"),(0,sre.MathspeakSpanish.defineRule_)("limupper-end","mathspeak.default",'[n] children/*[1]; [t] CSFoverscript; [n] children/*[2]; [t] "finalizar ndices"',"self::limupper"),(0,sre.MathspeakSpanish.defineRuleAlias_)("limlower-end","self::underscore",'@role="limit function"'),(0,sre.MathspeakSpanish.defineRuleAlias_)("limlower-end","self::underscore"),(0,sre.MathspeakSpanish.defineRuleAlias_)("limupper-end","self::overscore"),(0,sre.MathspeakSpanish.defineRule_)("integral","mathspeak.default","[n] children/*[1]; [n] children/*[2]; [n] children/*[3];","self::integral"),(0,sre.MathspeakSpanish.defineRule_)("integral","mathspeak.default",'[n] children/*[1]; [t] "definida"; [t] "subndice"; [n] children/*[2];[t] "superndice"; [n] children/*[3]; [t] "lnea base";',"self::limboth",'@role="integral"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("integral","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "Sub"; [n] children/*[2];[t] "Sup"; [n] children/*[3]; [t] "Base";'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("integral","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("bigop","mathspeak.default","[n] children/*[1]; [n] children/*[2];","self::bigop"),(0,sre.MathspeakSpanish.defineRule_)("relseq","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq"),(0,sre.MathspeakSpanish.defineRule_)("equality","mathspeak.default","[n] children/*[1]; [n] content/*[1]; [n] children/*[2]","self::relseq",'@role="equality"',"count(./children/*)=2"),(0,sre.MathspeakSpanish.defineRule_)("multi-equality","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq",'@role="equality"',"count(./children/*)>2"),(0,sre.MathspeakSpanish.defineRule_)("multrel","mathspeak.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::multirel"),(0,sre.MathspeakSpanish.defineRule_)("subscript","mathspeak.default","[n] children/*[1]; [t] CSFsubscriptVerbose; [n] children/*[2]","self::subscript"),(0,sre.MathspeakSpanish.defineRule_)("subscript","mathspeak.brief","[n] children/*[1]; [t] CSFsubscriptBrief; [n] children/*[2]","self::subscript"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("subscript-baseline","mathspeak.default","[n] children/*[1]; [t] CSFsubscriptVerbose; [n] children/*[2]; [t] CSFbaselineVerbose","self::subscript","following-sibling::*",'not(name(following-sibling::subscript/children/*[1])="empty" or (name(following-sibling::infixop[@role="implicit"]/children/*[1])="subscript" and name(following-sibling::*/children/*[1]/children/*[1])="empty")) and @role!="subsup"','not(following-sibling::*[@role="rightsuper" or @role="rightsub" or @role="leftsub" or @role="leftsub"])'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("subscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsubscriptBrief; [n] children/*[2]; [t] CSFbaselineBriefS"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("subscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","ancestor::fenced|ancestor::root|ancestor::sqrt|ancestor::punctuated|ancestor::fraction",'not(ancestor::punctuated[@role="leftsuper" or @role="rightsub" or @role="rightsuper" or @role="rightsub"])'),(0,sre.MathspeakSpanish.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","ancestor::relseq|ancestor::multirel",sre.MathspeakUtil.generateBaselineConstraint()),(0,sre.MathspeakSpanish.defineRuleAlias_)("subscript-baseline","self::subscript","not(following-sibling::*)","@embellished"),(0,sre.MathspeakSpanish.defineRule_)("subscript-empty-sup","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::subscript",'name(children/*[2])="infixop"','name(children/*[2][@role="implicit"]/children/*[1])="superscript"','name(children/*[2]/children/*[1]/children/*[1])="empty"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("subscript-empty-sup","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("subscript-empty-sup","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("subscript-empty-sup","self::subscript",'name(children/*[2])="superscript"','name(children/*[2]/children/*[1])="empty"'),(0,sre.MathspeakSpanish.defineRule_)("superscript","mathspeak.default","[n] children/*[1]; [t] CSFsuperscriptVerbose; [n] children/*[2]","self::superscript"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsuperscriptBrief; [n] children/*[2]"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("superscript-baseline","mathspeak.default","[n] children/*[1]; [t] CSFsuperscriptVerbose; [n] children/*[2];[t] CSFbaselineVerbose","self::superscript","following-sibling::*",'not(name(following-sibling::superscript/children/*[1])="empty" or (name(following-sibling::infixop[@role="implicit"]/children/*[1])="superscript" and name(following-sibling::*/children/*[1]/children/*[1])="empty")) and not(following-sibling::*[@role="rightsuper" or @role="rightsub" or @role="leftsub" or @role="leftsub"])'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]; [t] CSFsuperscriptBrief; [n] children/*[2];[t] CSFbaselineBriefS"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::punctuated",'ancestor::*/following-sibling::* and not(ancestor::punctuated[@role="leftsuper" or @role="rightsub" or @role="rightsuper" or @role="rightsub"])'),(0,sre.MathspeakSpanish.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::fraction|ancestor::fenced|ancestor::root|ancestor::sqrt"),(0,sre.MathspeakSpanish.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","ancestor::relseq|ancestor::multirel","not(@embellished)",sre.MathspeakUtil.generateBaselineConstraint()),(0,sre.MathspeakSpanish.defineRuleAlias_)("superscript-baseline","self::superscript","not(following-sibling::*)","@embellished",'not(children/*[2][@role="prime"])'),(0,sre.MathspeakSpanish.defineRule_)("superscript-empty-sub","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::superscript",'name(children/*[2])="infixop"','name(children/*[2][@role="implicit"]/children/*[1])="subscript"','name(children/*[2]/children/*[1]/children/*[1])="empty"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript-empty-sub","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("superscript-empty-sub","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("superscript-empty-sub","self::superscript",'name(children/*[2])="subscript"','name(children/*[2]/children/*[1])="empty"'),(0,sre.MathspeakSpanish.defineRule_)("square","mathspeak.default",'[n] children/*[1]; [t] "al cuadrado"',"self::superscript","children/*[2]","children/*[2][text()=2]",'name(children/*[1])!="text" or not(name(children/*[1])="text" and (name(../../../punctuated[@role="text"]/..)="stree" or name(..)="stree"))','name(children/*[1])!="subscript" or (name(children/*[1])="subscript" and name(children/*[1]/children/*[1])="identifier" and name(children/*[1]/children/*[2])="number" and children/*[1]/children/*[2][@role!="mixed"] and children/*[1]/children/*[2][@role!="othernumber"])',"not(@embellished)"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("square","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("square","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("cube","mathspeak.default",'[n] children/*[1]; [t] "al cubo"',"self::superscript","children/*[2]","children/*[2][text()=3]",'name(children/*[1])!="text" or not(name(children/*[1])="text" and (name(../../../punctuated[@role="text"]/..)="stree" or name(..)="stree"))','name(children/*[1])!="subscript" or (name(children/*[1])="subscript" and name(children/*[1]/children/*[1])="identifier" and name(children/*[1]/children/*[2])="number" and children/*[1]/children/*[2][@role!="mixed"] and children/*[1]/children/*[2][@role!="othernumber"])',"not(@embellished)"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cube","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cube","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("prime","mathspeak.default","[n] children/*[1]; [n] children/*[2]","self::superscript","children/*[2]",'children/*[2][@role="prime"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("prime-subscript","mathspeak.default","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptVerbose; [n] children/*[1]/children/*[2]","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"not(following-sibling::*)"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime-subscript","mathspeak.default","mathspeak.brief","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptBrief; [n] children/*[1]/children/*[2]"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime-subscript","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("prime-subscript-baseline","mathspeak.default","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptVerbose; [n] children/*[1]/children/*[2]; [t] CSFbaselineVerbose","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"following-sibling::*"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime-subscript-baseline","mathspeak.default","mathspeak.brief","[n] children/*[1]/children/*[1]; [n] children/*[2]; [t] CSFsubscriptBrief; [n] children/*[1]/children/*[2]; [t] CSFbaselineBriefS"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("prime-subscript-baseline","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("prime-subscript-baseline","self::superscript",'children/*[2][@role="prime"]','name(children/*[1])="subscript"',"not(following-sibling::*)","@embellished"),(0,sre.MathspeakSpanish.defineRule_)("overscore","mathspeak.default",'[t] "modificando superior"; [n] children/*[1]; [t] "con"; [n] children/*[2]',"self::overscore",'children/*[2][@role="overaccent"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overscore","mathspeak.default","mathspeak.brief",'[t] "mod superior"; [n] children/*[1]; [t] "con"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("double-overscore","mathspeak.default",'[t] "modificando superior superior"; [n] children/*[1]; [t] "con"; [n] children/*[2]',"self::overscore",'children/*[2][@role="overaccent"]','name(children/*[1])="overscore"','children/*[1]/children/*[2][@role="overaccent"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("double-overscore","mathspeak.default","mathspeak.brief",'[t] "mod superior superior"; [n] children/*[1]; [t] "con"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("double-overscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("underscore","mathspeak.default",'[t] "modificando inferior"; [n] children/*[1]; [t] "con"; [n] children/*[2]',"self::underscore",'children/*[2][@role="underaccent"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("underscore","mathspeak.default","mathspeak.brief",'[t] "mod inferior"; [n] children/*[1]; [t] "con"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("underscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("double-underscore","mathspeak.default",'[t] "modificando inferior inferior"; [n] children/*[1]; [t] "con"; [n] children/*[2]',"self::underscore",'children/*[2][@role="underaccent"]','name(children/*[1])="underscore"','children/*[1]/children/*[2][@role="underaccent"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("double-underscore","mathspeak.default","mathspeak.brief",'[t] "mod inferior inferior"; [n] children/*[1]; [t] "con"; [n] children/*[2]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("double-underscore","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("overbar","mathspeak.default",'[n] children/*[1]; [t] "barra"',"self::overscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="overaccent"]','children/*[2][text()="" or text()="" or text()="" or text()="_" or text()=""]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overbar","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "barra"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overbar","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("underbar","mathspeak.default",'[n] children/*[1]; [t] "subbarra"',"self::underscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="underaccent"]','children/*[2][text()="" or text()="" or text()="" or text()="_" or text()=""]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("underbar","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "subbarra"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("underbar","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("overtilde","mathspeak.default",'[n] children/*[1]; [t] "tilde"',"self::overscore",'children/*[2][@role="overaccent"]','@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][text()="~" or text()="" or text()="" or text()=""]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overtilde","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "tilde"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("overtilde","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("undertilde","mathspeak.default",'[n] children/*[1]; [t] "subtilde"',"self::underscore",'@role="latinletter" or @role="greekletter" or @role="otherletter"','children/*[2][@role="underaccent"]','children/*[2][text()="~" or text()="" or text()="" or text()=""]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("undertilde","mathspeak.default","mathspeak.brief",'[n] children/*[1]; [t] "subtilde"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("undertilde","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("matrix-fence","mathspeak.default","[n] children/*[1];","self::fenced","count(children/*)=1",'name(children/*[1])="matrix"'),(0,sre.MathspeakSpanish.defineRule_)("matrix","mathspeak.default",'[t] "empezar matriz"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar matriz"',"self::matrix"),(0,sre.MathspeakSpanish.defineRule_)("matrix","mathspeak.sbrief",'[t] "matriz"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:" "); [t] "finalizar matriz"',"self::matrix"),(0,sre.MathspeakSpanish.defineRuleAlias_)("matrix","self::vector"),(0,sre.MathspeakSpanish.defineRule_)("matrix-row","mathspeak.default",'[m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"columna");[p] (pause: 200)',"self::row"),(0,sre.MathspeakSpanish.defineRule_)("row-with-label","mathspeak.default",'[t] "con etiqueta"; [n] content/*[1]; [t] "finalizar etiqueta" (pause: 200); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"columna")',"self::row","content"),(0,sre.MathspeakSpanish.defineRule_)("row-with-label","mathspeak.brief",'[t] "etiqueta"; [n] content/*[1]; [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"columna")',"self::row","content"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("row-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("row-with-text-label","mathspeak.sbrief",'[t] "etiqueta"; [t] CSFRemoveParens;[m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"columna")',"self::row","content",'name(content/cell/children/*[1])="text"'),(0,sre.MathspeakSpanish.defineRule_)("empty-row","mathspeak.default",'[t] "espacio"',"self::row","count(children/*)=0"),(0,sre.MathspeakSpanish.defineRule_)("matrix-cell","mathspeak.default","[n] children/*[1]; [p] (pause: 300)","self::cell"),(0,sre.MathspeakSpanish.defineRule_)("empty-cell","mathspeak.default",'[t] "espacio"; [p] (pause: 300)',"self::cell","count(children/*)=0"),(0,sre.MathspeakSpanish.defineRule_)("determinant","mathspeak.default",'[t] "empezar determinante"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar determinante"',"self::matrix",'@role="determinant"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("determinant","mathspeak.default","mathspeak.sbrief",'[t] "determinante"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar determinante"'),(0,sre.MathspeakSpanish.defineRule_)("determinant-simple","mathspeak.default",'[t] "empezar determinante"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila",grammar:simpleDet); [t] "finalizar determinante"',"self::matrix",'@role="determinant"',"CQFdetIsSimple"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("determinant-simple","mathspeak.default","mathspeak.sbrief",'[t] "determinante"; [t] count(children/*);  [t] "por";[t] count(children/*[1]/children/*); [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila",grammar:simpleDet); [t] "finalizar determinante"'),(0,sre.MathspeakSpanish.defineRule_)("row-simple","mathspeak.default","[m] children/*;","self::row",'@role="determinant"','contains(@grammar, "simpleDet")'),(0,sre.MathspeakSpanish.defineRule_)("layout","mathspeak.default",'[t] "empezar esquema"; [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar esquema"',"self::table"),(0,sre.MathspeakSpanish.defineRule_)("layout","mathspeak.sbrief",'[t] "esquema"; [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar esquema"',"self::table"),(0,sre.MathspeakSpanish.defineRule_)("binomial","mathspeak.default",'[t] "empezar binomial"; [n] children/*[1]/children/*[1]; [t] "en"; [n] children/*[2]/children/*[1];  [t] "finalizar binomial"',"self::vector",'@role="binomial"'),(0,sre.MathspeakSpanish.defineRule_)("binomial","mathspeak.sbrief",'[t] "binomial"; [n] children/*[1]/children/*[1]; [t] "en"; [n] children/*[2]/children/*[1];  [t] "finalizar binomial"',"self::vector",'@role="binomial"'),(0,sre.MathspeakSpanish.defineRule_)("cases","mathspeak.default",'[t] "empezar esquema"; [n] content/*[1]; [t] "alargada"; [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar esquema"',"self::cases"),(0,sre.MathspeakSpanish.defineRule_)("cases","mathspeak.sbrief",'[t] "esquema"; [n] content/*[1]; [t] "alargada"; [m] children/* (ctxtFunc:CTXFordinalCounterEs,context:"fila "); [t] "finalizar esquema"',"self::cases"),(0,sre.MathspeakSpanish.defineRuleAlias_)("layout","self::multiline"),(0,sre.MathspeakSpanish.defineRule_)("line","mathspeak.default","[m] children/*","self::line"),(0,sre.MathspeakSpanish.defineRule_)("line-with-label","mathspeak.default",'[t] "con etiqueta"; [n] content/*[1]; [t] "finalizar etiqueta" (pause: 200); [m] children/*',"self::line","content"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("line-with-label","mathspeak.default","mathspeak.brief",'[t] "etiqueta"; [n] content/*[1] (pause: 200); [m] children/*'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("line-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("line-with-text-label","mathspeak.sbrief",'[t] "etiqueta"; [t] CSFRemoveParens; [m] children/*',"self::line","content",'name(content/cell/children/*[1])="text"'),(0,sre.MathspeakSpanish.defineRule_)("empty-line","mathspeak.default",'[t] "espacio"',"self::line","count(children/*)=0","not(content)"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("empty-line","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("empty-line","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("empty-line-with-label","mathspeak.default",'[t] "con etiqueta"; [n] content/*[1]; [t] "finalizar etiqueta" (pause: 200); [t] "espacio"',"self::line","count(children/*)=0","content"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("empty-line-with-label","mathspeak.default","mathspeak.brief",'[t] "etiqueta"; [n] content/*[1] (pause: 200); [t] "espacio"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("empty-line-with-label","mathspeak.brief","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRule_)("enclose","mathspeak.default",'[t] "empezar rodear"; [t] @role (grammar:localEnclose); [n] children/*[1]; [t] "finalizar rodear"',"self::enclose"),(0,sre.MathspeakSpanish.defineRuleAlias_)("overbar","self::enclose",'@role="top"'),(0,sre.MathspeakSpanish.defineRuleAlias_)("underbar","self::enclose",'@role="bottom"'),(0,sre.MathspeakSpanish.defineRule_)("leftbar","mathspeak.default",'[t] "barra vertical"; [n] children/*[1]',"self::enclose",'@role="left"'),(0,sre.MathspeakSpanish.defineRule_)("rightbar","mathspeak.default",'[n] children/*[1]; [t] "barra vertical"',"self::enclose",'@role="right"'),(0,sre.MathspeakSpanish.defineRule_)("crossout","mathspeak.default",'[t] "tachado"; [n] children/*[1]; [t] "finalizar tachado"',"self::enclose",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakSpanish.defineRule_)("cancel","mathspeak.default",'[t] "tachado"; [n] children/*[1]/children/*[1]; [t] "con"; [n] children/*[2]; [t] "finalizar tachado"',"self::overscore",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cancel","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cancel","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("cancel","self::underscore",'@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"'),(0,sre.MathspeakSpanish.defineRule_)("cancel-reverse","mathspeak.default",'[t] "tachado"; [n] children/*[2]/children/*[1]; [t] "con"; [n] children/*[1]; [t] "finalizar tachado"',"self::overscore",'name(children/*[2])="enclose"','children/*[2][@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"]'),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cancel-reverse","mathspeak.default","mathspeak.brief"),(0,sre.MathspeakSpanish.defineSpecialisedRule_)("cancel-reverse","mathspeak.default","mathspeak.sbrief"),(0,sre.MathspeakSpanish.defineRuleAlias_)("cancel-reverse","self::underscore",'name(children/*[2])="enclose"','children/*[2][@role="updiagonalstrike" or @role="downdiagonalstrike" or @role="horizontalstrike"]'),(0,sre.MathspeakSpanish.defineRule_)("end-punct","mathspeak.default","[m] children/*","self::punctuated",'@role="endpunct"'),(0,sre.MathspeakSpanish.defineRule_)("start-punct","mathspeak.default","[n] content/*[1]; [m] children/*[position()>1]","self::punctuated",'@role="startpunct"'),(0,sre.MathspeakSpanish.defineRule_)("integral-punct","mathspeak.default","[n] children/*[1]; [n] children/*[3]","self::punctuated",'@role="integral"'),(0,sre.MathspeakSpanish.defineRule_)("punctuated","mathspeak.default","[m] children/*","self::punctuated"),(0,sre.MathspeakSpanish.defineRule_)("unit","mathspeak.default",'[t] text() (grammar:annotation="unit":translate)',"self::identifier",'@role="unit"'),(0,sre.MathspeakSpanish.defineRule_)("unit","mathspeak.default",'[t] text() (grammar:annotation="unit":translate:plural)',"self::identifier",'@role="unit"','not(contains(@grammar, "singularUnit"))'),(0,sre.MathspeakSpanish.defineRule_)("unit-square","mathspeak.default",'[t] "square"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=2]",'name(children/*[1])="identifier"'),(0,sre.MathspeakSpanish.defineRule_)("unit-cubic","mathspeak.default",'[t] "cubic"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=3]",'name(children/*[1])="identifier"'),(0,sre.MathspeakSpanish.defineRule_)("reciprocal","mathspeak.default",'[t] "reciprocal"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'count(preceding-sibling::*)=0 or preceding-sibling::*[@role!="unit"]'),(0,sre.MathspeakSpanish.defineRule_)("reciprocal","mathspeak.default",'[t] "per"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'preceding-sibling::*[@role="unit"]'),(0,sre.MathspeakSpanish.defineRule_)("unit-combine","mathspeak.default","[m] children/* (sepFunc:CTXFunitMultipliers)","self::infixop",'@role="unit"'),(0,sre.MathspeakSpanish.defineRule_)("unit-combine","mathspeak.default","[m] children/* (sepFunc:CTXFunitMultipliers);","self::infixop",'@role="multiplication" or @role="implicit"','children/*[@role="unit"]'),(0,sre.MathspeakSpanish.defineRule_)("unit-combine","mathspeak.default","[n] . (grammar:singularUnit);","self::infixop",'@role="multiplication" or @role="implicit"','children/*[@role="unit"]','not(contains(@grammar, "singularUnit"))',"CQFoneLeft"),(0,sre.MathspeakSpanish.defineRule_)("unit-divide","mathspeak.default",'[n] children/*[1]; [t] "per"; [n] children/*[2]',"self::fraction",'@role="unit"')},sre.MathspeakSpanish.componentString_={2:"CSFbaseline",1:"CSFsubscript",0:"CSFsuperscript"},sre.MathspeakSpanish.childNumber_={4:2,3:3,2:1,1:4,0:5},sre.MathspeakSpanish.generateTensorRuleStrings_=function(e){var t=[],r="",s="";e=parseInt(e,2);for(var n=0;n<5;n++){var i,a="children/*["+sre.MathspeakSpanish.childNumber_[n]+"]";1&e?(r="[t] "+(i=sre.MathspeakSpanish.componentString_[n%3])+"Verbose; [n] "+a+";"+r,s="[t] "+i+"Brief; [n] "+a+";"+s):t.unshift("name("+a+')="empty"'),e>>=1}return t.push(r),t.push(s),t},sre.MathspeakSpanish.generateMathspeakTensorRules_=function(){for(var e="11111 11110 11101 11100 10111 10110 10101 10100 01111 01110 01101 01100".split(" "),t=0;r=e[t];t++){var r,s="tensor"+r,n=(r=sre.MathspeakSpanish.generateTensorRuleStrings_(r)).pop(),i=r.pop(),a=[s,"mathspeak.default",i,"self::tensor"].concat(r),o=[s,"mathspeak.brief",n,"self::tensor"].concat(r);sre.MathspeakSpanish.defineRule_.apply(null,a),sre.MathspeakSpanish.defineRule_.apply(null,o),(0,sre.MathspeakSpanish.defineSpecialisedRule_)(s,"mathspeak.brief","mathspeak.sbrief"),n+="; [t]"+(a=sre.MathspeakSpanish.componentString_[2])+"Brief",a=[s+="-baseline","mathspeak.default",i+="; [t]"+a+"Verbose","self::tensor","following-sibling::*"].concat(r),o=[s,"mathspeak.brief",n,"self::tensor","following-sibling::*"].concat(r),sre.MathspeakSpanish.defineRule_.apply(null,a),sre.MathspeakSpanish.defineRule_.apply(null,o),(0,sre.MathspeakSpanish.defineSpecialisedRule_)(s,"mathspeak.brief","mathspeak.sbrief"),s=[s,"self::tensor","not(following-sibling::*)","ancestor::fraction|ancestor::punctuated|ancestor::fenced|ancestor::root|ancestor::sqrt|ancestor::relseq|ancestor::multirel|@embellished"].concat(r),sre.MathspeakSpanish.defineRuleAlias_.apply(null,s)}},sre.MathspeakSpanish.getInstance().initializer=[sre.MathspeakSpanish.initCustomFunctions_,sre.MathspeakSpanish.initMathspeakSpanish_,sre.MathspeakSpanish.generateMathspeakTensorRules_],sre.PrefixRules=function(){sre.MathStore.call(this)},goog.inherits(sre.PrefixRules,sre.MathStore),goog.addSingletonGetter(sre.PrefixRules),sre.PrefixRules.mathStore=sre.PrefixRules.getInstance(),sre.PrefixRules.defineRule_=goog.bind(sre.PrefixRules.mathStore.defineRule,sre.PrefixRules.mathStore),sre.PrefixRules.defineRuleAlias_=goog.bind(sre.PrefixRules.mathStore.defineRulesAlias,sre.PrefixRules.mathStore),sre.PrefixRules.addCustomString_=goog.bind(sre.PrefixRules.mathStore.customStrings.add,sre.PrefixRules.mathStore.customStrings),sre.PrefixRules.ordinalPosition=function(e){var t=sre.DomUtil.toArray(e.parentNode.childNodes);return sre.MathspeakUtil.simpleOrdinal(t.indexOf(e)+1).toString()},sre.PrefixRules.initCustomFunctions_=function(){(0,sre.PrefixRules.addCustomString_)("CSFordinalPosition",sre.PrefixRules.ordinalPosition)},sre.PrefixRules.initPrefixRules_=function(){(0,sre.PrefixRules.defineRule_)("numerator","prefix.default",'[t] "Numerator"; [p] (pause:200)',"self::*",'name(../..)="fraction"',"count(preceding-sibling::*)=0"),(0,sre.PrefixRules.defineRule_)("denominator","prefix.default",'[t] "Denominator"; [p] (pause:200)',"self::*",'name(../..)="fraction"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("base","prefix.default",'[t] "Base"; [p] (pause:200)',"self::*",'name(../..)="superscript" or name(../..)="subscript" or name(../..)="overscore" or name(../..)="underscore" or name(../..)="tensor"',"count(preceding-sibling::*)=0"),(0,sre.PrefixRules.defineRule_)("exponent","prefix.default",'[t] "Exponent"; [p] (pause:200)',"self::*",'name(../..)="superscript"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("subscript","prefix.default",'[t] "Subscript"; [p] (pause:200)',"self::*",'name(../..)="subscript"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("overscript","prefix.default",'[t] "Overscript"; [p] (pause:200)',"self::*",'name(../..)="overscore"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("underscript","prefix.default",'[t] "Underscript"; [p] (pause:200)',"self::*",'name(../..)="underscore"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("radicand","prefix.default",'[t] "Radicand"; [p] (pause:200)',"self::*",'name(../..)="sqrt"'),(0,sre.PrefixRules.defineRule_)("radicand","prefix.default",'[t] "Radicand"; [p] (pause:200)',"self::*",'name(../..)="root"',"count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("index","prefix.default",'[t] "Index"; [p] (pause:200)',"self::*",'name(../..)="root"',"count(preceding-sibling::*)=0"),(0,sre.PrefixRules.defineRule_)("leftsub","prefix.default",'[t] "Left Subscript"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="leftsub"'),(0,sre.PrefixRules.defineRule_)("leftsub","prefix.default",'[t] CSFordinalPosition; [t] "Left Subscript"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="leftsub"'),(0,sre.PrefixRules.defineRule_)("leftsuper","prefix.default",'[t] "Left Superscript"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="leftsuper"'),(0,sre.PrefixRules.defineRule_)("leftsuper","prefix.default",'[t] CSFordinalPosition; [t] "Left Superscript"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="leftsuper"'),(0,sre.PrefixRules.defineRule_)("rightsub","prefix.default",'[t] "Right Subscript"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="rightsub"'),(0,sre.PrefixRules.defineRule_)("rightsub","prefix.default",'[t] CSFordinalPosition; [t] "Right Subscript"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="rightsub"'),(0,sre.PrefixRules.defineRule_)("rightsuper","prefix.default",'[t] "Right Superscript"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="rightsuper"'),(0,sre.PrefixRules.defineRule_)("rightsuper","prefix.default",'[t] CSFordinalPosition; [t] "Right Superscript"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="rightsuper"'),(0,sre.PrefixRules.defineRule_)("choice","prefix.default",'[t] "Choice Quantity"; [p] (pause:200)',"self::line",'@role="binomial"',"parent::*/parent::vector","count(preceding-sibling::*)=0"),(0,sre.PrefixRules.defineRule_)("select","prefix.default",'[t] "Selection Quantity"; [p] (pause:200)',"self::line",'@role="binomial"',"parent::*/parent::vector","count(preceding-sibling::*)=1"),(0,sre.PrefixRules.defineRule_)("row","prefix.default",'[t] CSFordinalPosition; [t] "Row"; [p] (pause:200)',"self::row"),(0,sre.PrefixRules.defineRuleAlias_)("row","self::line"),(0,sre.PrefixRules.defineRule_)("cell","prefix.default",'[n] ../..; [t] CSFordinalPosition; [t] "Column"; [p] (pause:200)',"self::cell",'contains(@grammar,"depth")'),(0,sre.PrefixRules.defineRule_)("cell","prefix.default",'[t] CSFordinalPosition; [t] "Column"; [p] (pause:200)',"self::cell")},sre.PrefixRules.getInstance().initializer=[sre.PrefixRules.initCustomFunctions_,sre.PrefixRules.initPrefixRules_],sre.PrefixSpanish=function(){sre.MathStore.call(this),this.locale="es"},goog.inherits(sre.PrefixSpanish,sre.MathStore),goog.addSingletonGetter(sre.PrefixSpanish),sre.PrefixSpanish.mathStore=sre.PrefixSpanish.getInstance(),sre.PrefixSpanish.defineRule_=goog.bind(sre.PrefixSpanish.mathStore.defineRule,sre.PrefixSpanish.mathStore),sre.PrefixSpanish.defineRuleAlias_=goog.bind(sre.PrefixSpanish.mathStore.defineRulesAlias,sre.PrefixSpanish.mathStore),sre.PrefixSpanish.addCustomString_=goog.bind(sre.PrefixSpanish.mathStore.customStrings.add,sre.PrefixSpanish.mathStore.customStrings),sre.PrefixSpanish.ordinalPosition=function(e){var t=sre.DomUtil.toArray(e.parentNode.childNodes);return sre.MathspeakUtil.simpleOrdinal(t.indexOf(e)+1).toString()},sre.PrefixSpanish.initCustomFunctions_=function(){(0,sre.PrefixSpanish.addCustomString_)("CSFordinalPosition",sre.PrefixSpanish.ordinalPosition)},sre.PrefixSpanish.initPrefixSpanish_=function(){(0,sre.PrefixSpanish.defineRule_)("numerator","prefix.default",'[t] "numerador"; [p] (pause:200)',"self::*",'name(../..)="fraction"',"count(preceding-sibling::*)=0"),(0,sre.PrefixSpanish.defineRule_)("denominator","prefix.default",'[t] "denominador"; [p] (pause:200)',"self::*",'name(../..)="fraction"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("base","prefix.default",'[t] "base"; [p] (pause:200)',"self::*",'name(../..)="superscript" or name(../..)="subscript" or name(../..)="overscore" or name(../..)="underscore" or name(../..)="tensor"',"count(preceding-sibling::*)=0"),(0,sre.PrefixSpanish.defineRule_)("exponent","prefix.default",'[t] "exponente"; [p] (pause:200)',"self::*",'name(../..)="superscript"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("subscript","prefix.default",'[t] "subndice"; [p] (pause:200)',"self::*",'name(../..)="subscript"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("overscript","prefix.default",'[t] "overscript"; [p] (pause:200)',"self::*",'name(../..)="overscore"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("underscript","prefix.default",'[t] "underscript"; [p] (pause:200)',"self::*",'name(../..)="underscore"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("radicand","prefix.default",'[t] "radicand"; [p] (pause:200)',"self::*",'name(../..)="sqrt"'),(0,sre.PrefixSpanish.defineRule_)("radicand","prefix.default",'[t] "radicand"; [p] (pause:200)',"self::*",'name(../..)="root"',"count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("index","prefix.default",'[t] "ndice"; [p] (pause:200)',"self::*",'name(../..)="root"',"count(preceding-sibling::*)=0"),(0,sre.PrefixSpanish.defineRule_)("leftsub","prefix.default",'[t] "subndice izquierdo"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="leftsub"'),(0,sre.PrefixSpanish.defineRule_)("leftsub","prefix.default",'[t] CSFordinalPosition; [t] "subndice izquierdo"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="leftsub"'),(0,sre.PrefixSpanish.defineRule_)("leftsuper","prefix.default",'[t] "superndice izquierdo"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="leftsuper"'),(0,sre.PrefixSpanish.defineRule_)("leftsuper","prefix.default",'[t] CSFordinalPosition; [t] "superndice izquierdo"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="leftsuper"'),(0,sre.PrefixSpanish.defineRule_)("rightsub","prefix.default",'[t] "derecha subndice"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="rightsub"'),(0,sre.PrefixSpanish.defineRule_)("rightsub","prefix.default",'[t] CSFordinalPosition; [t] "derecha subndice"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="rightsub"'),(0,sre.PrefixSpanish.defineRule_)("rightsuper","prefix.default",'[t] "superndice derecho"; [p] (pause:200)',"self::*",'name(../..)="tensor"','@role="rightsuper"'),(0,sre.PrefixSpanish.defineRule_)("rightsuper","prefix.default",'[t] CSFordinalPosition; [t] "superndice derecho"; [p] (pause:200)',"self::*",'name(../..)="punctuated"','name(../../../..)="tensor"','../../@role="rightsuper"'),(0,sre.PrefixSpanish.defineRule_)("choice","prefix.default",'[t] "cantidad de eleccin"; [p] (pause:200)',"self::line",'@role="binomial"',"parent::*/parent::vector","count(preceding-sibling::*)=0"),(0,sre.PrefixSpanish.defineRule_)("select","prefix.default",'[t] "cantidad de seleccin"; [p] (pause:200)',"self::line",'@role="binomial"',"parent::*/parent::vector","count(preceding-sibling::*)=1"),(0,sre.PrefixSpanish.defineRule_)("row","prefix.default",'[t] CSFordinalPosition; [t] "fila"; [p] (pause:200)',"self::row"),(0,sre.PrefixSpanish.defineRuleAlias_)("row","self::line"),(0,sre.PrefixSpanish.defineRule_)("cell","prefix.default",'[n] ../..; [t] CSFordinalPosition; [t] "columna"; [p] (pause:200)',"self::cell",'contains(@grammar,"depth")'),(0,sre.PrefixSpanish.defineRule_)("cell","prefix.default",'[t] CSFordinalPosition; [t] "columna"; [p] (pause:200)',"self::cell")},sre.PrefixSpanish.getInstance().initializer=[sre.PrefixSpanish.initCustomFunctions_,sre.PrefixSpanish.initPrefixSpanish_],sre.SemanticTreeRules=function(){sre.MathStore.call(this)},goog.inherits(sre.SemanticTreeRules,sre.MathStore),goog.addSingletonGetter(sre.SemanticTreeRules),sre.SemanticTreeRules.mathStore=sre.SemanticTreeRules.getInstance(),sre.SemanticTreeRules.defineRule_=goog.bind(sre.SemanticTreeRules.mathStore.defineRule,sre.SemanticTreeRules.mathStore),sre.SemanticTreeRules.defineRuleAlias_=goog.bind(sre.SemanticTreeRules.mathStore.defineRuleAlias,sre.SemanticTreeRules.mathStore),sre.SemanticTreeRules.addContextFunction_=goog.bind(sre.SemanticTreeRules.mathStore.contextFunctions.add,sre.SemanticTreeRules.mathStore.contextFunctions),sre.SemanticTreeRules.initCustomFunctions_=function(){(0,sre.SemanticTreeRules.addContextFunction_)("CTXFnodeCounter",sre.StoreUtil.nodeCounter),(0,sre.SemanticTreeRules.addContextFunction_)("CTXFcontentIterator",sre.MathmlStoreUtil.contentIterator)},sre.SemanticTreeRules.initSemanticRules_=function(){(0,sre.SemanticTreeRules.defineRule_)("stree","default.default","[n] ./*[1]","self::stree"),(0,sre.SemanticTreeRules.defineRule_)("multrel","default.default",'[t] "multirelation"; [m] children/* (sepFunc:CTXFcontentIterator)',"self::multirel"),(0,sre.SemanticTreeRules.defineRule_)("variable-equality","default.default",'[t] "equation sequence"; [m] children/* (context:"part",ctxtFunc:CTXFnodeCounter,sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2",'./children/punctuation[@role="ellipsis"]'),(0,sre.SemanticTreeRules.defineRule_)("multi-equality","default.default",'[t] "equation sequence"; [m] children/* (context:"part",ctxtFunc:CTXFnodeCounter,sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2"),(0,sre.SemanticTreeRules.defineRule_)("multi-equality","default.short",'[t] "equation sequence"; [m] children/* (sepFunc:CTXFcontentIterator)','self::relseq[@role="equality"]',"count(./children/*)>2"),(0,sre.SemanticTreeRules.defineRule_)("equality","default.default","[n] children/*[1]; [p] (pause:200); [n] content/*[1] (pause:200);[n] children/*[2]",'self::relseq[@role="equality"]',"count(./children/*)=2"),(0,sre.SemanticTreeRules.defineRule_)("simple-equality","default.default","[n] children/*[1]; [p] (pause:200); [n] content/*[1] (pause:200);[n] children/*[2]",'self::relseq[@role="equality"]',"count(./children/*)=2","./children/identifier or ./children/number"),(0,sre.SemanticTreeRules.defineRule_)("simple-equality2","default.default","[n] children/*[1]; [p] (pause:200); [n] content/*[1] (pause:200);[n] children/*[2]",'self::relseq[@role="equality"]',"count(./children/*)=2","./children/function or ./children/appl"),(0,sre.SemanticTreeRules.defineRule_)("relseq","default.default","[m] children/* (sepFunc:CTXFcontentIterator)","self::relseq"),(0,sre.SemanticTreeRules.defineRule_)("binary-operation","default.default","[m] children/* (sepFunc:CTXFcontentIterator);","self::infixop"),(0,sre.SemanticTreeRules.defineRule_)("variable-addition","default.default",'[t] "sum with variable number of summands";[p] (pause:400); [m] children/* (sepFunc:CTXFcontentIterator)','self::infixop[@role="addition"]',"count(children/*)>2",'children/punctuation[@role="ellipsis"]'),(0,sre.SemanticTreeRules.defineRule_)("multi-addition","default.default",'[t] "sum with"; [t] count(./children/*); [t] "summands";[p] (pause:400); [m] children/* (sepFunc:CTXFcontentIterator)','self::infixop[@role="addition"]',"count(./children/*)>2"),(0,sre.SemanticTreeRules.defineRule_)("prefix","default.default",'[t] "prefix"; [n] text(); [t] "of" (pause 150);[n] children/*[1]',"self::prefixop"),(0,sre.SemanticTreeRules.defineRule_)("negative","default.default",'[t] "negative"; [n] children/*[1]',"self::prefixop",'self::prefixop[@role="negative"]'),(0,sre.SemanticTreeRules.defineRule_)("postfix","default.default",'[n] children/*[1]; [t] "postfix"; [n] text() (pause 300)',"self::postfixop"),(0,sre.SemanticTreeRules.defineRule_)("identifier","default.default","[n] text()","self::identifier"),(0,sre.SemanticTreeRules.defineRule_)("number","default.default","[n] text()","self::number"),(0,sre.SemanticTreeRules.defineRule_)("mixed-number","default.default",'[n] children/*[1]; [t] "and"; [n] children/*[2]; ',"self::number",'@role="mixed"'),(0,sre.SemanticTreeRules.defineRule_)("font","default.default","[t] @font; [n] . (grammar:ignoreFont=@font)","self::*","@font",'not(contains(@grammar, "ignoreFont"))','@font!="normal"'),(0,sre.SemanticTreeRules.defineRule_)("font-identifier-short","default.default","[t] @font; [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="normal"','""=translate(text(), "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ", "")','@role!="unit"'),(0,sre.SemanticTreeRules.defineRule_)("font-identifier","default.default","[t] @font; [n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'@font="normal"','not(contains(@grammar, "ignoreFont"))','@role!="unit"'),(0,sre.SemanticTreeRules.defineRule_)("omit-font","default.default","[n] . (grammar:ignoreFont=@font)","self::identifier","string-length(text())=1","@font",'not(contains(@grammar, "ignoreFont"))','@font="italic"'),(0,sre.SemanticTreeRules.defineRule_)("fraction","default.default",'[p] (pause:250); [n] children/*[1] (rate:0.35); [p] (pause:250); [t] "divided by"; [n] children/*[2] (rate:-0.35); [p] (pause:400)',"self::fraction"),(0,sre.SemanticTreeRules.defineRule_)("superscript","default.default",'[n] children/*[1]; [t] "super"; [n] children/*[2] (pitch:0.35);[p] (pause:300)',"self::superscript"),(0,sre.SemanticTreeRules.defineRule_)("subscript","default.default",'[n] children/*[1]; [t] "sub"; [n] children/*[2] (pitch:-0.35);[p] (pause:300)',"self::subscript"),(0,sre.SemanticTreeRules.defineRule_)("ellipsis","default.default",'[p] (pause:200); [t] "ellipsis"; [p] (pause:300)',"self::punctuation",'self::punctuation[@role="ellipsis"]'),(0,sre.SemanticTreeRules.defineRule_)("fence-single","default.default","[n] text()","self::punctuation",'self::punctuation[@role="openfence"]'),(0,sre.SemanticTreeRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="closefence"]'),(0,sre.SemanticTreeRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="vbar"]'),(0,sre.SemanticTreeRules.defineRuleAlias_)("fence-single","self::punctuation",'self::punctuation[@role="application"]'),(0,sre.SemanticTreeRules.defineRule_)("omit-empty","default.default","[p] (pause:100)","self::empty"),(0,sre.SemanticTreeRules.defineRule_)("fences-open-close","default.default","[p] (pause:100); [n] content/*[1]; [n] children/*[1]; [n] content/*[2]; [p] (pause:100)","self::fenced",'@role="leftright"'),(0,sre.SemanticTreeRules.defineRule_)("fences-open-close-in-appl","default.default","[p] (pause:200); [n] children/*[1]; [p] (pause:200);",'self::fenced[@role="leftright"]',"./parent::children/parent::appl"),(0,sre.SemanticTreeRules.defineRule_)("fences-neutral","default.default",'[p] (pause:100); [t] "absolute value of"; [n] children/*[1];[p] (pause:350);',"self::fenced",'self::fenced[@role="neutral"]'),(0,sre.SemanticTreeRules.defineRule_)("omit-fences","default.default","[p] (pause:500); [n] children/*[1]; [p] (pause:200);","self::fenced"),(0,sre.SemanticTreeRules.defineRule_)("matrix","default.default",'[t] "matrix"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:100)',"self::matrix"),(0,sre.SemanticTreeRules.defineRule_)("matrix-row","default.default",'[m] children/* (ctxtFunc:CTXFnodeCounter,context:"column",pause:100)','self::row[@role="matrix"]'),(0,sre.SemanticTreeRules.defineRule_)("matrix-cell","default.default","[n] children/*[1]",'self::cell[@role="matrix"]'),(0,sre.SemanticTreeRules.defineRule_)("vector","default.default",'[t] "vector"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"element",pause:100)',"self::vector"),(0,sre.SemanticTreeRules.defineRule_)("cases","default.default",'[t] "case statement"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"case",pause:100)',"self::cases"),(0,sre.SemanticTreeRules.defineRule_)("cases-row","default.default","[m] children/*",'self::row[@role="cases"]'),(0,sre.SemanticTreeRules.defineRule_)("cases-cell","default.default","[n] children/*[1]",'self::cell[@role="cases"]'),(0,sre.SemanticTreeRules.defineRule_)("row","default.default",'[m] ./* (ctxtFunc:CTXFnodeCounter,context:"column",pause:100)',"self::row"),(0,sre.SemanticTreeRules.defineRule_)("cases-end","default.default",'[t] "case statement"; [m] children/* (ctxtFunc:CTXFnodeCounter,context:"case",pause:100);[t] "end cases"',"self::cases","following-sibling::*"),(0,sre.SemanticTreeRules.defineRule_)("multiline","default.default",'[t] "multiline equation";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"line",pause:100)',"self::multiline"),(0,sre.SemanticTreeRules.defineRule_)("multiline-ineq","default.default",'[t] "multiline inequality";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:100)',"self::multiline",'@role="inequality"'),(0,sre.SemanticTreeRules.defineRule_)("line","default.default","[m] children/*","self::line"),(0,sre.SemanticTreeRules.defineRule_)("table","default.default",'[t] "multiline equation";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:200)',"self::table"),(0,sre.SemanticTreeRules.defineRule_)("table-ineq","default.default",'[t] "multiline inequality";[m] children/* (ctxtFunc:CTXFnodeCounter,context:"row",pause:200)',"self::table",'@role="inequality"'),(0,sre.SemanticTreeRules.defineRule_)("table-row","default.default","[m] children/* (pause:100)",'self::row[@role="table"]'),(0,sre.SemanticTreeRules.defineRuleAlias_)("cases-cell",'self::cell[@role="table"]'),(0,sre.SemanticTreeRules.defineRule_)("empty-cell","mathspeak.default",'[t] "Blank"',"self::cell","count(children/*)=0"),(0,sre.SemanticTreeRules.defineRule_)("end-punct","default.default","[m] children/*; [p] (pause:300)","self::punctuated",'@role="endpunct"'),(0,sre.SemanticTreeRules.defineRule_)("start-punct","default.default","[n] content/*[1]; [p] (pause:200); [m] children/*[position()>1]","self::punctuated",'@role="startpunct"'),(0,sre.SemanticTreeRules.defineRule_)("integral-punct","default.default","[n] children/*[1] (rate:0.2); [n] children/*[3] (rate:0.2)","self::punctuated",'@role="integral"'),(0,sre.SemanticTreeRules.defineRule_)("punctuated","default.default","[m] children/* (pause:100)","self::punctuated"),(0,sre.SemanticTreeRules.defineRule_)("function","default.default","[n] text()","self::function"),(0,sre.SemanticTreeRules.defineRule_)("appl","default.default","[n] children/*[1]; [n] content/*[1]; [n] children/*[2]","self::appl"),(0,sre.SemanticTreeRules.defineRule_)("sum-only","default.default",'[n] children/*[1]; [t] "from"; [n] children/*[2]; [t] "to";[n] children/*[3]',"self::limboth",'self::limboth[@role="sum"]'),(0,sre.SemanticTreeRules.defineRule_)("limboth","default.default",'[n] children/*[1]; [p] (pause 100); [t] "over"; [n] children/*[2];[t] "under"; [n] children/*[3]; [p] (pause 250);',"self::limboth"),(0,sre.SemanticTreeRules.defineRule_)("limlower","default.default",'[n] children/*[1]; [t] "over"; [n] children/*[2];',"self::limlower"),(0,sre.SemanticTreeRules.defineRule_)("limupper","default.default",'[n] children/*[1]; [t] "under"; [n] children/*[2];',"self::limupper"),(0,sre.SemanticTreeRules.defineRule_)("largeop","default.default","[n] text()","self::largeop"),(0,sre.SemanticTreeRules.defineRule_)("bigop","default.default",'[n] children/*[1]; [p] (pause 100); [t] "over"; [n] children/*[2];[p] (pause 250);',"self::bigop"),(0,sre.SemanticTreeRules.defineRule_)("integral","default.default","[n] children/*[1]; [p] (pause 100); [n] children/*[2];[p] (pause 200); [n] children/*[3] (rate:0.35);","self::integral"),(0,sre.SemanticTreeRules.defineRule_)("sqrt","default.default",'[t] "Square root of"; [n] children/*[1] (rate:0.35); [p] (pause:400)',"self::sqrt"),(0,sre.SemanticTreeRules.defineRule_)("square","default.default",'[n] children/*[1]; [t] "squared" (pitch:0.35); [p] (pause:300)',"self::superscript","children/*[2][text()=2]",'name(./children/*[1])!="text"'),(0,sre.SemanticTreeRules.defineRule_)("cube","default.default",'[n] children/*[1]; [t] "cubed" (pitch:0.35); [p] (pause:300)',"self::superscript","children/*[2][text()=3]",'name(./children/*[1])!="text"'),(0,sre.SemanticTreeRules.defineRule_)("root","default.default",'[t] "root of order"; [n] children/*[1];[t] "over"; [n] children/*[1] (rate:0.35); [p] (pause:400)',"self::root"),(0,sre.SemanticTreeRules.defineRule_)("text","default.default","[n] text(); [p] (pause:200)","self::text"),(0,sre.SemanticTreeRules.defineRule_)("unit","default.default",'[t] text() (grammar:annotation="unit":translate)',"self::identifier",'@role="unit"'),(0,sre.SemanticTreeRules.defineRule_)("unit-square","default.default",'[t] "square"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=2]",'name(children/*[1])="identifier"'),(0,sre.SemanticTreeRules.defineRule_)("unit-cubic","default.default",'[t] "cubic"; [n] children/*[1]',"self::superscript",'@role="unit"',"children/*[2][text()=3]",'name(children/*[1])="identifier"'),(0,sre.SemanticTreeRules.defineRule_)("reciprocal","default.default",'[t] "reciprocal"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'count(preceding-sibling::*)=0 or preceding-sibling::*[@role!="unit"]'),(0,sre.SemanticTreeRules.defineRule_)("reciprocal","default.default",'[t] "per"; [n] children/*[1]',"self::superscript",'@role="unit"','name(children/*[1])="identifier"','name(children/*[2])="prefixop"','children/*[2][@role="negative"]',"children/*[2]/children/*[1][text()=1]",'preceding-sibling::*[@role="unit"]'),(0,sre.SemanticTreeRules.defineRule_)("unit-combine","default.default","[m] children/*","self::infixop",'@role="unit"'),(0,sre.SemanticTreeRules.defineRule_)("unit-divide","default.default",'[n] children/*[1] (pitch:0.3); [t] "per"; [n] children/*[2] (pitch:-0.3)',"self::fraction",'@role="unit"')},sre.SemanticTreeRules.getInstance().initializer=[sre.SemanticTreeRules.initCustomFunctions_,sre.SemanticTreeRules.initSemanticRules_],sre.SpeechRuleStores={},sre.SpeechRuleStores.RULE_SETS_={MathmlStoreRules:sre.MathmlStoreRules,SemanticTreeRules:sre.SemanticTreeRules,MathspeakRules:sre.MathspeakRules,MathspeakSpanish:sre.MathspeakSpanish,ClearspeakRules:sre.ClearspeakRules,EmacspeakRules:sre.EmacspeakRules,AbstractionRules:sre.AbstractionRules,AbstractionSpanish:sre.AbstractionSpanish,PrefixRules:sre.PrefixRules,PrefixSpanish:sre.PrefixSpanish},sre.SpeechRuleStores.availableSets=function(){return Object.keys(sre.SpeechRuleStores.RULE_SETS_)},sre.SpeechRuleStores.getConstructor=function(e){return(e=sre.SpeechRuleStores.RULE_SETS_[e])?e:null},sre.SpeechRuleEngine=function(){this.activeStore_=null,this.cache_={},this.ready_=!0,this.combinedStores_={},sre.Engine.registerTest(goog.bind(function(e){return this.ready_},this))},goog.addSingletonGetter(sre.SpeechRuleEngine),sre.SpeechRuleEngine.prototype.parameterize=function(e){for(var t={},r=0,s=e.length;r<s;r++){var n=e[r],i=sre.SpeechRuleStores.getConstructor(n);i&&i.getInstance&&(t[n]=i.getInstance())}this.parameterize_(t)},sre.SpeechRuleEngine.prototype.parameterize_=function(e){try{this.activeStore_=this.combineStores_(e)}catch(e){if("StoreError"!=e.name)throw e;console.log("Store Error:",e.message)}this.updateEngine()},sre.SpeechRuleEngine.prototype.constructString=function(e,t){if(!t)return"";if('"'==t.charAt(0))return t.slice(1,-1);var r=this.activeStore_.customStrings.lookup(t);return r?r(e):sre.XpathUtil.evaluateString(t,e)},sre.SpeechRuleEngine.prototype.clearCache=function(){this.cache_={}},sre.SpeechRuleEngine.prototype.forCache=function(e){for(var t in this.cache_)e(t,this.cache_[t])},sre.SpeechRuleEngine.prototype.getCacheForNode_=function(e){return!e||!e.getAttribute||"undefined"===(e=e.getAttribute("id"))||""===e?null:this.getCache(e)},sre.SpeechRuleEngine.prototype.getCache=function(e){return(e=this.cache_[e])?this.cloneCache(e):e},sre.SpeechRuleEngine.prototype.cloneCache=function(e){return e.map(function(e){return e.clone()})},sre.SpeechRuleEngine.prototype.pushCache_=function(e,t){sre.Engine.getInstance().cache&&e.getAttribute&&(e=e.getAttribute("id"))&&(this.cache_[e]=this.cloneCache(t))},sre.SpeechRuleEngine.prototype.evaluateNode=function(e){var t=(new Date).getTime(),r=(e=this.evaluateNode_(e),(new Date).getTime());return sre.Debugger.getInstance().output("Time:",r-t),e},sre.SpeechRuleEngine.prototype.evaluateNode_=function(e){return e?(this.updateConstraint_(),this.evaluateTree_(e)):[]},sre.SpeechRuleEngine.prototype.evaluateTree_=function(e){if((n=sre.Engine.getInstance()).cache){var t=this.getCacheForNode_(e);if(t)return t}sre.Grammar.getInstance().setAttribute(e);var r=this.activeStore_.lookupRule(e,n.dynamicCstr);if(!r)return n.strict?[]:(t=this.activeStore_.evaluateDefault(e),this.pushCache_(e,t),t);sre.Debugger.getInstance().generateOutput(goog.bind(function(){return[r.name,r.dynamicCstr.toString(),e.toString()]},this));for(var s,n=r.action.components,t=[],i=0;s=n[i];i++){var a=[],o=s.content||"",l=s.attributes||{};switch(s.grammar&&this.processGrammar(e,s.grammar),s.type){case sre.SpeechRule.Type.NODE:(o=this.activeStore_.applyQuery(e,o))&&(a=this.evaluateTree_(o));break;case sre.SpeechRule.Type.MULTI:0<(o=this.activeStore_.applySelector(e,o)).length&&(a=this.evaluateNodeList_(o,l.sepFunc,this.constructString(e,l.separator),l.ctxtFunc,this.constructString(e,l.context)));break;case sre.SpeechRule.Type.TEXT:(o=this.constructString(e,o))&&(a=[sre.AuditoryDescription.create({text:o},{adjust:!0})]);break;default:a=[sre.AuditoryDescription.create({text:o})]}a[0]&&s.type!=sre.SpeechRule.Type.MULTI&&(l.context&&(a[0].context=this.constructString(e,l.context)+(a[0].context||"")),l.annotation&&(a[0].annotation=l.annotation)),s.grammar&&sre.Grammar.getInstance().popState(),t=t.concat(this.addPersonality_(a,l))}return this.pushCache_(e,t),t},sre.SpeechRuleEngine.prototype.evaluateNodeList_=function(e,t,r,s,n){if(e==[])return[];var i,a=r||"",o=n||"";for(r=(r=this.activeStore_.contextFunctions.lookup(s))?r(e,o):function(){return o},t=(t=this.activeStore_.contextFunctions.lookup(t))?t(e,a):function(){return sre.AuditoryDescription.create({text:a},{translate:!0})},s=[],n=0;i=e[n];n++)0<(i=this.evaluateTree_(i)).length&&(i[0].context=r()+(i[0].context||""),s=s.concat(i),n<e.length-1&&(i=t(),s=s.concat(i)));return s},sre.SpeechRuleEngine.prototype.addPersonality_=function(e,t){var r,s={};for(r in sre.Engine.personalityProps){var n=parseFloat(t[sre.Engine.personalityProps[r]]);isNaN(n)||(s[sre.Engine.personalityProps[r]]=n)}for(t=0;r=e[t];t++)this.addRelativePersonality_(r,s);return e},sre.SpeechRuleEngine.prototype.addRelativePersonality_=function(e,t){if(!e.personality)return e.personality=t,e;var r,s=e.personality;for(r in t)s[r]=s[r]&&"number"==typeof s[r]?s[r]+t[r]:t[r];return e},sre.SpeechRuleEngine.prototype.toString=function(){return this.activeStore_.findAllRules(function(e){return!0}).map(function(e){return e.toString()}).join("\n")},sre.SpeechRuleEngine.debugSpeechRule=function(e,t){var r=sre.SpeechRuleEngine.getInstance().activeStore_;r&&r.debugSpeechRule(e,t)},sre.SpeechRuleEngine.debugNamedSpeechRule=function(t,e){var r=sre.SpeechRuleEngine.getInstance().activeStore_;if(r)for(var s,n=r.findAllRules(function(e){return e.name==t}),i=0;s=n[i];i++)sre.Debugger.getInstance().output("Rule",t,"DynamicCstr:",s.dynamicCstr.toString(),"number",i),r.debugSpeechRule(s,e)},sre.SpeechRuleEngine.prototype.runInSetting=function(e,t){var r,s=sre.Engine.getInstance(),n={},i=null;for(r in e)"rules"===r?(i=this.activeStore_,s.ruleSets=e[r],this.parameterize(s.ruleSets)):(n[r]=s[r],s[r]=e[r]);for(r in s.dynamicCstr=sre.DynamicCstr.create(s.locale,s.domain,s.style),e=t(),n)s[r]=n[r];return i&&(this.activeStore_=i),s.dynamicCstr=sre.DynamicCstr.create(s.locale,s.domain,s.style),e},sre.SpeechRuleEngine.prototype.combineStores_=function(e){var t,r=this.cachedStore_(e);if(r)return r;for(t in r=new sre.MathStore,e){var s=e[t];s.initialize(),s.getSpeechRules().forEach(function(e){r.trie.addRule(e)}),r.contextFunctions.addStore(s.contextFunctions),r.customQueries.addStore(s.customQueries),r.customStrings.addStore(s.customStrings)}return r.setSpeechRules(r.trie.collectRules()),this.combinedStores_[this.combinedStoreName_(Object.keys(e))]=r},sre.SpeechRuleEngine.prototype.combinedStoreName_=function(e){return e.sort().join("-")},sre.SpeechRuleEngine.prototype.cachedStore_=function(t){var e=Object.keys(t);return e.some(function(e){return!t[e].initialized})?null:this.combinedStores_[this.combinedStoreName_(e)]},sre.SpeechRuleEngine.prototype.updateEngine=function(){this.ready_=!0;var e=sre.MathMap.getInstance();sre.Engine.isReady()?sre.Engine.getInstance().evaluator=goog.bind(e.store.lookupString,e.store):(this.ready_=!1,setTimeout(goog.bind(this.updateEngine,this),250))},sre.SpeechRuleEngine.prototype.processGrammar=function(e,t){var r,s={};for(r in t){var n=t[r];s[r]="string"==typeof n?this.constructString(e,n):n}sre.Grammar.getInstance().pushState(s)},sre.SpeechRuleEngine.prototype.updateConstraint_=function(){var s=sre.Engine.getInstance().dynamicCstr,n=sre.Engine.getInstance().strict,i={},e=[s.getValue(sre.DynamicCstr.Axis.LOCALE),s.getValue(sre.DynamicCstr.Axis.DOMAIN)],t=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],r=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN],a=this.activeStore_.trie.hasSubtrie(e);i[sre.DynamicCstr.Axis.LOCALE]=[a?e[0]:t],a=a||this.activeStore_.trie.hasSubtrie([t,e[1]]),i[sre.DynamicCstr.Axis.DOMAIN]=[a?e[1]:r],s.getOrder().forEach(function(e){var t,r;i[e]||(t=s.getValue(e),r=sre.DynamicCstr.DEFAULT_VALUES[e],i[e]=n||t===r?[t]:[t,r])}),s.updateProperties(i)},sre.SpeechGeneratorUtil={},sre.SpeechGeneratorUtil.computeSpeech=function(e){var t=sre.SpeechRuleEngine.getInstance();return t.clearCache(),t.evaluateNode(e)},sre.SpeechGeneratorUtil.recomputeSpeech=function(e){return e=sre.SemanticTree.fromNode(e),sre.SpeechRuleEngine.getInstance().evaluateNode(e.xml())},sre.SpeechGeneratorUtil.computeSpeechWithoutCache=function(e){var t=sre.Engine.getInstance().cache;return sre.Engine.getInstance().cache=!1,e=sre.SpeechRuleEngine.getInstance().evaluateNode(e),sre.Engine.getInstance().cache=t,e},sre.SpeechGeneratorUtil.retrieveSpeech=function(e){var t=null,t=(t=sre.Engine.getInstance().cache?sre.SpeechRuleEngine.getInstance().getCache(e.id.toString()):t)||sre.SpeechGeneratorUtil.recomputeSpeech(e);return sre.AuralRendering.getInstance().markup(t)},sre.SpeechGeneratorUtil.addSpeech=function(e,t){t=sre.SpeechGeneratorUtil.retrieveSpeech(t),e.setAttribute(sre.EnrichMathml.Attribute.SPEECH,t)},sre.SpeechGeneratorUtil.addPrefix=function(e,t){(t=sre.SpeechGeneratorUtil.retrievePrefix(t))&&e.setAttribute(sre.EnrichMathml.Attribute.PREFIX,t)},sre.SpeechGeneratorUtil.retrievePrefix=function(e){return e=sre.SpeechGeneratorUtil.computePrefix_(e),sre.AuralRendering.getInstance().markup(e)},sre.SpeechGeneratorUtil.computePrefix_=function(e){var t=sre.SemanticTree.fromRoot(e),r=sre.XpathUtil.evalXPath('.//*[@id="'+e.id+'"]',t.xml())[0];return r?sre.SpeechRuleEngine.getInstance().runInSetting({domain:"prefix",style:"default",strict:!0,cache:!1,speech:!0,rules:["PrefixRules","PrefixSpanish"]},function(){return sre.SpeechRuleEngine.getInstance().evaluateNode(r)}):[]},sre.SpeechGeneratorUtil.connectMactions=function(e,t,r){t=sre.DomUtil.querySelectorAll(t,"maction");for(var s=0;i=t[s];s++){var n,i,a,o=i.getAttribute("id");(o=sre.DomUtil.querySelectorAllByAttrValue(e,"id",o)[0])&&(i=(n=i.childNodes[1]).getAttribute(sre.EnrichMathml.Attribute.ID),(a=sre.WalkerUtil.getBySemanticId(e,i))&&"dummy"!==a.getAttribute(sre.EnrichMathml.Attribute.TYPE)||(a=o.childNodes[0],(o=n.getAttribute(sre.EnrichMathml.Attribute.PARENT))&&a.setAttribute(sre.EnrichMathml.Attribute.PARENT,o),a.setAttribute(sre.EnrichMathml.Attribute.TYPE,"dummy"),a.setAttribute(sre.EnrichMathml.Attribute.ID,i),sre.DomUtil.querySelectorAllByAttrValue(r,"id",i)[0].setAttribute("alternative",i)))}},sre.SpeechGeneratorUtil.connectAllMactions=function(e,t){e=sre.DomUtil.querySelectorAll(e,"maction");for(var r,s=0;r=e[s];s++)r=r.childNodes[1].getAttribute(sre.EnrichMathml.Attribute.ID),sre.DomUtil.querySelectorAllByAttrValue(t,"id",r)[0].setAttribute("alternative",r)},sre.AbstractSpeechGenerator=function(){this.rebuilt_=null},sre.AbstractSpeechGenerator.prototype.getRebuilt=function(){return this.rebuilt_},sre.AbstractSpeechGenerator.prototype.setRebuilt=function(e){this.rebuilt_=e},sre.AbstractSpeechGenerator.prototype.getSpeech=goog.abstractMethod,sre.AbstractSpeechGenerator.prototype.start=function(){},sre.AbstractSpeechGenerator.prototype.end=function(){},sre.AbstractSpeechGenerator.prototype.generateSpeech=function(e,t){return this.rebuilt_||(this.rebuilt_=new sre.RebuildStree(t)),e=sre.SpeechGeneratorUtil.computeSpeech(this.getRebuilt().xml),sre.AuralRendering.getInstance().markup(e)},sre.AdhocSpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.AdhocSpeechGenerator,sre.AbstractSpeechGenerator),sre.AdhocSpeechGenerator.prototype.getSpeech=function(e,t){return t=this.generateSpeech(e,t),e.setAttribute(sre.EnrichMathml.Attribute.SPEECH,t),t},sre.DirectSpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.DirectSpeechGenerator,sre.AbstractSpeechGenerator),sre.DirectSpeechGenerator.prototype.getSpeech=function(e,t){return sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.SPEECH)},sre.DummySpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.DummySpeechGenerator,sre.AbstractSpeechGenerator),sre.DummySpeechGenerator.prototype.getSpeech=function(e,t){return""},sre.TreeSpeechGenerator=function(){},goog.inherits(sre.TreeSpeechGenerator,sre.AbstractSpeechGenerator),sre.TreeSpeechGenerator.prototype.getSpeech=function(e,t){var r,s=this.generateSpeech(e,t),n=(e.setAttribute(sre.EnrichMathml.Attribute.SPEECH,s),this.getRebuilt().nodeDict);for(r in n){var i=n[r],a=sre.WalkerUtil.getBySemanticId(t,r),o=sre.WalkerUtil.getBySemanticId(e,r);a&&o&&(sre.SpeechGeneratorUtil.addSpeech(o,i),sre.SpeechGeneratorUtil.addPrefix(o,i))}return s},sre.NodeSpeechGenerator=function(){sre.TreeSpeechGenerator.call(this)},goog.inherits(sre.NodeSpeechGenerator,sre.TreeSpeechGenerator),sre.NodeSpeechGenerator.prototype.getSpeech=function(e,t){var r=sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.SPEECH);return r||sre.NodeSpeechGenerator.superClass_.getSpeech.call(this,e,t)},sre.SummarySpeechGenerator=function(){},goog.inherits(sre.SummarySpeechGenerator,sre.AbstractSpeechGenerator),sre.SummarySpeechGenerator.prototype.getSpeech=function(e,t){return sre.SpeechGeneratorUtil.connectAllMactions(t,this.getRebuilt().xml),this.generateSpeech(e,t)},sre.SpeechGeneratorFactory={},sre.SpeechGeneratorFactory.generator=function(e){return new(sre.SpeechGeneratorFactory.generatorMapping_[e]||sre.SpeechGeneratorFactory.generatorMapping_.Direct)},sre.SpeechGeneratorFactory.generatorMapping_={Adhoc:sre.AdhocSpeechGenerator,Direct:sre.DirectSpeechGenerator,Dummy:sre.DummySpeechGenerator,Node:sre.NodeSpeechGenerator,Summary:sre.SummarySpeechGenerator,Tree:sre.TreeSpeechGenerator},sre.EventUtil={},sre.EventUtil.KeyCode={ENTER:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},sre.EventUtil.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel"},sre.EventUtil.Event=function(e,t,r){this.src=e,this.type=t,this.callback=r},sre.EventUtil.Event.prototype.add=function(){this.src.addEventListener(this.type,this.callback)},sre.EventUtil.Event.prototype.remove=function(){this.src.removeEventListener(this.type,this.callback)},sre.Focus=function(e,t){this.semanticNodes_=e,this.semanticPrimary_=t,this.domNodes_=[],this.domPrimary_=null,this.allNodes_=[]},sre.Focus.prototype.getSemanticPrimary=function(){return this.semanticPrimary_},sre.Focus.prototype.getSemanticNodes=function(){return this.semanticNodes_},sre.Focus.prototype.getNodes=function(){return this.allNodes_},sre.Focus.prototype.getDomNodes=function(){return this.domNodes_},sre.Focus.prototype.getDomPrimary=function(){return this.domPrimary_},sre.Focus.prototype.toString=function(){return"Primary:"+this.domPrimary_+" Nodes:"+this.domNodes_},sre.Focus.prototype.clone=function(){var e=new sre.Focus(this.semanticNodes_,this.semanticPrimary_);return e.domNodes_=this.domNodes_,e.domPrimary_=this.domPrimary_,e.allNodes_=this.allNodes_,e},sre.Focus.factory=function(e,t,r,s){var n=function(e){return sre.WalkerUtil.getBySemanticId(s,e)},i=r.nodeDict,a=(r=n(e),n=t.map(n),t.map(function(e){return i[e]}));return(e=new sre.Focus(a,i[e])).domNodes_=n,e.domPrimary_=r,e.allNodes_=sre.Focus.generateAllVisibleNodes_(t,n,i,s),e},sre.Focus.generateAllVisibleNodes_=function(e,t,r,s){function n(e){return sre.WalkerUtil.getBySemanticId(s,e)}for(var i,a,o=[],l=0,c=e.length;l<c;l++)t[l]?o.push(t[l]):(i=r[e[l]])&&(a=(i=i.childNodes.map(function(e){return e.id.toString()})).map(n),o=o.concat(sre.Focus.generateAllVisibleNodes_(i,a,r,s)));return o},sre.Levels=function(){this.level_=[]},sre.Levels.prototype.push=function(e){this.level_.push(e)},sre.Levels.prototype.pop=function(){return this.level_.pop()},sre.Levels.prototype.peek=function(){return this.level_[this.level_.length-1]||null},sre.Levels.prototype.indexOf=function(e){var t=this.peek();return t?t.indexOf(e):null},sre.Levels.prototype.find=function(e){var t=this.peek();if(!t)return null;for(var r=0,s=t.length;r<s;r++)if(e(t[r]))return t[r];return null},sre.Levels.prototype.get=function(e){var t=this.peek();return!t||e<0||e>=t.length?null:t[e]},sre.Levels.prototype.depth=function(){return this.level_.length},sre.Levels.prototype.clone=function(){var e=new sre.Levels;return e.level_=this.level_.slice(0),e},sre.Levels.prototype.toString=function(){for(var e,t="",r=0;e=this.level_[r];r++)t+="\n"+e.map(function(e){return e.toString()});return t},sre.Walker=function(){},sre.Walker.prototype.isActive=function(){},sre.Walker.prototype.activate=function(){},sre.Walker.prototype.deactivate=function(){},sre.Walker.prototype.speech=function(){},sre.Walker.prototype.getFocus=function(){},sre.Walker.prototype.setFocus=function(e){},sre.Walker.prototype.getDepth=function(){},sre.Walker.prototype.move=function(e){},sre.Walker.move={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",REPEAT:"repeat",DEPTH:"depth",ENTER:"enter",EXPAND:"expand",HOME:"home",SUMMARY:"summary",DETAIL:"detail",ROW:"row",CELL:"cell"},sre.AbstractWalker=function(e,t,r,s){this.node=e,this.xml=sre.DomUtil.parseInput(s),this.generator=t,this.rebuilt=this.rebuildStree_(),this.generator.setRebuilt(this.rebuilt),this.highlighter=r,this.active_=!1,this.keyMapping={},this.keyMapping[sre.EventUtil.KeyCode.UP]=goog.bind(this.up,this),this.keyMapping[sre.EventUtil.KeyCode.DOWN]=goog.bind(this.down,this),this.keyMapping[sre.EventUtil.KeyCode.RIGHT]=goog.bind(this.right,this),this.keyMapping[sre.EventUtil.KeyCode.LEFT]=goog.bind(this.left,this),this.keyMapping[sre.EventUtil.KeyCode.TAB]=goog.bind(this.repeat,this),this.keyMapping[sre.EventUtil.KeyCode.ENTER]=goog.bind(this.expand,this),this.keyMapping[sre.EventUtil.KeyCode.SPACE]=goog.bind(this.depth,this),this.keyMapping[sre.EventUtil.KeyCode.HOME]=goog.bind(this.home,this),this.keyMapping[sre.EventUtil.KeyCode.X]=goog.bind(this.summary,this),this.keyMapping[sre.EventUtil.KeyCode.Z]=goog.bind(this.detail,this),this.keyMapping[sre.EventUtil.KeyCode.V]=goog.bind(this.virtualize,this),this.keyMapping[sre.EventUtil.KeyCode.P]=goog.bind(this.previous,this),this.keyMapping[sre.EventUtil.KeyCode.U]=goog.bind(this.undo,this),this.dummy_=function(){},this.rootNode=sre.WalkerUtil.getSemanticRoot(e),this.rootId=this.rebuilt.stree.root.id.toString(),this.focus_=sre.Focus.factory(this.rootId,[this.rootId],this.rebuilt,this.node),this.moved=sre.Walker.move.ENTER,this.cursors=[]},sre.AbstractWalker.prototype.isActive=function(){return this.active_},sre.AbstractWalker.prototype.toggleActive_=function(){this.active_=!this.active_},sre.AbstractWalker.prototype.activate=function(){this.isActive()||(this.generator.start(),this.toggleActive_())},sre.AbstractWalker.prototype.deactivate=function(){this.isActive()&&(this.highlighter.setState(this.node.id,this.primaryId()),this.generator.end(),this.toggleActive_())},sre.AbstractWalker.prototype.getFocus=function(){return this.focus_},sre.AbstractWalker.prototype.setFocus=function(e){this.focus_=e},sre.AbstractWalker.prototype.getDepth=function(){return this.levels.depth()-1},sre.AbstractWalker.prototype.speech=function(){var e=this.focus_.getDomNodes();if(!e.length)return"";if(null!==(t=this.specialMove()))return t;switch(this.moved){case sre.Walker.move.DEPTH:return this.depth_();case sre.Walker.move.SUMMARY:return this.summary_();case sre.Walker.move.DETAIL:return this.detail_();default:for(var t=[],r=this.focus_.getSemanticNodes(),s=0,n=e.length;s<n;s++){var i=e[s],a=r[s];t.push(i?this.generator.getSpeech(i,this.xml):sre.SpeechGeneratorUtil.retrieveSpeech(a))}return this.mergePrefix_(t)}},sre.AbstractWalker.prototype.mergePrefix_=function(e,t){t=t||[];var r=this.prefix_();return r&&e.unshift(r),sre.AuralRendering.getInstance().merge(t.concat(e))},sre.AbstractWalker.prototype.prefix_=function(){var e=this.focus_.getDomNodes(),t=this.focus_.getSemanticNodes();return e[0]?sre.WalkerUtil.getAttribute(e[0],sre.EnrichMathml.Attribute.PREFIX):sre.SpeechGeneratorUtil.retrievePrefix(t[0])},sre.AbstractWalker.prototype.move=function(e){return(e=this.keyMapping[e])?!(!(e=e())||e===this.focus_)&&(this.focus_=e,this.moved===sre.Walker.move.HOME&&(this.levels=this.initLevels()),!0):null},sre.AbstractWalker.prototype.up=function(){return this.moved=sre.Walker.move.UP,this.focus_},sre.AbstractWalker.prototype.down=function(){return this.moved=sre.Walker.move.DOWN,this.focus_},sre.AbstractWalker.prototype.left=function(){return this.moved=sre.Walker.move.LEFT,this.focus_},sre.AbstractWalker.prototype.right=function(){return this.moved=sre.Walker.move.RIGHT,this.focus_},sre.AbstractWalker.prototype.repeat=function(){return this.moved=sre.Walker.move.REPEAT,this.focus_.clone()},sre.AbstractWalker.prototype.depth=function(){return this.moved=sre.Walker.move.DEPTH,this.focus_.clone()},sre.AbstractWalker.prototype.depth_=function(){var e=sre.Grammar.getInstance().getParameter("depth"),t=(sre.Grammar.getInstance().setParameter("depth",!0),this.focus_.getDomPrimary()),t=(this.expandable(t)?[sre.Messages.NAVIGATE.EXPANDABLE]:this.collapsible(t)&&[sre.Messages.NAVIGATE.COLLAPSIBLE])||[],r=[sre.AuralRendering.getInstance().markup([new sre.AuditoryDescription({text:sre.Messages.NAVIGATE.LEVEL+" "+this.getDepth(),personality:{}})])],s=this.focus_.getSemanticNodes();return(s=sre.SpeechGeneratorUtil.retrievePrefix(s[0]))&&r.push(s),sre.Grammar.getInstance().setParameter("depth",e),sre.AuralRendering.getInstance().merge(r.concat(t))},sre.AbstractWalker.prototype.home=function(){return this.moved=sre.Walker.move.HOME,sre.Focus.factory(this.rootId,[this.rootId],this.rebuilt,this.node)},sre.AbstractWalker.prototype.getBySemanticId=function(e){return sre.WalkerUtil.getBySemanticId(this.node,e)},sre.AbstractWalker.prototype.primaryId=function(){return this.focus_.getSemanticPrimary().id.toString()},sre.AbstractWalker.prototype.expand=function(){var e=this.focus_.getDomPrimary();return(e=this.actionable_(e))?(this.moved=sre.Walker.move.EXPAND,e.onclick(),this.focus_.clone()):this.focus_},sre.AbstractWalker.prototype.actionable_=function(e){return e&&e.parentNode&&this.highlighter.isMactionNode(e.parentNode)?e.parentNode:null},sre.AbstractWalker.prototype.expandable=function(e){return!!this.actionable_(e)&&0===e.childNodes.length},sre.AbstractWalker.prototype.collapsible=function(e){return!!this.actionable_(e)&&0<e.childNodes.length},sre.AbstractWalker.prototype.restoreState=function(){if(this.highlighter&&(t=this.highlighter.getState(this.node.id))){for(var e=this.rebuilt.nodeDict[t],t=[];e;)t.push(e.id),e=e.parent;for(t.pop();0<t.length&&(this.down(),e=t.pop(),e=this.findFocusOnLevel(e));)this.focus_=e;this.moved=sre.Walker.move.ENTER}},sre.AbstractWalker.prototype.findFocusOnLevel=goog.abstractMethod,sre.AbstractWalker.prototype.initLevels=goog.abstractMethod,sre.AbstractWalker.prototype.rebuildStree_=function(){var e=new sre.RebuildStree(this.xml);return sre.SpeechGeneratorUtil.connectMactions(this.node,this.xml,e.xml),e},sre.AbstractWalker.prototype.previousLevel=function(){var e=this.focus_.getDomPrimary();return e?sre.WalkerUtil.getAttribute(e,sre.EnrichMathml.Attribute.PARENT):this.focus_.getSemanticPrimary().parent.id.toString()},sre.AbstractWalker.prototype.nextLevel=function(){var e,t,r,s=this.focus_.getDomPrimary();return s?(e=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(s,sre.EnrichMathml.Attribute.CHILDREN)),t=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(s,sre.EnrichMathml.Attribute.CONTENT)),r=sre.WalkerUtil.getAttribute(s,sre.EnrichMathml.Attribute.TYPE),s=sre.WalkerUtil.getAttribute(s,sre.EnrichMathml.Attribute.ROLE),this.combineContentChildren(r,s,t,e)):(t=function(e){return e.id.toString()},e=(r=this.rebuilt.nodeDict[this.primaryId()]).childNodes.map(t),t=r.contentNodes.map(t),0===e.length?[]:this.combineContentChildren(r.type,r.role,t,e))},sre.AbstractWalker.prototype.combineContentChildren=goog.abstractMethod,sre.AbstractWalker.prototype.singletonFocus=function(e){return this.focusFromId(e,[e])},sre.AbstractWalker.prototype.focusFromId=function(e,t){return sre.Focus.factory(e,t,this.rebuilt,this.node)},sre.AbstractWalker.prototype.summary=function(){return this.moved=sre.Walker.move.SUMMARY,this.focus_.clone()},sre.AbstractWalker.prototype.summary_=function(){var e=this.focus_.getSemanticPrimary().id.toString(),t=(e=this.rebuilt.xml.getAttribute("id")===e?this.rebuilt.xml:sre.DomUtil.querySelectorAllByAttrValue(this.rebuilt.xml,"id",e)[0]).getAttribute("alternative"),r=(e.setAttribute("alternative","summary"),sre.SpeechGeneratorUtil.computeSpeechWithoutCache(e)),r=sre.AuralRendering.getInstance().markup(r);return r=this.mergePrefix_([r]),t?e.setAttribute("alternative",t):e.removeAttribute("alternative"),r},sre.AbstractWalker.prototype.detail=function(){return this.moved=sre.Walker.move.DETAIL,this.focus_.clone()},sre.AbstractWalker.prototype.detail_=function(){var e=this.focus_.getSemanticPrimary().id.toString(),t=(e=this.rebuilt.xml.getAttribute("id")===e?this.rebuilt.xml:sre.DomUtil.querySelectorAllByAttrValue(this.rebuilt.xml,"id",e)[0]).getAttribute("alternative"),r=(e.removeAttribute("alternative"),sre.SpeechGeneratorUtil.computeSpeechWithoutCache(e)),r=sre.AuralRendering.getInstance().markup(r);return r=this.mergePrefix_([r]),e.setAttribute("alternative",t),r},sre.AbstractWalker.prototype.specialMove=function(){return null},sre.AbstractWalker.prototype.virtualize=function(e){return this.cursors.push({focus:this.focus_,levels:this.levels,undo:e||!this.cursors.length}),this.levels=this.levels.clone(),this.focus_.clone()},sre.AbstractWalker.prototype.previous=function(){var e=this.cursors.pop();return e?(this.levels=e.levels,e.focus):this.focus_},sre.AbstractWalker.prototype.undo=function(){do{var e=this.cursors.pop()}while(e&&!e.undo);return e?(this.levels=e.levels,e.focus):this.focus_},sre.DummyWalker=function(e,t,r,s){sre.AbstractWalker.call(this,e,t,r,s)},goog.inherits(sre.DummyWalker,sre.AbstractWalker),sre.DummyWalker.prototype.up=function(){},sre.DummyWalker.prototype.down=function(){},sre.DummyWalker.prototype.left=function(){},sre.DummyWalker.prototype.right=function(){},sre.DummyWalker.prototype.repeat=function(){},sre.DummyWalker.prototype.depth=function(){},sre.DummyWalker.prototype.home=function(){},sre.DummyWalker.prototype.getDepth=function(){return 0},sre.SemanticWalker=function(e,t,r,s){sre.AbstractWalker.call(this,e,t,r,s),this.levels=this.initLevels(),this.restoreState()},goog.inherits(sre.SemanticWalker,sre.AbstractWalker),sre.SemanticWalker.prototype.initLevels=function(){var e=new sre.Levels;return e.push([this.getFocus()]),e},sre.SemanticWalker.prototype.up=function(){sre.SemanticWalker.superClass_.up.call(this);var t=this.previousLevel();return t?(this.levels.pop(),this.levels.find(function(e){return e.getSemanticNodes().some(function(e){return e.id.toString()===t})})):null},sre.SemanticWalker.prototype.down=function(){sre.SemanticWalker.superClass_.down.call(this);var e=this.nextLevel();return 0===e.length?null:(this.levels.push(e),e[0])},sre.SemanticWalker.prototype.combineContentChildren=function(e,t,r,s){switch(e){case sre.SemanticAttr.Type.RELSEQ:case sre.SemanticAttr.Type.INFIXOP:case sre.SemanticAttr.Type.MULTIREL:return this.makePairList(s,r);case sre.SemanticAttr.Type.PREFIXOP:return[this.focusFromId(s[0],r.concat(s))];case sre.SemanticAttr.Type.POSTFIXOP:return[this.focusFromId(s[0],s.concat(r))];case sre.SemanticAttr.Type.MATRIX:case sre.SemanticAttr.Type.VECTOR:case sre.SemanticAttr.Type.FENCED:return[this.focusFromId(s[0],[r[0],s[0],r[1]])];case sre.SemanticAttr.Type.CASES:return[this.focusFromId(s[0],[r[0],s[0]])];case sre.SemanticAttr.Type.PUNCTUATED:return t===sre.SemanticAttr.Role.TEXT?s.map(goog.bind(this.singletonFocus,this)):s.length===r.length?r.map(goog.bind(this.singletonFocus,this)):this.combinePunctuations(s,r,[],[]);case sre.SemanticAttr.Type.APPL:return[this.focusFromId(s[0],[s[0],r[0]]),this.singletonFocus(s[1])];case sre.SemanticAttr.Type.ROOT:return[this.singletonFocus(s[1]),this.singletonFocus(s[0])];default:return s.map(goog.bind(this.singletonFocus,this))}},sre.SemanticWalker.prototype.combinePunctuations=function(e,t,r,s){if(0===e.length)return s;var n=e.shift(),i=t.shift();return n===i?(r.push(i),this.combinePunctuations(e,t,r,s)):(t.unshift(i),r.push(n),e.length===t.length?(s.push(this.focusFromId(n,r.concat(t))),s):(s.push(this.focusFromId(n,r)),this.combinePunctuations(e,t,[],s)))},sre.SemanticWalker.prototype.makePairList=function(e,t){if(0===e.length)return[];if(1===e.length)return[this.singletonFocus(e[0])];for(var r=[this.singletonFocus(e.shift())],s=0,n=e.length;s<n;s++)r.push(this.focusFromId(e[s],[t[s],e[s]]));return r},sre.SemanticWalker.prototype.left=function(){sre.SemanticWalker.superClass_.left.call(this);var e=this.levels.indexOf(this.getFocus())-1;return(e=this.levels.get(e))?e:null},sre.SemanticWalker.prototype.right=function(){sre.SemanticWalker.superClass_.right.call(this);var e=this.levels.indexOf(this.getFocus())+1;return(e=this.levels.get(e))?e:null},sre.SemanticWalker.prototype.findFocusOnLevel=function(t){return this.levels.find(function(e){return e.getSemanticPrimary().id===t})},sre.SyntaxWalker=function(e,t,r,s){sre.AbstractWalker.call(this,e,t,r,s),this.levels=this.initLevels(),this.restoreState()},goog.inherits(sre.SyntaxWalker,sre.AbstractWalker),sre.SyntaxWalker.prototype.initLevels=function(){var e=new sre.Levels;return e.push([this.primaryId()]),e},sre.SyntaxWalker.prototype.up=function(){sre.SyntaxWalker.superClass_.up.call(this);var e=this.previousLevel();return e?(this.levels.pop(),this.singletonFocus(e)):null},sre.SyntaxWalker.prototype.down=function(){sre.SyntaxWalker.superClass_.down.call(this);var e=this.nextLevel();if(0===e.length)return null;var t=this.singletonFocus(e[0]);return t&&this.levels.push(e),t},sre.SyntaxWalker.prototype.combineContentChildren=function(e,t,r,s){switch(e){case sre.SemanticAttr.Type.RELSEQ:case sre.SemanticAttr.Type.INFIXOP:case sre.SemanticAttr.Type.MULTIREL:return sre.BaseUtil.interleaveLists(s,r);case sre.SemanticAttr.Type.PREFIXOP:return r.concat(s);case sre.SemanticAttr.Type.POSTFIXOP:return s.concat(r);case sre.SemanticAttr.Type.MATRIX:case sre.SemanticAttr.Type.VECTOR:case sre.SemanticAttr.Type.FENCED:return s.unshift(r[0]),s.push(r[1]),s;case sre.SemanticAttr.Type.CASES:return s.unshift(r[0]),s;case sre.SemanticAttr.Type.PUNCTUATED:return t===sre.SemanticAttr.Role.TEXT?sre.BaseUtil.interleaveLists(s,r):s;case sre.SemanticAttr.Type.APPL:return[s[0],r[0],s[1]];case sre.SemanticAttr.Type.ROOT:return[s[1],s[0]];default:return s}},sre.SyntaxWalker.prototype.left=function(){sre.SyntaxWalker.superClass_.left.call(this);var e=this.levels.indexOf(this.primaryId())-1;return(e=this.levels.get(e))?this.singletonFocus(e):null},sre.SyntaxWalker.prototype.right=function(){sre.SyntaxWalker.superClass_.right.call(this);var e=this.levels.indexOf(this.primaryId())+1;return(e=this.levels.get(e))?this.singletonFocus(e):null},sre.SyntaxWalker.prototype.findFocusOnLevel=function(e){return this.singletonFocus(e.toString())},sre.TableWalker=function(e,t,r,s){sre.SyntaxWalker.call(this,e,t,r,s),this.modifier=!1,this.keyMapping[sre.EventUtil.KeyCode[0]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[1]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[2]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[3]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[4]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[5]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[6]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[7]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[8]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[9]]=goog.bind(this.jumpCell,this),this.key_=null,this.row_=0,this.firstJump=this.currentTable_=null},goog.inherits(sre.TableWalker,sre.SyntaxWalker),sre.TableWalker.prototype.move=function(e){return this.key_=e,e=sre.TableWalker.superClass_.move.call(this,e),this.modifier=!1,e},sre.TableWalker.prototype.up=function(){return this.moved=sre.Walker.move.UP,this.eligibleCell_()?this.verticalMove_(!1):sre.TableWalker.superClass_.up.call(this)},sre.TableWalker.prototype.down=function(){return this.moved=sre.Walker.move.DOWN,this.eligibleCell_()?this.verticalMove_(!0):sre.TableWalker.superClass_.down.call(this)},sre.TableWalker.ELIGIBLE_CELL_ROLES=[sre.SemanticAttr.Role.DETERMINANT,sre.SemanticAttr.Role.ROWVECTOR,sre.SemanticAttr.Role.BINOMIAL,sre.SemanticAttr.Role.SQUAREMATRIX,sre.SemanticAttr.Role.MULTILINE,sre.SemanticAttr.Role.MATRIX,sre.SemanticAttr.Role.VECTOR,sre.SemanticAttr.Role.CASES,sre.SemanticAttr.Role.TABLE],sre.TableWalker.ELIGIBLE_TABLE_TYPES=[sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Type.MATRIX,sre.SemanticAttr.Type.VECTOR,sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Type.TABLE],sre.TableWalker.prototype.eligibleCell_=function(){var e=this.getFocus().getSemanticPrimary();return this.modifier&&e.type===sre.SemanticAttr.Type.CELL&&-1!==sre.TableWalker.ELIGIBLE_CELL_ROLES.indexOf(e.role)},sre.TableWalker.prototype.verticalMove_=function(e){if(!(n=this.previousLevel()))return null;var t=this.getFocus(),r=this.levels.indexOf(this.primaryId()),s=this.levels.pop(),n=this.levels.indexOf(n);return(e=this.levels.get(e?n+1:n-1))?(this.setFocus(this.singletonFocus(e)),(e=this.nextLevel())[r]?(this.levels.push(e),this.singletonFocus(e[r])):(this.setFocus(t),this.levels.push(s),null)):(this.levels.push(s),null)},sre.TableWalker.prototype.jumpCell=function(){return this.isInTable_()?this.moved===sre.Walker.move.ROW?(this.moved=sre.Walker.move.CELL,e=this.key_-sre.EventUtil.KeyCode[0],this.isLegalJump_(this.row_,e)?this.jumpCell_(this.row_,e):this.getFocus()):(e=this.key_-sre.EventUtil.KeyCode[0])>this.currentTable_.childNodes.length?this.getFocus():(this.row_=e,this.moved=sre.Walker.move.ROW,this.getFocus().clone()):this.getFocus();var e},sre.TableWalker.prototype.jumpCell_=function(e,t){this.firstJump?this.virtualize(!1):(this.firstJump=this.getFocus(),this.virtualize(!0));var r=this.currentTable_.id.toString();do{var s=this.levels.pop()}while(-1===s.indexOf(r));return this.levels.push(s),this.setFocus(this.singletonFocus(r)),this.levels.push(this.nextLevel()),e=this.currentTable_.childNodes[e-1],this.setFocus(this.singletonFocus(e.id.toString())),this.levels.push(this.nextLevel()),this.singletonFocus(e.childNodes[t-1].id.toString())},sre.TableWalker.prototype.isLegalJump_=function(e,t){var r=sre.DomUtil.querySelectorAllByAttrValue(this.rebuilt.xml,"id",this.currentTable_.id.toString())[0];return!(!r||r.hasAttribute("alternative"))&&(!!(e=this.currentTable_.childNodes[e-1])&&(!(!(r=sre.DomUtil.querySelectorAllByAttrValue(r,"id",e.id.toString())[0])||r.hasAttribute("alternative"))&&!(!e||!e.childNodes[t-1])))},sre.TableWalker.prototype.isInTable_=function(){for(var e=this.getFocus().getSemanticPrimary();e;){if(-1!==sre.TableWalker.ELIGIBLE_TABLE_TYPES.indexOf(e.type))return this.currentTable_=e,!0;e=e.parent}return!1},sre.TableWalker.prototype.undo=function(){var e=sre.TableWalker.superClass_.undo.call(this);return e===this.firstJump&&(this.firstJump=null),e},sre.WalkerFactory={},sre.WalkerFactory.walker=function(e,t,r,s,n){return new(sre.WalkerFactory.walkerMapping_[e]||sre.WalkerFactory.walkerMapping_.Dummy)(t,r,s,n)},sre.WalkerFactory.walkerMapping_={Dummy:sre.DummyWalker,Semantic:sre.SemanticWalker,Syntax:sre.SyntaxWalker,Table:sre.TableWalker},sre.System=function(){this.version=sre.Variables.VERSION},goog.addSingletonGetter(sre.System),sre.System.Error=function(e){Error.call(this),this.message=e||"",this.name="System Error"},goog.inherits(sre.System.Error,Error),sre.System.LocalStorage_=function(){this.speechGenerator=this.walker=null},goog.addSingletonGetter(sre.System.LocalStorage_),sre.System.prototype.setupEngine=function(t){function e(e){r[e]=t[e]||r[e]}var r=sre.Engine.getInstance();e("mode"),sre.System.prototype.configBlocks_(t),["strict","cache","semantics","structure"].forEach(function(e){void 0!==t[e]&&(r[e]=!!t[e])}),"markup style domain speech walker locale".split(" ").forEach(e),t.json&&(sre.SystemExternal.jsonPath=sre.BaseUtil.makePath(t.json)),t.xpath&&(sre.SystemExternal.WGXpath=t.xpath),r.setupBrowsers(),r.ruleSets=t.rules||sre.SpeechRuleStores.availableSets(),sre.SpeechRuleEngine.getInstance().parameterize(r.ruleSets),r.dynamicCstr=sre.DynamicCstr.create(r.locale,r.domain,r.style),r.comparator=new sre.DynamicCstr.DefaultComparator(r.dynamicCstr,sre.DynamicProperties.create([sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]],["short",sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE]])),sre.L10n.setLocale()},sre.System.prototype.configBlocks_=function(e){if(sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP)for(var t=document.documentElement.querySelectorAll('script[type="text/x-sre-config"]'),r=0,s=t.length;r<s;r++)try{var n,i=t[r].innerHTML,a=JSON.parse(i);for(n in a)e[n]=a[n]}catch(e){sre.Debugger.getInstance().output("Illegal configuration ",i)}},sre.System.prototype.toSpeech=function(e){return(e=sre.System.getInstance().parseExpression_(e,sre.Engine.getInstance().semantics))?sre.System.getInstance().processXml(e):""},sre.System.prototype.processExpression=sre.System.prototype.toSpeech,sre.System.prototype.toSemantic=function(e){return sre.System.getInstance().parseExpression_(e,!0)},sre.System.prototype.toJson=function(e){if(sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP)throw new sre.System.Error("JSON translation not possible in browser.");return(e=sre.System.getInstance().parseExpression_(e,!0))?sre.SystemExternal.xm.tojson(e.toString()):{}},sre.System.prototype.toDescription=function(e){return(e=sre.System.getInstance().parseExpression_(e,sre.Engine.getInstance().semantics))?sre.SpeechGeneratorUtil.computeSpeech(e):[]},sre.System.prototype.toEnriched=function(e){e=sre.Enrich.semanticMathmlSync(e);var t=sre.WalkerUtil.getSemanticRoot(e);switch(sre.Engine.getInstance().speech){case sre.Engine.Speech.SHALLOW:var r=sre.SpeechGeneratorFactory.generator("Adhoc");r.getSpeech(t,e);break;case sre.Engine.Speech.DEEP:(r=sre.SpeechGeneratorFactory.generator("Tree")).getSpeech(t,e)}return e},sre.System.prototype.fileToSpeech=function(e,t){sre.System.getInstance().processFile_(sre.System.getInstance().toSpeech,e,t)},sre.System.prototype.processFile=sre.System.prototype.fileToSpeech,sre.System.prototype.fileToSemantic=function(e,t){sre.System.getInstance().processFile_(function(e){return sre.System.getInstance().toSemantic(e).toString()},e,t)},sre.System.prototype.fileToJson=function(e,t){sre.System.getInstance().processFile_(function(e){return JSON.stringify(sre.System.getInstance().toJson(e))},e,t)},sre.System.prototype.fileToDescription=function(e,t){sre.System.getInstance().processFile_(function(e){return JSON.stringify(sre.System.getInstance().toDescription(e))},e,t)},sre.System.prototype.fileToEnriched=function(e,t){sre.System.getInstance().processFile_(function(e){return sre.System.getInstance().toEnriched(e).toString()},e,t)},sre.System.prototype.processXml=function(e){return e=sre.SpeechGeneratorUtil.computeSpeech(e),sre.AuralRendering.getInstance().markup(e)},sre.System.prototype.parseExpression_=function(e,t){var r=null;try{r=sre.DomUtil.parseInput(e,sre.System.Error),t&&(r=sre.System.getInstance().getSemanticTree(r)),sre.Debugger.getInstance().generateOutput(goog.bind(function(){return r.toString()},this))}catch(e){console.log("Parse Error: "+e.message)}return r},sre.System.prototype.getSemanticTree=function(e){return sre.Semantic.xmlTree(e)},sre.System.prototype.processFile_=function(e,t,r){sre.Engine.isReady()?sre.Engine.getInstance().mode===sre.Engine.Mode.SYNC?this.processFileSync_(e,t,r):this.processFileAsync_(e,t,r):setTimeout(goog.bind(function(){this.processFile_(e,t,r)},this),100)},sre.System.prototype.inputFileSync_=function(t){try{var e=sre.SystemExternal.fs.readFileSync(t,{encoding:"utf8"})}catch(e){throw new sre.System.Error("Can not open file: "+t)}return e},sre.System.prototype.processFileSync_=function(e,t,r){if(e=e(t=sre.System.getInstance().inputFileSync_(t)),r)try{sre.SystemExternal.fs.writeFileSync(r,e,function(){})}catch(e){throw new sre.System.Error("Can not write to file: "+r)}else console.log(e)},sre.System.prototype.inputFileAsync_=function(r,s){sre.SystemExternal.fs.readFile(r,{encoding:"utf8"},goog.bind(function(e,t){if(e)throw new sre.System.Error("Can not open file: "+r);s(t)},this))},sre.System.prototype.processFileAsync_=function(t,e,r){sre.System.getInstance().inputFileAsync_(e,goog.bind(function(e){e=t(e),r?sre.SystemExternal.fs.writeFile(r,e,function(e){if(e)throw new sre.System.Error("Can not write to file: "+r)}):console.log(e)},this))},sre.System.prototype.walk=function(e){var t=sre.SpeechGeneratorFactory.generator("Node"),r=(sre.System.LocalStorage_.getInstance().speechGenerator=t,sre.HighlighterFactory.highlighter({color:"black"},{color:"white"},{renderer:"NativeMML"})),s=(e=sre.System.getInstance().toEnriched(e),(new sre.SystemExternal.xmldom.XMLSerializer).serializeToString(e));return sre.System.LocalStorage_.getInstance().walker=sre.WalkerFactory.walker(sre.Engine.getInstance().walker,e,t,r,s),sre.System.LocalStorage_.getInstance().walker.speech()},sre.System.prototype.move=function(e){if(!sre.System.LocalStorage_.getInstance().walker)return null;var t="string"==typeof e?sre.EventUtil.KeyCode[e.toUpperCase()]:e;return!1===sre.System.LocalStorage_.getInstance().walker.move(t)?sre.AuralRendering.getInstance().error(e):sre.System.LocalStorage_.getInstance().walker.speech()},sre.Mathjax={},function(){var e=sre.System.getInstance(),t=MathJax.Callback.Signal("Sre");MathJax.Extension.Sre={version:e.version,signal:t,ConfigSre:function(){sre.Engine.isReady()?MathJax.Callback.Queue(MathJax.Hub.Register.StartupHook("mml Jax Ready",{}),["Post",MathJax.Hub.Startup.signal,"Sre Ready"]):setTimeout(MathJax.Extension.Sre.ConfigSre,500)}},sre.System.getInstance().setupEngine({mode:sre.Engine.Mode.HTTP,json:MathJax.Ajax.config.path.SRE+"/mathmaps",xpath:MathJax.Ajax.config.path.SRE+"/wgxpath.install.js",semantics:!0}),MathJax.Extension.Sre.ConfigSre()}();